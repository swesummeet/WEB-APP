(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function Lg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ap={exports:{}},Pl={},op={exports:{}},_e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ba=Symbol.for("react.element"),bg=Symbol.for("react.portal"),Mg=Symbol.for("react.fragment"),Bg=Symbol.for("react.strict_mode"),Ug=Symbol.for("react.profiler"),jg=Symbol.for("react.provider"),$g=Symbol.for("react.context"),Wg=Symbol.for("react.forward_ref"),zg=Symbol.for("react.suspense"),Hg=Symbol.for("react.memo"),Vg=Symbol.for("react.lazy"),M0=Symbol.iterator;function Gg(e){return e===null||typeof e!="object"?null:(e=M0&&e[M0]||e["@@iterator"],typeof e=="function"?e:null)}var lp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},up=Object.assign,cp={};function ms(e,t,r){this.props=e,this.context=t,this.refs=cp,this.updater=r||lp}ms.prototype.isReactComponent={};ms.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ms.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function fp(){}fp.prototype=ms.prototype;function cf(e,t,r){this.props=e,this.context=t,this.refs=cp,this.updater=r||lp}var ff=cf.prototype=new fp;ff.constructor=cf;up(ff,ms.prototype);ff.isPureReactComponent=!0;var B0=Array.isArray,hp=Object.prototype.hasOwnProperty,hf={current:null},dp={key:!0,ref:!0,__self:!0,__source:!0};function pp(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)hp.call(t,n)&&!dp.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Ba,type:e,key:s,ref:a,props:i,_owner:hf.current}}function Kg(e,t){return{$$typeof:Ba,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function df(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ba}function qg(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var U0=/\/+/g;function hu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?qg(""+e.key):t.toString(36)}function No(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Ba:case bg:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+hu(a,0):n,B0(i)?(r="",e!=null&&(r=e.replace(U0,"$&/")+"/"),No(i,t,r,"",function(u){return u})):i!=null&&(df(i)&&(i=Kg(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(U0,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",B0(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+hu(s,o);a+=No(s,t,r,l,i)}else if(l=Gg(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+hu(s,o++),a+=No(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Qa(e,t,r){if(e==null)return e;var n=[],i=0;return No(e,n,"","",function(s){return t.call(r,s,i++)}),n}function Xg(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Bt={current:null},Po={transition:null},Yg={ReactCurrentDispatcher:Bt,ReactCurrentBatchConfig:Po,ReactCurrentOwner:hf};function mp(){throw Error("act(...) is not supported in production builds of React.")}_e.Children={map:Qa,forEach:function(e,t,r){Qa(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Qa(e,function(){t++}),t},toArray:function(e){return Qa(e,function(t){return t})||[]},only:function(e){if(!df(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_e.Component=ms;_e.Fragment=Mg;_e.Profiler=Ug;_e.PureComponent=cf;_e.StrictMode=Bg;_e.Suspense=zg;_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yg;_e.act=mp;_e.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=up({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=hf.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)hp.call(t,l)&&!dp.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Ba,type:e.type,key:i,ref:s,props:n,_owner:a}};_e.createContext=function(e){return e={$$typeof:$g,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:jg,_context:e},e.Consumer=e};_e.createElement=pp;_e.createFactory=function(e){var t=pp.bind(null,e);return t.type=e,t};_e.createRef=function(){return{current:null}};_e.forwardRef=function(e){return{$$typeof:Wg,render:e}};_e.isValidElement=df;_e.lazy=function(e){return{$$typeof:Vg,_payload:{_status:-1,_result:e},_init:Xg}};_e.memo=function(e,t){return{$$typeof:Hg,type:e,compare:t===void 0?null:t}};_e.startTransition=function(e){var t=Po.transition;Po.transition={};try{e()}finally{Po.transition=t}};_e.unstable_act=mp;_e.useCallback=function(e,t){return Bt.current.useCallback(e,t)};_e.useContext=function(e){return Bt.current.useContext(e)};_e.useDebugValue=function(){};_e.useDeferredValue=function(e){return Bt.current.useDeferredValue(e)};_e.useEffect=function(e,t){return Bt.current.useEffect(e,t)};_e.useId=function(){return Bt.current.useId()};_e.useImperativeHandle=function(e,t,r){return Bt.current.useImperativeHandle(e,t,r)};_e.useInsertionEffect=function(e,t){return Bt.current.useInsertionEffect(e,t)};_e.useLayoutEffect=function(e,t){return Bt.current.useLayoutEffect(e,t)};_e.useMemo=function(e,t){return Bt.current.useMemo(e,t)};_e.useReducer=function(e,t,r){return Bt.current.useReducer(e,t,r)};_e.useRef=function(e){return Bt.current.useRef(e)};_e.useState=function(e){return Bt.current.useState(e)};_e.useSyncExternalStore=function(e,t,r){return Bt.current.useSyncExternalStore(e,t,r)};_e.useTransition=function(){return Bt.current.useTransition()};_e.version="18.3.1";op.exports=_e;var Le=op.exports;const Jg=Lg(Le);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qg=Le,Zg=Symbol.for("react.element"),ex=Symbol.for("react.fragment"),tx=Object.prototype.hasOwnProperty,rx=Qg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nx={key:!0,ref:!0,__self:!0,__source:!0};function vp(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)tx.call(t,n)&&!nx.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:Zg,type:e,key:s,ref:a,props:i,_owner:rx.current}}Pl.Fragment=ex;Pl.jsx=vp;Pl.jsxs=vp;ap.exports=Pl;var D=ap.exports,ec={},gp={exports:{}},sr={},xp={exports:{}},_p={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(te,ce){var de=te.length;te.push(ce);e:for(;0<de;){var we=de-1>>>1,O=te[we];if(0<i(O,ce))te[we]=ce,te[de]=O,de=we;else break e}}function r(te){return te.length===0?null:te[0]}function n(te){if(te.length===0)return null;var ce=te[0],de=te.pop();if(de!==ce){te[0]=de;e:for(var we=0,O=te.length,U=O>>>1;we<U;){var F=2*(we+1)-1,R=te[F],V=F+1,oe=te[V];if(0>i(R,de))V<O&&0>i(oe,R)?(te[we]=oe,te[V]=de,we=V):(te[we]=R,te[F]=de,we=F);else if(V<O&&0>i(oe,de))te[we]=oe,te[V]=de,we=V;else break e}}return ce}function i(te,ce){var de=te.sortIndex-ce.sortIndex;return de!==0?de:te.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,h=null,f=3,d=!1,m=!1,p=!1,_=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(te){for(var ce=r(u);ce!==null;){if(ce.callback===null)n(u);else if(ce.startTime<=te)n(u),ce.sortIndex=ce.expirationTime,t(l,ce);else break;ce=r(u)}}function T(te){if(p=!1,g(te),!m)if(r(l)!==null)m=!0,Qe(I);else{var ce=r(u);ce!==null&&Me(T,ce.startTime-te)}}function I(te,ce){m=!1,p&&(p=!1,x(P),P=-1),d=!0;var de=f;try{for(g(ce),h=r(l);h!==null&&(!(h.expirationTime>ce)||te&&!G());){var we=h.callback;if(typeof we=="function"){h.callback=null,f=h.priorityLevel;var O=we(h.expirationTime<=ce);ce=e.unstable_now(),typeof O=="function"?h.callback=O:h===r(l)&&n(l),g(ce)}else n(l);h=r(l)}if(h!==null)var U=!0;else{var F=r(u);F!==null&&Me(T,F.startTime-ce),U=!1}return U}finally{h=null,f=de,d=!1}}var L=!1,A=null,P=-1,N=5,W=-1;function G(){return!(e.unstable_now()-W<N)}function q(){if(A!==null){var te=e.unstable_now();W=te;var ce=!0;try{ce=A(!0,te)}finally{ce?re():(L=!1,A=null)}}else L=!1}var re;if(typeof v=="function")re=function(){v(q)};else if(typeof MessageChannel<"u"){var Te=new MessageChannel,ve=Te.port2;Te.port1.onmessage=q,re=function(){ve.postMessage(null)}}else re=function(){_(q,0)};function Qe(te){A=te,L||(L=!0,re())}function Me(te,ce){P=_(function(){te(e.unstable_now())},ce)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(te){te.callback=null},e.unstable_continueExecution=function(){m||d||(m=!0,Qe(I))},e.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<te?Math.floor(1e3/te):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(te){switch(f){case 1:case 2:case 3:var ce=3;break;default:ce=f}var de=f;f=ce;try{return te()}finally{f=de}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(te,ce){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var de=f;f=te;try{return ce()}finally{f=de}},e.unstable_scheduleCallback=function(te,ce,de){var we=e.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?we+de:we):de=we,te){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=de+O,te={id:c++,callback:ce,priorityLevel:te,startTime:de,expirationTime:O,sortIndex:-1},de>we?(te.sortIndex=de,t(u,te),r(l)===null&&te===r(u)&&(p?(x(P),P=-1):p=!0,Me(T,de-we))):(te.sortIndex=O,t(l,te),m||d||(m=!0,Qe(I))),te},e.unstable_shouldYield=G,e.unstable_wrapCallback=function(te){var ce=f;return function(){var de=f;f=ce;try{return te.apply(this,arguments)}finally{f=de}}}})(_p);xp.exports=_p;var ix=xp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sx=Le,nr=ix;function Y(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wp=new Set,oa={};function di(e,t){as(e,t),as(e+"Capture",t)}function as(e,t){for(oa[e]=t,e=0;e<t.length;e++)wp.add(t[e])}var en=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tc=Object.prototype.hasOwnProperty,ax=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,j0={},$0={};function ox(e){return tc.call($0,e)?!0:tc.call(j0,e)?!1:ax.test(e)?$0[e]=!0:(j0[e]=!0,!1)}function lx(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ux(e,t,r,n){if(t===null||typeof t>"u"||lx(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ut(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var St={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){St[e]=new Ut(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];St[t]=new Ut(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){St[e]=new Ut(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){St[e]=new Ut(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){St[e]=new Ut(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){St[e]=new Ut(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){St[e]=new Ut(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){St[e]=new Ut(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){St[e]=new Ut(e,5,!1,e.toLowerCase(),null,!1,!1)});var pf=/[\-:]([a-z])/g;function mf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(pf,mf);St[t]=new Ut(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(pf,mf);St[t]=new Ut(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(pf,mf);St[t]=new Ut(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){St[e]=new Ut(e,1,!1,e.toLowerCase(),null,!1,!1)});St.xlinkHref=new Ut("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){St[e]=new Ut(e,1,!1,e.toLowerCase(),null,!0,!0)});function vf(e,t,r,n){var i=St.hasOwnProperty(t)?St[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ux(t,r,i,n)&&(r=null),n||i===null?ox(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var on=sx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Za=Symbol.for("react.element"),Li=Symbol.for("react.portal"),bi=Symbol.for("react.fragment"),gf=Symbol.for("react.strict_mode"),rc=Symbol.for("react.profiler"),yp=Symbol.for("react.provider"),Ep=Symbol.for("react.context"),xf=Symbol.for("react.forward_ref"),nc=Symbol.for("react.suspense"),ic=Symbol.for("react.suspense_list"),_f=Symbol.for("react.memo"),hn=Symbol.for("react.lazy"),Sp=Symbol.for("react.offscreen"),W0=Symbol.iterator;function As(e){return e===null||typeof e!="object"?null:(e=W0&&e[W0]||e["@@iterator"],typeof e=="function"?e:null)}var Ge=Object.assign,du;function Ms(e){if(du===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);du=t&&t[1]||""}return`
`+du+e}var pu=!1;function mu(e,t){if(!e||pu)return"";pu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{pu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ms(e):""}function cx(e){switch(e.tag){case 5:return Ms(e.type);case 16:return Ms("Lazy");case 13:return Ms("Suspense");case 19:return Ms("SuspenseList");case 0:case 2:case 15:return e=mu(e.type,!1),e;case 11:return e=mu(e.type.render,!1),e;case 1:return e=mu(e.type,!0),e;default:return""}}function sc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case bi:return"Fragment";case Li:return"Portal";case rc:return"Profiler";case gf:return"StrictMode";case nc:return"Suspense";case ic:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ep:return(e.displayName||"Context")+".Consumer";case yp:return(e._context.displayName||"Context")+".Provider";case xf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case _f:return t=e.displayName||null,t!==null?t:sc(e.type)||"Memo";case hn:t=e._payload,e=e._init;try{return sc(e(t))}catch{}}return null}function fx(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sc(t);case 8:return t===gf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Nn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Tp(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function hx(e){var t=Tp(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function eo(e){e._valueTracker||(e._valueTracker=hx(e))}function kp(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Tp(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function zo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ac(e,t){var r=t.checked;return Ge({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function z0(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Nn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Ap(e,t){t=t.checked,t!=null&&vf(e,"checked",t,!1)}function oc(e,t){Ap(e,t);var r=Nn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?lc(e,t.type,r):t.hasOwnProperty("defaultValue")&&lc(e,t.type,Nn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function H0(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function lc(e,t,r){(t!=="number"||zo(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Bs=Array.isArray;function Xi(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Nn(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function uc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Y(91));return Ge({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function V0(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Y(92));if(Bs(r)){if(1<r.length)throw Error(Y(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Nn(r)}}function Cp(e,t){var r=Nn(t.value),n=Nn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function G0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Op(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Op(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var to,Rp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(to=to||document.createElement("div"),to.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=to.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function la(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var zs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dx=["Webkit","ms","Moz","O"];Object.keys(zs).forEach(function(e){dx.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),zs[t]=zs[e]})});function Fp(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||zs.hasOwnProperty(e)&&zs[e]?(""+t).trim():t+"px"}function Np(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Fp(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var px=Ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fc(e,t){if(t){if(px[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Y(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Y(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Y(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Y(62))}}function hc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dc=null;function wf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var pc=null,Yi=null,Ji=null;function K0(e){if(e=$a(e)){if(typeof pc!="function")throw Error(Y(280));var t=e.stateNode;t&&(t=Ml(t),pc(e.stateNode,e.type,t))}}function Pp(e){Yi?Ji?Ji.push(e):Ji=[e]:Yi=e}function Ip(){if(Yi){var e=Yi,t=Ji;if(Ji=Yi=null,K0(e),t)for(e=0;e<t.length;e++)K0(t[e])}}function Dp(e,t){return e(t)}function Lp(){}var vu=!1;function bp(e,t,r){if(vu)return e(t,r);vu=!0;try{return Dp(e,t,r)}finally{vu=!1,(Yi!==null||Ji!==null)&&(Lp(),Ip())}}function ua(e,t){var r=e.stateNode;if(r===null)return null;var n=Ml(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Y(231,t,typeof r));return r}var mc=!1;if(en)try{var Cs={};Object.defineProperty(Cs,"passive",{get:function(){mc=!0}}),window.addEventListener("test",Cs,Cs),window.removeEventListener("test",Cs,Cs)}catch{mc=!1}function mx(e,t,r,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(c){this.onError(c)}}var Hs=!1,Ho=null,Vo=!1,vc=null,vx={onError:function(e){Hs=!0,Ho=e}};function gx(e,t,r,n,i,s,a,o,l){Hs=!1,Ho=null,mx.apply(vx,arguments)}function xx(e,t,r,n,i,s,a,o,l){if(gx.apply(this,arguments),Hs){if(Hs){var u=Ho;Hs=!1,Ho=null}else throw Error(Y(198));Vo||(Vo=!0,vc=u)}}function pi(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Mp(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function q0(e){if(pi(e)!==e)throw Error(Y(188))}function _x(e){var t=e.alternate;if(!t){if(t=pi(e),t===null)throw Error(Y(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return q0(i),e;if(s===n)return q0(i),t;s=s.sibling}throw Error(Y(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Y(189))}}if(r.alternate!==n)throw Error(Y(190))}if(r.tag!==3)throw Error(Y(188));return r.stateNode.current===r?e:t}function Bp(e){return e=_x(e),e!==null?Up(e):null}function Up(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Up(e);if(t!==null)return t;e=e.sibling}return null}var jp=nr.unstable_scheduleCallback,X0=nr.unstable_cancelCallback,wx=nr.unstable_shouldYield,yx=nr.unstable_requestPaint,Ze=nr.unstable_now,Ex=nr.unstable_getCurrentPriorityLevel,yf=nr.unstable_ImmediatePriority,$p=nr.unstable_UserBlockingPriority,Go=nr.unstable_NormalPriority,Sx=nr.unstable_LowPriority,Wp=nr.unstable_IdlePriority,Il=null,Ur=null;function Tx(e){if(Ur&&typeof Ur.onCommitFiberRoot=="function")try{Ur.onCommitFiberRoot(Il,e,void 0,(e.current.flags&128)===128)}catch{}}var Or=Math.clz32?Math.clz32:Cx,kx=Math.log,Ax=Math.LN2;function Cx(e){return e>>>=0,e===0?32:31-(kx(e)/Ax|0)|0}var ro=64,no=4194304;function Us(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ko(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Us(o):(s&=a,s!==0&&(n=Us(s)))}else a=r&~i,a!==0?n=Us(a):s!==0&&(n=Us(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Or(t),i=1<<r,n|=e[r],t&=~i;return n}function Ox(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rx(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-Or(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=Ox(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function gc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function zp(){var e=ro;return ro<<=1,!(ro&4194240)&&(ro=64),e}function gu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ua(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Or(t),e[t]=r}function Fx(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Or(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function Ef(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Or(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Fe=0;function Hp(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Vp,Sf,Gp,Kp,qp,xc=!1,io=[],Sn=null,Tn=null,kn=null,ca=new Map,fa=new Map,mn=[],Nx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Y0(e,t){switch(e){case"focusin":case"focusout":Sn=null;break;case"dragenter":case"dragleave":Tn=null;break;case"mouseover":case"mouseout":kn=null;break;case"pointerover":case"pointerout":ca.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":fa.delete(t.pointerId)}}function Os(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=$a(t),t!==null&&Sf(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Px(e,t,r,n,i){switch(t){case"focusin":return Sn=Os(Sn,e,t,r,n,i),!0;case"dragenter":return Tn=Os(Tn,e,t,r,n,i),!0;case"mouseover":return kn=Os(kn,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return ca.set(s,Os(ca.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,fa.set(s,Os(fa.get(s)||null,e,t,r,n,i)),!0}return!1}function Xp(e){var t=Jn(e.target);if(t!==null){var r=pi(t);if(r!==null){if(t=r.tag,t===13){if(t=Mp(r),t!==null){e.blockedOn=t,qp(e.priority,function(){Gp(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Io(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=_c(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);dc=n,r.target.dispatchEvent(n),dc=null}else return t=$a(r),t!==null&&Sf(t),e.blockedOn=r,!1;t.shift()}return!0}function J0(e,t,r){Io(e)&&r.delete(t)}function Ix(){xc=!1,Sn!==null&&Io(Sn)&&(Sn=null),Tn!==null&&Io(Tn)&&(Tn=null),kn!==null&&Io(kn)&&(kn=null),ca.forEach(J0),fa.forEach(J0)}function Rs(e,t){e.blockedOn===t&&(e.blockedOn=null,xc||(xc=!0,nr.unstable_scheduleCallback(nr.unstable_NormalPriority,Ix)))}function ha(e){function t(i){return Rs(i,e)}if(0<io.length){Rs(io[0],e);for(var r=1;r<io.length;r++){var n=io[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Sn!==null&&Rs(Sn,e),Tn!==null&&Rs(Tn,e),kn!==null&&Rs(kn,e),ca.forEach(t),fa.forEach(t),r=0;r<mn.length;r++)n=mn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<mn.length&&(r=mn[0],r.blockedOn===null);)Xp(r),r.blockedOn===null&&mn.shift()}var Qi=on.ReactCurrentBatchConfig,qo=!0;function Dx(e,t,r,n){var i=Fe,s=Qi.transition;Qi.transition=null;try{Fe=1,Tf(e,t,r,n)}finally{Fe=i,Qi.transition=s}}function Lx(e,t,r,n){var i=Fe,s=Qi.transition;Qi.transition=null;try{Fe=4,Tf(e,t,r,n)}finally{Fe=i,Qi.transition=s}}function Tf(e,t,r,n){if(qo){var i=_c(e,t,r,n);if(i===null)Cu(e,t,n,Xo,r),Y0(e,n);else if(Px(i,e,t,r,n))n.stopPropagation();else if(Y0(e,n),t&4&&-1<Nx.indexOf(e)){for(;i!==null;){var s=$a(i);if(s!==null&&Vp(s),s=_c(e,t,r,n),s===null&&Cu(e,t,n,Xo,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Cu(e,t,n,null,r)}}var Xo=null;function _c(e,t,r,n){if(Xo=null,e=wf(n),e=Jn(e),e!==null)if(t=pi(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Mp(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xo=e,null}function Yp(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ex()){case yf:return 1;case $p:return 4;case Go:case Sx:return 16;case Wp:return 536870912;default:return 16}default:return 16}}var xn=null,kf=null,Do=null;function Jp(){if(Do)return Do;var e,t=kf,r=t.length,n,i="value"in xn?xn.value:xn.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return Do=i.slice(e,1<n?1-n:void 0)}function Lo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function so(){return!0}function Q0(){return!1}function ar(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?so:Q0,this.isPropagationStopped=Q0,this}return Ge(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=so)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=so)},persist:function(){},isPersistent:so}),t}var vs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Af=ar(vs),ja=Ge({},vs,{view:0,detail:0}),bx=ar(ja),xu,_u,Fs,Dl=Ge({},ja,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Fs&&(Fs&&e.type==="mousemove"?(xu=e.screenX-Fs.screenX,_u=e.screenY-Fs.screenY):_u=xu=0,Fs=e),xu)},movementY:function(e){return"movementY"in e?e.movementY:_u}}),Z0=ar(Dl),Mx=Ge({},Dl,{dataTransfer:0}),Bx=ar(Mx),Ux=Ge({},ja,{relatedTarget:0}),wu=ar(Ux),jx=Ge({},vs,{animationName:0,elapsedTime:0,pseudoElement:0}),$x=ar(jx),Wx=Ge({},vs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),zx=ar(Wx),Hx=Ge({},vs,{data:0}),eh=ar(Hx),Vx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Kx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qx(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Kx[e])?!!t[e]:!1}function Cf(){return qx}var Xx=Ge({},ja,{key:function(e){if(e.key){var t=Vx[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Lo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Gx[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cf,charCode:function(e){return e.type==="keypress"?Lo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Lo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Yx=ar(Xx),Jx=Ge({},Dl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),th=ar(Jx),Qx=Ge({},ja,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cf}),Zx=ar(Qx),e_=Ge({},vs,{propertyName:0,elapsedTime:0,pseudoElement:0}),t_=ar(e_),r_=Ge({},Dl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),n_=ar(r_),i_=[9,13,27,32],Of=en&&"CompositionEvent"in window,Vs=null;en&&"documentMode"in document&&(Vs=document.documentMode);var s_=en&&"TextEvent"in window&&!Vs,Qp=en&&(!Of||Vs&&8<Vs&&11>=Vs),rh=" ",nh=!1;function Zp(e,t){switch(e){case"keyup":return i_.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function e1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Mi=!1;function a_(e,t){switch(e){case"compositionend":return e1(t);case"keypress":return t.which!==32?null:(nh=!0,rh);case"textInput":return e=t.data,e===rh&&nh?null:e;default:return null}}function o_(e,t){if(Mi)return e==="compositionend"||!Of&&Zp(e,t)?(e=Jp(),Do=kf=xn=null,Mi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Qp&&t.locale!=="ko"?null:t.data;default:return null}}var l_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ih(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!l_[e.type]:t==="textarea"}function t1(e,t,r,n){Pp(n),t=Yo(t,"onChange"),0<t.length&&(r=new Af("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Gs=null,da=null;function u_(e){h1(e,0)}function Ll(e){var t=ji(e);if(kp(t))return e}function c_(e,t){if(e==="change")return t}var r1=!1;if(en){var yu;if(en){var Eu="oninput"in document;if(!Eu){var sh=document.createElement("div");sh.setAttribute("oninput","return;"),Eu=typeof sh.oninput=="function"}yu=Eu}else yu=!1;r1=yu&&(!document.documentMode||9<document.documentMode)}function ah(){Gs&&(Gs.detachEvent("onpropertychange",n1),da=Gs=null)}function n1(e){if(e.propertyName==="value"&&Ll(da)){var t=[];t1(t,da,e,wf(e)),bp(u_,t)}}function f_(e,t,r){e==="focusin"?(ah(),Gs=t,da=r,Gs.attachEvent("onpropertychange",n1)):e==="focusout"&&ah()}function h_(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ll(da)}function d_(e,t){if(e==="click")return Ll(t)}function p_(e,t){if(e==="input"||e==="change")return Ll(t)}function m_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Nr=typeof Object.is=="function"?Object.is:m_;function pa(e,t){if(Nr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!tc.call(t,i)||!Nr(e[i],t[i]))return!1}return!0}function oh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lh(e,t){var r=oh(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=oh(r)}}function i1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?i1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function s1(){for(var e=window,t=zo();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=zo(e.document)}return t}function Rf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function v_(e){var t=s1(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&i1(r.ownerDocument.documentElement,r)){if(n!==null&&Rf(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=lh(r,s);var a=lh(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var g_=en&&"documentMode"in document&&11>=document.documentMode,Bi=null,wc=null,Ks=null,yc=!1;function uh(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;yc||Bi==null||Bi!==zo(n)||(n=Bi,"selectionStart"in n&&Rf(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ks&&pa(Ks,n)||(Ks=n,n=Yo(wc,"onSelect"),0<n.length&&(t=new Af("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Bi)))}function ao(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ui={animationend:ao("Animation","AnimationEnd"),animationiteration:ao("Animation","AnimationIteration"),animationstart:ao("Animation","AnimationStart"),transitionend:ao("Transition","TransitionEnd")},Su={},a1={};en&&(a1=document.createElement("div").style,"AnimationEvent"in window||(delete Ui.animationend.animation,delete Ui.animationiteration.animation,delete Ui.animationstart.animation),"TransitionEvent"in window||delete Ui.transitionend.transition);function bl(e){if(Su[e])return Su[e];if(!Ui[e])return e;var t=Ui[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in a1)return Su[e]=t[r];return e}var o1=bl("animationend"),l1=bl("animationiteration"),u1=bl("animationstart"),c1=bl("transitionend"),f1=new Map,ch="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bn(e,t){f1.set(e,t),di(t,[e])}for(var Tu=0;Tu<ch.length;Tu++){var ku=ch[Tu],x_=ku.toLowerCase(),__=ku[0].toUpperCase()+ku.slice(1);bn(x_,"on"+__)}bn(o1,"onAnimationEnd");bn(l1,"onAnimationIteration");bn(u1,"onAnimationStart");bn("dblclick","onDoubleClick");bn("focusin","onFocus");bn("focusout","onBlur");bn(c1,"onTransitionEnd");as("onMouseEnter",["mouseout","mouseover"]);as("onMouseLeave",["mouseout","mouseover"]);as("onPointerEnter",["pointerout","pointerover"]);as("onPointerLeave",["pointerout","pointerover"]);di("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));di("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));di("onBeforeInput",["compositionend","keypress","textInput","paste"]);di("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));di("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));di("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var js="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),w_=new Set("cancel close invalid load scroll toggle".split(" ").concat(js));function fh(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,xx(n,t,void 0,e),e.currentTarget=null}function h1(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;fh(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;fh(i,o,u),s=l}}}if(Vo)throw e=vc,Vo=!1,vc=null,e}function Be(e,t){var r=t[Ac];r===void 0&&(r=t[Ac]=new Set);var n=e+"__bubble";r.has(n)||(d1(t,e,2,!1),r.add(n))}function Au(e,t,r){var n=0;t&&(n|=4),d1(r,e,n,t)}var oo="_reactListening"+Math.random().toString(36).slice(2);function ma(e){if(!e[oo]){e[oo]=!0,wp.forEach(function(r){r!=="selectionchange"&&(w_.has(r)||Au(r,!1,e),Au(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[oo]||(t[oo]=!0,Au("selectionchange",!1,t))}}function d1(e,t,r,n){switch(Yp(t)){case 1:var i=Dx;break;case 4:i=Lx;break;default:i=Tf}r=i.bind(null,t,r,e),i=void 0,!mc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Cu(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Jn(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}bp(function(){var u=s,c=wf(r),h=[];e:{var f=f1.get(e);if(f!==void 0){var d=Af,m=e;switch(e){case"keypress":if(Lo(r)===0)break e;case"keydown":case"keyup":d=Yx;break;case"focusin":m="focus",d=wu;break;case"focusout":m="blur",d=wu;break;case"beforeblur":case"afterblur":d=wu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=Z0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=Bx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=Zx;break;case o1:case l1:case u1:d=$x;break;case c1:d=t_;break;case"scroll":d=bx;break;case"wheel":d=n_;break;case"copy":case"cut":case"paste":d=zx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=th}var p=(t&4)!==0,_=!p&&e==="scroll",x=p?f!==null?f+"Capture":null:f;p=[];for(var v=u,g;v!==null;){g=v;var T=g.stateNode;if(g.tag===5&&T!==null&&(g=T,x!==null&&(T=ua(v,x),T!=null&&p.push(va(v,T,g)))),_)break;v=v.return}0<p.length&&(f=new d(f,m,null,r,c),h.push({event:f,listeners:p}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",d=e==="mouseout"||e==="pointerout",f&&r!==dc&&(m=r.relatedTarget||r.fromElement)&&(Jn(m)||m[tn]))break e;if((d||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,d?(m=r.relatedTarget||r.toElement,d=u,m=m?Jn(m):null,m!==null&&(_=pi(m),m!==_||m.tag!==5&&m.tag!==6)&&(m=null)):(d=null,m=u),d!==m)){if(p=Z0,T="onMouseLeave",x="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(p=th,T="onPointerLeave",x="onPointerEnter",v="pointer"),_=d==null?f:ji(d),g=m==null?f:ji(m),f=new p(T,v+"leave",d,r,c),f.target=_,f.relatedTarget=g,T=null,Jn(c)===u&&(p=new p(x,v+"enter",m,r,c),p.target=g,p.relatedTarget=_,T=p),_=T,d&&m)t:{for(p=d,x=m,v=0,g=p;g;g=yi(g))v++;for(g=0,T=x;T;T=yi(T))g++;for(;0<v-g;)p=yi(p),v--;for(;0<g-v;)x=yi(x),g--;for(;v--;){if(p===x||x!==null&&p===x.alternate)break t;p=yi(p),x=yi(x)}p=null}else p=null;d!==null&&hh(h,f,d,p,!1),m!==null&&_!==null&&hh(h,_,m,p,!0)}}e:{if(f=u?ji(u):window,d=f.nodeName&&f.nodeName.toLowerCase(),d==="select"||d==="input"&&f.type==="file")var I=c_;else if(ih(f))if(r1)I=p_;else{I=h_;var L=f_}else(d=f.nodeName)&&d.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(I=d_);if(I&&(I=I(e,u))){t1(h,I,r,c);break e}L&&L(e,f,u),e==="focusout"&&(L=f._wrapperState)&&L.controlled&&f.type==="number"&&lc(f,"number",f.value)}switch(L=u?ji(u):window,e){case"focusin":(ih(L)||L.contentEditable==="true")&&(Bi=L,wc=u,Ks=null);break;case"focusout":Ks=wc=Bi=null;break;case"mousedown":yc=!0;break;case"contextmenu":case"mouseup":case"dragend":yc=!1,uh(h,r,c);break;case"selectionchange":if(g_)break;case"keydown":case"keyup":uh(h,r,c)}var A;if(Of)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Mi?Zp(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(Qp&&r.locale!=="ko"&&(Mi||P!=="onCompositionStart"?P==="onCompositionEnd"&&Mi&&(A=Jp()):(xn=c,kf="value"in xn?xn.value:xn.textContent,Mi=!0)),L=Yo(u,P),0<L.length&&(P=new eh(P,e,null,r,c),h.push({event:P,listeners:L}),A?P.data=A:(A=e1(r),A!==null&&(P.data=A)))),(A=s_?a_(e,r):o_(e,r))&&(u=Yo(u,"onBeforeInput"),0<u.length&&(c=new eh("onBeforeInput","beforeinput",null,r,c),h.push({event:c,listeners:u}),c.data=A))}h1(h,t)})}function va(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Yo(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ua(e,r),s!=null&&n.unshift(va(e,s,i)),s=ua(e,t),s!=null&&n.push(va(e,s,i))),e=e.return}return n}function yi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function hh(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=ua(r,s),l!=null&&a.unshift(va(r,l,o))):i||(l=ua(r,s),l!=null&&a.push(va(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var y_=/\r\n?/g,E_=/\u0000|\uFFFD/g;function dh(e){return(typeof e=="string"?e:""+e).replace(y_,`
`).replace(E_,"")}function lo(e,t,r){if(t=dh(t),dh(e)!==t&&r)throw Error(Y(425))}function Jo(){}var Ec=null,Sc=null;function Tc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var kc=typeof setTimeout=="function"?setTimeout:void 0,S_=typeof clearTimeout=="function"?clearTimeout:void 0,ph=typeof Promise=="function"?Promise:void 0,T_=typeof queueMicrotask=="function"?queueMicrotask:typeof ph<"u"?function(e){return ph.resolve(null).then(e).catch(k_)}:kc;function k_(e){setTimeout(function(){throw e})}function Ou(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),ha(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);ha(t)}function An(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function mh(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var gs=Math.random().toString(36).slice(2),Br="__reactFiber$"+gs,ga="__reactProps$"+gs,tn="__reactContainer$"+gs,Ac="__reactEvents$"+gs,A_="__reactListeners$"+gs,C_="__reactHandles$"+gs;function Jn(e){var t=e[Br];if(t)return t;for(var r=e.parentNode;r;){if(t=r[tn]||r[Br]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=mh(e);e!==null;){if(r=e[Br])return r;e=mh(e)}return t}e=r,r=e.parentNode}return null}function $a(e){return e=e[Br]||e[tn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ji(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Y(33))}function Ml(e){return e[ga]||null}var Cc=[],$i=-1;function Mn(e){return{current:e}}function Ue(e){0>$i||(e.current=Cc[$i],Cc[$i]=null,$i--)}function be(e,t){$i++,Cc[$i]=e.current,e.current=t}var Pn={},Nt=Mn(Pn),Wt=Mn(!1),ii=Pn;function os(e,t){var r=e.type.contextTypes;if(!r)return Pn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function zt(e){return e=e.childContextTypes,e!=null}function Qo(){Ue(Wt),Ue(Nt)}function vh(e,t,r){if(Nt.current!==Pn)throw Error(Y(168));be(Nt,t),be(Wt,r)}function p1(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Y(108,fx(e)||"Unknown",i));return Ge({},r,n)}function Zo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pn,ii=Nt.current,be(Nt,e),be(Wt,Wt.current),!0}function gh(e,t,r){var n=e.stateNode;if(!n)throw Error(Y(169));r?(e=p1(e,t,ii),n.__reactInternalMemoizedMergedChildContext=e,Ue(Wt),Ue(Nt),be(Nt,e)):Ue(Wt),be(Wt,r)}var Kr=null,Bl=!1,Ru=!1;function m1(e){Kr===null?Kr=[e]:Kr.push(e)}function O_(e){Bl=!0,m1(e)}function Bn(){if(!Ru&&Kr!==null){Ru=!0;var e=0,t=Fe;try{var r=Kr;for(Fe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Kr=null,Bl=!1}catch(i){throw Kr!==null&&(Kr=Kr.slice(e+1)),jp(yf,Bn),i}finally{Fe=t,Ru=!1}}return null}var Wi=[],zi=0,el=null,tl=0,cr=[],fr=0,si=null,qr=1,Xr="";function Vn(e,t){Wi[zi++]=tl,Wi[zi++]=el,el=e,tl=t}function v1(e,t,r){cr[fr++]=qr,cr[fr++]=Xr,cr[fr++]=si,si=e;var n=qr;e=Xr;var i=32-Or(n)-1;n&=~(1<<i),r+=1;var s=32-Or(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,qr=1<<32-Or(t)+i|r<<i|n,Xr=s+e}else qr=1<<s|r<<i|n,Xr=e}function Ff(e){e.return!==null&&(Vn(e,1),v1(e,1,0))}function Nf(e){for(;e===el;)el=Wi[--zi],Wi[zi]=null,tl=Wi[--zi],Wi[zi]=null;for(;e===si;)si=cr[--fr],cr[fr]=null,Xr=cr[--fr],cr[fr]=null,qr=cr[--fr],cr[fr]=null}var rr=null,tr=null,$e=!1,kr=null;function g1(e,t){var r=hr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function xh(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,rr=e,tr=An(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,rr=e,tr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=si!==null?{id:qr,overflow:Xr}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=hr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,rr=e,tr=null,!0):!1;default:return!1}}function Oc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Rc(e){if($e){var t=tr;if(t){var r=t;if(!xh(e,t)){if(Oc(e))throw Error(Y(418));t=An(r.nextSibling);var n=rr;t&&xh(e,t)?g1(n,r):(e.flags=e.flags&-4097|2,$e=!1,rr=e)}}else{if(Oc(e))throw Error(Y(418));e.flags=e.flags&-4097|2,$e=!1,rr=e}}}function _h(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;rr=e}function uo(e){if(e!==rr)return!1;if(!$e)return _h(e),$e=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Tc(e.type,e.memoizedProps)),t&&(t=tr)){if(Oc(e))throw x1(),Error(Y(418));for(;t;)g1(e,t),t=An(t.nextSibling)}if(_h(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Y(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){tr=An(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}tr=null}}else tr=rr?An(e.stateNode.nextSibling):null;return!0}function x1(){for(var e=tr;e;)e=An(e.nextSibling)}function ls(){tr=rr=null,$e=!1}function Pf(e){kr===null?kr=[e]:kr.push(e)}var R_=on.ReactCurrentBatchConfig;function Ns(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Y(309));var n=r.stateNode}if(!n)throw Error(Y(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(Y(284));if(!r._owner)throw Error(Y(290,e))}return e}function co(e,t){throw e=Object.prototype.toString.call(t),Error(Y(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function wh(e){var t=e._init;return t(e._payload)}function _1(e){function t(x,v){if(e){var g=x.deletions;g===null?(x.deletions=[v],x.flags|=16):g.push(v)}}function r(x,v){if(!e)return null;for(;v!==null;)t(x,v),v=v.sibling;return null}function n(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function i(x,v){return x=Fn(x,v),x.index=0,x.sibling=null,x}function s(x,v,g){return x.index=g,e?(g=x.alternate,g!==null?(g=g.index,g<v?(x.flags|=2,v):g):(x.flags|=2,v)):(x.flags|=1048576,v)}function a(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,v,g,T){return v===null||v.tag!==6?(v=bu(g,x.mode,T),v.return=x,v):(v=i(v,g),v.return=x,v)}function l(x,v,g,T){var I=g.type;return I===bi?c(x,v,g.props.children,T,g.key):v!==null&&(v.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===hn&&wh(I)===v.type)?(T=i(v,g.props),T.ref=Ns(x,v,g),T.return=x,T):(T=Wo(g.type,g.key,g.props,null,x.mode,T),T.ref=Ns(x,v,g),T.return=x,T)}function u(x,v,g,T){return v===null||v.tag!==4||v.stateNode.containerInfo!==g.containerInfo||v.stateNode.implementation!==g.implementation?(v=Mu(g,x.mode,T),v.return=x,v):(v=i(v,g.children||[]),v.return=x,v)}function c(x,v,g,T,I){return v===null||v.tag!==7?(v=ri(g,x.mode,T,I),v.return=x,v):(v=i(v,g),v.return=x,v)}function h(x,v,g){if(typeof v=="string"&&v!==""||typeof v=="number")return v=bu(""+v,x.mode,g),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Za:return g=Wo(v.type,v.key,v.props,null,x.mode,g),g.ref=Ns(x,null,v),g.return=x,g;case Li:return v=Mu(v,x.mode,g),v.return=x,v;case hn:var T=v._init;return h(x,T(v._payload),g)}if(Bs(v)||As(v))return v=ri(v,x.mode,g,null),v.return=x,v;co(x,v)}return null}function f(x,v,g,T){var I=v!==null?v.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return I!==null?null:o(x,v,""+g,T);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Za:return g.key===I?l(x,v,g,T):null;case Li:return g.key===I?u(x,v,g,T):null;case hn:return I=g._init,f(x,v,I(g._payload),T)}if(Bs(g)||As(g))return I!==null?null:c(x,v,g,T,null);co(x,g)}return null}function d(x,v,g,T,I){if(typeof T=="string"&&T!==""||typeof T=="number")return x=x.get(g)||null,o(v,x,""+T,I);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Za:return x=x.get(T.key===null?g:T.key)||null,l(v,x,T,I);case Li:return x=x.get(T.key===null?g:T.key)||null,u(v,x,T,I);case hn:var L=T._init;return d(x,v,g,L(T._payload),I)}if(Bs(T)||As(T))return x=x.get(g)||null,c(v,x,T,I,null);co(v,T)}return null}function m(x,v,g,T){for(var I=null,L=null,A=v,P=v=0,N=null;A!==null&&P<g.length;P++){A.index>P?(N=A,A=null):N=A.sibling;var W=f(x,A,g[P],T);if(W===null){A===null&&(A=N);break}e&&A&&W.alternate===null&&t(x,A),v=s(W,v,P),L===null?I=W:L.sibling=W,L=W,A=N}if(P===g.length)return r(x,A),$e&&Vn(x,P),I;if(A===null){for(;P<g.length;P++)A=h(x,g[P],T),A!==null&&(v=s(A,v,P),L===null?I=A:L.sibling=A,L=A);return $e&&Vn(x,P),I}for(A=n(x,A);P<g.length;P++)N=d(A,x,P,g[P],T),N!==null&&(e&&N.alternate!==null&&A.delete(N.key===null?P:N.key),v=s(N,v,P),L===null?I=N:L.sibling=N,L=N);return e&&A.forEach(function(G){return t(x,G)}),$e&&Vn(x,P),I}function p(x,v,g,T){var I=As(g);if(typeof I!="function")throw Error(Y(150));if(g=I.call(g),g==null)throw Error(Y(151));for(var L=I=null,A=v,P=v=0,N=null,W=g.next();A!==null&&!W.done;P++,W=g.next()){A.index>P?(N=A,A=null):N=A.sibling;var G=f(x,A,W.value,T);if(G===null){A===null&&(A=N);break}e&&A&&G.alternate===null&&t(x,A),v=s(G,v,P),L===null?I=G:L.sibling=G,L=G,A=N}if(W.done)return r(x,A),$e&&Vn(x,P),I;if(A===null){for(;!W.done;P++,W=g.next())W=h(x,W.value,T),W!==null&&(v=s(W,v,P),L===null?I=W:L.sibling=W,L=W);return $e&&Vn(x,P),I}for(A=n(x,A);!W.done;P++,W=g.next())W=d(A,x,P,W.value,T),W!==null&&(e&&W.alternate!==null&&A.delete(W.key===null?P:W.key),v=s(W,v,P),L===null?I=W:L.sibling=W,L=W);return e&&A.forEach(function(q){return t(x,q)}),$e&&Vn(x,P),I}function _(x,v,g,T){if(typeof g=="object"&&g!==null&&g.type===bi&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Za:e:{for(var I=g.key,L=v;L!==null;){if(L.key===I){if(I=g.type,I===bi){if(L.tag===7){r(x,L.sibling),v=i(L,g.props.children),v.return=x,x=v;break e}}else if(L.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===hn&&wh(I)===L.type){r(x,L.sibling),v=i(L,g.props),v.ref=Ns(x,L,g),v.return=x,x=v;break e}r(x,L);break}else t(x,L);L=L.sibling}g.type===bi?(v=ri(g.props.children,x.mode,T,g.key),v.return=x,x=v):(T=Wo(g.type,g.key,g.props,null,x.mode,T),T.ref=Ns(x,v,g),T.return=x,x=T)}return a(x);case Li:e:{for(L=g.key;v!==null;){if(v.key===L)if(v.tag===4&&v.stateNode.containerInfo===g.containerInfo&&v.stateNode.implementation===g.implementation){r(x,v.sibling),v=i(v,g.children||[]),v.return=x,x=v;break e}else{r(x,v);break}else t(x,v);v=v.sibling}v=Mu(g,x.mode,T),v.return=x,x=v}return a(x);case hn:return L=g._init,_(x,v,L(g._payload),T)}if(Bs(g))return m(x,v,g,T);if(As(g))return p(x,v,g,T);co(x,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,v!==null&&v.tag===6?(r(x,v.sibling),v=i(v,g),v.return=x,x=v):(r(x,v),v=bu(g,x.mode,T),v.return=x,x=v),a(x)):r(x,v)}return _}var us=_1(!0),w1=_1(!1),rl=Mn(null),nl=null,Hi=null,If=null;function Df(){If=Hi=nl=null}function Lf(e){var t=rl.current;Ue(rl),e._currentValue=t}function Fc(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Zi(e,t){nl=e,If=Hi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&($t=!0),e.firstContext=null)}function pr(e){var t=e._currentValue;if(If!==e)if(e={context:e,memoizedValue:t,next:null},Hi===null){if(nl===null)throw Error(Y(308));Hi=e,nl.dependencies={lanes:0,firstContext:e}}else Hi=Hi.next=e;return t}var Qn=null;function bf(e){Qn===null?Qn=[e]:Qn.push(e)}function y1(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,bf(t)):(r.next=i.next,i.next=r),t.interleaved=r,rn(e,n)}function rn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var dn=!1;function Mf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function E1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Yr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Cn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ee&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,rn(e,r)}return i=n.interleaved,i===null?(t.next=t,bf(n)):(t.next=i.next,i.next=t),n.interleaved=t,rn(e,r)}function bo(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Ef(e,r)}}function yh(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function il(e,t,r,n){var i=e.updateQueue;dn=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var c=e.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,c=u=l=null,o=s;do{var f=o.lane,d=o.eventTime;if((n&f)===f){c!==null&&(c=c.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,p=o;switch(f=t,d=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){h=m.call(d,h,f);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,f=typeof m=="function"?m.call(d,h,f):m,f==null)break e;h=Ge({},h,f);break e;case 2:dn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=i.effects,f===null?i.effects=[o]:f.push(o))}else d={eventTime:d,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=d,l=h):c=c.next=d,a|=f;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;f=o,o=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);oi|=a,e.lanes=a,e.memoizedState=h}}function Eh(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Y(191,i));i.call(n)}}}var Wa={},jr=Mn(Wa),xa=Mn(Wa),_a=Mn(Wa);function Zn(e){if(e===Wa)throw Error(Y(174));return e}function Bf(e,t){switch(be(_a,t),be(xa,e),be(jr,Wa),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:cc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=cc(t,e)}Ue(jr),be(jr,t)}function cs(){Ue(jr),Ue(xa),Ue(_a)}function S1(e){Zn(_a.current);var t=Zn(jr.current),r=cc(t,e.type);t!==r&&(be(xa,e),be(jr,r))}function Uf(e){xa.current===e&&(Ue(jr),Ue(xa))}var He=Mn(0);function sl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Fu=[];function jf(){for(var e=0;e<Fu.length;e++)Fu[e]._workInProgressVersionPrimary=null;Fu.length=0}var Mo=on.ReactCurrentDispatcher,Nu=on.ReactCurrentBatchConfig,ai=0,Ve=null,ot=null,ut=null,al=!1,qs=!1,wa=0,F_=0;function At(){throw Error(Y(321))}function $f(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Nr(e[r],t[r]))return!1;return!0}function Wf(e,t,r,n,i,s){if(ai=s,Ve=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Mo.current=e===null||e.memoizedState===null?D_:L_,e=r(n,i),qs){s=0;do{if(qs=!1,wa=0,25<=s)throw Error(Y(301));s+=1,ut=ot=null,t.updateQueue=null,Mo.current=b_,e=r(n,i)}while(qs)}if(Mo.current=ol,t=ot!==null&&ot.next!==null,ai=0,ut=ot=Ve=null,al=!1,t)throw Error(Y(300));return e}function zf(){var e=wa!==0;return wa=0,e}function Mr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ut===null?Ve.memoizedState=ut=e:ut=ut.next=e,ut}function mr(){if(ot===null){var e=Ve.alternate;e=e!==null?e.memoizedState:null}else e=ot.next;var t=ut===null?Ve.memoizedState:ut.next;if(t!==null)ut=t,ot=e;else{if(e===null)throw Error(Y(310));ot=e,e={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},ut===null?Ve.memoizedState=ut=e:ut=ut.next=e}return ut}function ya(e,t){return typeof t=="function"?t(e):t}function Pu(e){var t=mr(),r=t.queue;if(r===null)throw Error(Y(311));r.lastRenderedReducer=e;var n=ot,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var c=u.lane;if((ai&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,Ve.lanes|=c,oi|=c}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,Nr(n,t.memoizedState)||($t=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Ve.lanes|=s,oi|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Iu(e){var t=mr(),r=t.queue;if(r===null)throw Error(Y(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);Nr(s,t.memoizedState)||($t=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function T1(){}function k1(e,t){var r=Ve,n=mr(),i=t(),s=!Nr(n.memoizedState,i);if(s&&(n.memoizedState=i,$t=!0),n=n.queue,Hf(O1.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||ut!==null&&ut.memoizedState.tag&1){if(r.flags|=2048,Ea(9,C1.bind(null,r,n,i,t),void 0,null),dt===null)throw Error(Y(349));ai&30||A1(r,t,i)}return i}function A1(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ve.updateQueue,t===null?(t={lastEffect:null,stores:null},Ve.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function C1(e,t,r,n){t.value=r,t.getSnapshot=n,R1(t)&&F1(e)}function O1(e,t,r){return r(function(){R1(t)&&F1(e)})}function R1(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Nr(e,r)}catch{return!0}}function F1(e){var t=rn(e,1);t!==null&&Rr(t,e,1,-1)}function Sh(e){var t=Mr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:e},t.queue=e,e=e.dispatch=I_.bind(null,Ve,e),[t.memoizedState,e]}function Ea(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ve.updateQueue,t===null?(t={lastEffect:null,stores:null},Ve.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function N1(){return mr().memoizedState}function Bo(e,t,r,n){var i=Mr();Ve.flags|=e,i.memoizedState=Ea(1|t,r,void 0,n===void 0?null:n)}function Ul(e,t,r,n){var i=mr();n=n===void 0?null:n;var s=void 0;if(ot!==null){var a=ot.memoizedState;if(s=a.destroy,n!==null&&$f(n,a.deps)){i.memoizedState=Ea(t,r,s,n);return}}Ve.flags|=e,i.memoizedState=Ea(1|t,r,s,n)}function Th(e,t){return Bo(8390656,8,e,t)}function Hf(e,t){return Ul(2048,8,e,t)}function P1(e,t){return Ul(4,2,e,t)}function I1(e,t){return Ul(4,4,e,t)}function D1(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function L1(e,t,r){return r=r!=null?r.concat([e]):null,Ul(4,4,D1.bind(null,t,e),r)}function Vf(){}function b1(e,t){var r=mr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&$f(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function M1(e,t){var r=mr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&$f(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function B1(e,t,r){return ai&21?(Nr(r,t)||(r=zp(),Ve.lanes|=r,oi|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,$t=!0),e.memoizedState=r)}function N_(e,t){var r=Fe;Fe=r!==0&&4>r?r:4,e(!0);var n=Nu.transition;Nu.transition={};try{e(!1),t()}finally{Fe=r,Nu.transition=n}}function U1(){return mr().memoizedState}function P_(e,t,r){var n=Rn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},j1(e))$1(t,r);else if(r=y1(e,t,r,n),r!==null){var i=bt();Rr(r,e,n,i),W1(r,t,n)}}function I_(e,t,r){var n=Rn(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(j1(e))$1(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Nr(o,a)){var l=t.interleaved;l===null?(i.next=i,bf(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=y1(e,t,i,n),r!==null&&(i=bt(),Rr(r,e,n,i),W1(r,t,n))}}function j1(e){var t=e.alternate;return e===Ve||t!==null&&t===Ve}function $1(e,t){qs=al=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function W1(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Ef(e,r)}}var ol={readContext:pr,useCallback:At,useContext:At,useEffect:At,useImperativeHandle:At,useInsertionEffect:At,useLayoutEffect:At,useMemo:At,useReducer:At,useRef:At,useState:At,useDebugValue:At,useDeferredValue:At,useTransition:At,useMutableSource:At,useSyncExternalStore:At,useId:At,unstable_isNewReconciler:!1},D_={readContext:pr,useCallback:function(e,t){return Mr().memoizedState=[e,t===void 0?null:t],e},useContext:pr,useEffect:Th,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Bo(4194308,4,D1.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Bo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Bo(4,2,e,t)},useMemo:function(e,t){var r=Mr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Mr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=P_.bind(null,Ve,e),[n.memoizedState,e]},useRef:function(e){var t=Mr();return e={current:e},t.memoizedState=e},useState:Sh,useDebugValue:Vf,useDeferredValue:function(e){return Mr().memoizedState=e},useTransition:function(){var e=Sh(!1),t=e[0];return e=N_.bind(null,e[1]),Mr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ve,i=Mr();if($e){if(r===void 0)throw Error(Y(407));r=r()}else{if(r=t(),dt===null)throw Error(Y(349));ai&30||A1(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Th(O1.bind(null,n,s,e),[e]),n.flags|=2048,Ea(9,C1.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Mr(),t=dt.identifierPrefix;if($e){var r=Xr,n=qr;r=(n&~(1<<32-Or(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=wa++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=F_++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},L_={readContext:pr,useCallback:b1,useContext:pr,useEffect:Hf,useImperativeHandle:L1,useInsertionEffect:P1,useLayoutEffect:I1,useMemo:M1,useReducer:Pu,useRef:N1,useState:function(){return Pu(ya)},useDebugValue:Vf,useDeferredValue:function(e){var t=mr();return B1(t,ot.memoizedState,e)},useTransition:function(){var e=Pu(ya)[0],t=mr().memoizedState;return[e,t]},useMutableSource:T1,useSyncExternalStore:k1,useId:U1,unstable_isNewReconciler:!1},b_={readContext:pr,useCallback:b1,useContext:pr,useEffect:Hf,useImperativeHandle:L1,useInsertionEffect:P1,useLayoutEffect:I1,useMemo:M1,useReducer:Iu,useRef:N1,useState:function(){return Iu(ya)},useDebugValue:Vf,useDeferredValue:function(e){var t=mr();return ot===null?t.memoizedState=e:B1(t,ot.memoizedState,e)},useTransition:function(){var e=Iu(ya)[0],t=mr().memoizedState;return[e,t]},useMutableSource:T1,useSyncExternalStore:k1,useId:U1,unstable_isNewReconciler:!1};function yr(e,t){if(e&&e.defaultProps){t=Ge({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Nc(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ge({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var jl={isMounted:function(e){return(e=e._reactInternals)?pi(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=bt(),i=Rn(e),s=Yr(n,i);s.payload=t,r!=null&&(s.callback=r),t=Cn(e,s,i),t!==null&&(Rr(t,e,i,n),bo(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=bt(),i=Rn(e),s=Yr(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Cn(e,s,i),t!==null&&(Rr(t,e,i,n),bo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=bt(),n=Rn(e),i=Yr(r,n);i.tag=2,t!=null&&(i.callback=t),t=Cn(e,i,n),t!==null&&(Rr(t,e,n,r),bo(t,e,n))}};function kh(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!pa(r,n)||!pa(i,s):!0}function z1(e,t,r){var n=!1,i=Pn,s=t.contextType;return typeof s=="object"&&s!==null?s=pr(s):(i=zt(t)?ii:Nt.current,n=t.contextTypes,s=(n=n!=null)?os(e,i):Pn),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=jl,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Ah(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&jl.enqueueReplaceState(t,t.state,null)}function Pc(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},Mf(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=pr(s):(s=zt(t)?ii:Nt.current,i.context=os(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Nc(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&jl.enqueueReplaceState(i,i.state,null),il(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function fs(e,t){try{var r="",n=t;do r+=cx(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Du(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Ic(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var M_=typeof WeakMap=="function"?WeakMap:Map;function H1(e,t,r){r=Yr(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){ul||(ul=!0,zc=n),Ic(e,t)},r}function V1(e,t,r){r=Yr(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Ic(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Ic(e,t),typeof n!="function"&&(On===null?On=new Set([this]):On.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function Ch(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new M_;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=J_.bind(null,e,t,r),t.then(e,e))}function Oh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Rh(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Yr(-1,1),t.tag=2,Cn(r,t,1))),r.lanes|=1),e)}var B_=on.ReactCurrentOwner,$t=!1;function It(e,t,r,n){t.child=e===null?w1(t,null,r,n):us(t,e.child,r,n)}function Fh(e,t,r,n,i){r=r.render;var s=t.ref;return Zi(t,i),n=Wf(e,t,r,n,s,i),r=zf(),e!==null&&!$t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,nn(e,t,i)):($e&&r&&Ff(t),t.flags|=1,It(e,t,n,i),t.child)}function Nh(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!Zf(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,G1(e,t,s,n,i)):(e=Wo(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:pa,r(a,n)&&e.ref===t.ref)return nn(e,t,i)}return t.flags|=1,e=Fn(s,n),e.ref=t.ref,e.return=t,t.child=e}function G1(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(pa(s,n)&&e.ref===t.ref)if($t=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&($t=!0);else return t.lanes=e.lanes,nn(e,t,i)}return Dc(e,t,r,n,i)}function K1(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},be(Gi,Yt),Yt|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,be(Gi,Yt),Yt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,be(Gi,Yt),Yt|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,be(Gi,Yt),Yt|=n;return It(e,t,i,r),t.child}function q1(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Dc(e,t,r,n,i){var s=zt(r)?ii:Nt.current;return s=os(t,s),Zi(t,i),r=Wf(e,t,r,n,s,i),n=zf(),e!==null&&!$t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,nn(e,t,i)):($e&&n&&Ff(t),t.flags|=1,It(e,t,r,i),t.child)}function Ph(e,t,r,n,i){if(zt(r)){var s=!0;Zo(t)}else s=!1;if(Zi(t,i),t.stateNode===null)Uo(e,t),z1(t,r,n),Pc(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=pr(u):(u=zt(r)?ii:Nt.current,u=os(t,u));var c=r.getDerivedStateFromProps,h=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&Ah(t,a,n,u),dn=!1;var f=t.memoizedState;a.state=f,il(t,n,a,i),l=t.memoizedState,o!==n||f!==l||Wt.current||dn?(typeof c=="function"&&(Nc(t,r,c,n),l=t.memoizedState),(o=dn||kh(t,r,o,n,f,l,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,E1(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:yr(t.type,o),a.props=u,h=t.pendingProps,f=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=pr(l):(l=zt(r)?ii:Nt.current,l=os(t,l));var d=r.getDerivedStateFromProps;(c=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||f!==l)&&Ah(t,a,n,l),dn=!1,f=t.memoizedState,a.state=f,il(t,n,a,i);var m=t.memoizedState;o!==h||f!==m||Wt.current||dn?(typeof d=="function"&&(Nc(t,r,d,n),m=t.memoizedState),(u=dn||kh(t,r,u,n,f,m,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,m,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,m,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),a.props=n,a.state=m,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return Lc(e,t,r,n,s,i)}function Lc(e,t,r,n,i,s){q1(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&gh(t,r,!1),nn(e,t,s);n=t.stateNode,B_.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=us(t,e.child,null,s),t.child=us(t,null,o,s)):It(e,t,o,s),t.memoizedState=n.state,i&&gh(t,r,!0),t.child}function X1(e){var t=e.stateNode;t.pendingContext?vh(e,t.pendingContext,t.pendingContext!==t.context):t.context&&vh(e,t.context,!1),Bf(e,t.containerInfo)}function Ih(e,t,r,n,i){return ls(),Pf(i),t.flags|=256,It(e,t,r,n),t.child}var bc={dehydrated:null,treeContext:null,retryLane:0};function Mc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Y1(e,t,r){var n=t.pendingProps,i=He.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),be(He,i&1),e===null)return Rc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=zl(a,n,0,null),e=ri(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Mc(r),t.memoizedState=bc,e):Gf(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return U_(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Fn(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Fn(o,s):(s=ri(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?Mc(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=bc,n}return s=e.child,e=s.sibling,n=Fn(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Gf(e,t){return t=zl({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function fo(e,t,r,n){return n!==null&&Pf(n),us(t,e.child,null,r),e=Gf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function U_(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=Du(Error(Y(422))),fo(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=zl({mode:"visible",children:n.children},i,0,null),s=ri(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&us(t,e.child,null,a),t.child.memoizedState=Mc(a),t.memoizedState=bc,s);if(!(t.mode&1))return fo(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Y(419)),n=Du(s,n,void 0),fo(e,t,a,n)}if(o=(a&e.childLanes)!==0,$t||o){if(n=dt,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,rn(e,i),Rr(n,e,i,-1))}return Qf(),n=Du(Error(Y(421))),fo(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=Q_.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,tr=An(i.nextSibling),rr=t,$e=!0,kr=null,e!==null&&(cr[fr++]=qr,cr[fr++]=Xr,cr[fr++]=si,qr=e.id,Xr=e.overflow,si=t),t=Gf(t,n.children),t.flags|=4096,t)}function Dh(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Fc(e.return,t,r)}function Lu(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function J1(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(It(e,t,n.children,r),n=He.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Dh(e,r,t);else if(e.tag===19)Dh(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(be(He,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&sl(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Lu(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&sl(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Lu(t,!0,r,null,s);break;case"together":Lu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Uo(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function nn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),oi|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Y(153));if(t.child!==null){for(e=t.child,r=Fn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Fn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function j_(e,t,r){switch(t.tag){case 3:X1(t),ls();break;case 5:S1(t);break;case 1:zt(t.type)&&Zo(t);break;case 4:Bf(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;be(rl,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(be(He,He.current&1),t.flags|=128,null):r&t.child.childLanes?Y1(e,t,r):(be(He,He.current&1),e=nn(e,t,r),e!==null?e.sibling:null);be(He,He.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return J1(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),be(He,He.current),n)break;return null;case 22:case 23:return t.lanes=0,K1(e,t,r)}return nn(e,t,r)}var Q1,Bc,Z1,em;Q1=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Bc=function(){};Z1=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Zn(jr.current);var s=null;switch(r){case"input":i=ac(e,i),n=ac(e,n),s=[];break;case"select":i=Ge({},i,{value:void 0}),n=Ge({},n,{value:void 0}),s=[];break;case"textarea":i=uc(e,i),n=uc(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Jo)}fc(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(oa.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(oa.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Be("scroll",e),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};em=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ps(e,t){if(!$e)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ct(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function $_(e,t,r){var n=t.pendingProps;switch(Nf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ct(t),null;case 1:return zt(t.type)&&Qo(),Ct(t),null;case 3:return n=t.stateNode,cs(),Ue(Wt),Ue(Nt),jf(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(uo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,kr!==null&&(Gc(kr),kr=null))),Bc(e,t),Ct(t),null;case 5:Uf(t);var i=Zn(_a.current);if(r=t.type,e!==null&&t.stateNode!=null)Z1(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Y(166));return Ct(t),null}if(e=Zn(jr.current),uo(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Br]=t,n[ga]=s,e=(t.mode&1)!==0,r){case"dialog":Be("cancel",n),Be("close",n);break;case"iframe":case"object":case"embed":Be("load",n);break;case"video":case"audio":for(i=0;i<js.length;i++)Be(js[i],n);break;case"source":Be("error",n);break;case"img":case"image":case"link":Be("error",n),Be("load",n);break;case"details":Be("toggle",n);break;case"input":z0(n,s),Be("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Be("invalid",n);break;case"textarea":V0(n,s),Be("invalid",n)}fc(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&lo(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&lo(n.textContent,o,e),i=["children",""+o]):oa.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Be("scroll",n)}switch(r){case"input":eo(n),H0(n,s,!0);break;case"textarea":eo(n),G0(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Jo)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Op(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[Br]=t,e[ga]=n,Q1(e,t,!1,!1),t.stateNode=e;e:{switch(a=hc(r,n),r){case"dialog":Be("cancel",e),Be("close",e),i=n;break;case"iframe":case"object":case"embed":Be("load",e),i=n;break;case"video":case"audio":for(i=0;i<js.length;i++)Be(js[i],e);i=n;break;case"source":Be("error",e),i=n;break;case"img":case"image":case"link":Be("error",e),Be("load",e),i=n;break;case"details":Be("toggle",e),i=n;break;case"input":z0(e,n),i=ac(e,n),Be("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Ge({},n,{value:void 0}),Be("invalid",e);break;case"textarea":V0(e,n),i=uc(e,n),Be("invalid",e);break;default:i=n}fc(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Np(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Rp(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&la(e,l):typeof l=="number"&&la(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(oa.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Be("scroll",e):l!=null&&vf(e,s,l,a))}switch(r){case"input":eo(e),H0(e,n,!1);break;case"textarea":eo(e),G0(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Nn(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Xi(e,!!n.multiple,s,!1):n.defaultValue!=null&&Xi(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Jo)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ct(t),null;case 6:if(e&&t.stateNode!=null)em(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Y(166));if(r=Zn(_a.current),Zn(jr.current),uo(t)){if(n=t.stateNode,r=t.memoizedProps,n[Br]=t,(s=n.nodeValue!==r)&&(e=rr,e!==null))switch(e.tag){case 3:lo(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&lo(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Br]=t,t.stateNode=n}return Ct(t),null;case 13:if(Ue(He),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($e&&tr!==null&&t.mode&1&&!(t.flags&128))x1(),ls(),t.flags|=98560,s=!1;else if(s=uo(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Y(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Y(317));s[Br]=t}else ls(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ct(t),s=!1}else kr!==null&&(Gc(kr),kr=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||He.current&1?lt===0&&(lt=3):Qf())),t.updateQueue!==null&&(t.flags|=4),Ct(t),null);case 4:return cs(),Bc(e,t),e===null&&ma(t.stateNode.containerInfo),Ct(t),null;case 10:return Lf(t.type._context),Ct(t),null;case 17:return zt(t.type)&&Qo(),Ct(t),null;case 19:if(Ue(He),s=t.memoizedState,s===null)return Ct(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)Ps(s,!1);else{if(lt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=sl(e),a!==null){for(t.flags|=128,Ps(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return be(He,He.current&1|2),t.child}e=e.sibling}s.tail!==null&&Ze()>hs&&(t.flags|=128,n=!0,Ps(s,!1),t.lanes=4194304)}else{if(!n)if(e=sl(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ps(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!$e)return Ct(t),null}else 2*Ze()-s.renderingStartTime>hs&&r!==1073741824&&(t.flags|=128,n=!0,Ps(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ze(),t.sibling=null,r=He.current,be(He,n?r&1|2:r&1),t):(Ct(t),null);case 22:case 23:return Jf(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Yt&1073741824&&(Ct(t),t.subtreeFlags&6&&(t.flags|=8192)):Ct(t),null;case 24:return null;case 25:return null}throw Error(Y(156,t.tag))}function W_(e,t){switch(Nf(t),t.tag){case 1:return zt(t.type)&&Qo(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return cs(),Ue(Wt),Ue(Nt),jf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Uf(t),null;case 13:if(Ue(He),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Y(340));ls()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ue(He),null;case 4:return cs(),null;case 10:return Lf(t.type._context),null;case 22:case 23:return Jf(),null;case 24:return null;default:return null}}var ho=!1,Ot=!1,z_=typeof WeakSet=="function"?WeakSet:Set,ae=null;function Vi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Xe(e,t,n)}else r.current=null}function Uc(e,t,r){try{r()}catch(n){Xe(e,t,n)}}var Lh=!1;function H_(e,t){if(Ec=qo,e=s1(),Rf(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,c=0,h=e,f=null;t:for(;;){for(var d;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(d=h.firstChild)!==null;)f=h,h=d;for(;;){if(h===e)break t;if(f===r&&++u===i&&(o=a),f===s&&++c===n&&(l=a),(d=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=d}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Sc={focusedElem:e,selectionRange:r},qo=!1,ae=t;ae!==null;)if(t=ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ae=e;else for(;ae!==null;){t=ae;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,_=m.memoizedState,x=t.stateNode,v=x.getSnapshotBeforeUpdate(t.elementType===t.type?p:yr(t.type,p),_);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Y(163))}}catch(T){Xe(t,t.return,T)}if(e=t.sibling,e!==null){e.return=t.return,ae=e;break}ae=t.return}return m=Lh,Lh=!1,m}function Xs(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Uc(t,r,s)}i=i.next}while(i!==n)}}function $l(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function jc(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function tm(e){var t=e.alternate;t!==null&&(e.alternate=null,tm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Br],delete t[ga],delete t[Ac],delete t[A_],delete t[C_])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function rm(e){return e.tag===5||e.tag===3||e.tag===4}function bh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||rm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function $c(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Jo));else if(n!==4&&(e=e.child,e!==null))for($c(e,t,r),e=e.sibling;e!==null;)$c(e,t,r),e=e.sibling}function Wc(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Wc(e,t,r),e=e.sibling;e!==null;)Wc(e,t,r),e=e.sibling}var gt=null,Sr=!1;function cn(e,t,r){for(r=r.child;r!==null;)nm(e,t,r),r=r.sibling}function nm(e,t,r){if(Ur&&typeof Ur.onCommitFiberUnmount=="function")try{Ur.onCommitFiberUnmount(Il,r)}catch{}switch(r.tag){case 5:Ot||Vi(r,t);case 6:var n=gt,i=Sr;gt=null,cn(e,t,r),gt=n,Sr=i,gt!==null&&(Sr?(e=gt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):gt.removeChild(r.stateNode));break;case 18:gt!==null&&(Sr?(e=gt,r=r.stateNode,e.nodeType===8?Ou(e.parentNode,r):e.nodeType===1&&Ou(e,r),ha(e)):Ou(gt,r.stateNode));break;case 4:n=gt,i=Sr,gt=r.stateNode.containerInfo,Sr=!0,cn(e,t,r),gt=n,Sr=i;break;case 0:case 11:case 14:case 15:if(!Ot&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Uc(r,t,a),i=i.next}while(i!==n)}cn(e,t,r);break;case 1:if(!Ot&&(Vi(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Xe(r,t,o)}cn(e,t,r);break;case 21:cn(e,t,r);break;case 22:r.mode&1?(Ot=(n=Ot)||r.memoizedState!==null,cn(e,t,r),Ot=n):cn(e,t,r);break;default:cn(e,t,r)}}function Mh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new z_),t.forEach(function(n){var i=Z_.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function gr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:gt=o.stateNode,Sr=!1;break e;case 3:gt=o.stateNode.containerInfo,Sr=!0;break e;case 4:gt=o.stateNode.containerInfo,Sr=!0;break e}o=o.return}if(gt===null)throw Error(Y(160));nm(s,a,i),gt=null,Sr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Xe(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)im(t,e),t=t.sibling}function im(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gr(t,e),Dr(e),n&4){try{Xs(3,e,e.return),$l(3,e)}catch(p){Xe(e,e.return,p)}try{Xs(5,e,e.return)}catch(p){Xe(e,e.return,p)}}break;case 1:gr(t,e),Dr(e),n&512&&r!==null&&Vi(r,r.return);break;case 5:if(gr(t,e),Dr(e),n&512&&r!==null&&Vi(r,r.return),e.flags&32){var i=e.stateNode;try{la(i,"")}catch(p){Xe(e,e.return,p)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Ap(i,s),hc(o,a);var u=hc(o,s);for(a=0;a<l.length;a+=2){var c=l[a],h=l[a+1];c==="style"?Np(i,h):c==="dangerouslySetInnerHTML"?Rp(i,h):c==="children"?la(i,h):vf(i,c,h,u)}switch(o){case"input":oc(i,s);break;case"textarea":Cp(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?Xi(i,!!s.multiple,d,!1):f!==!!s.multiple&&(s.defaultValue!=null?Xi(i,!!s.multiple,s.defaultValue,!0):Xi(i,!!s.multiple,s.multiple?[]:"",!1))}i[ga]=s}catch(p){Xe(e,e.return,p)}}break;case 6:if(gr(t,e),Dr(e),n&4){if(e.stateNode===null)throw Error(Y(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(p){Xe(e,e.return,p)}}break;case 3:if(gr(t,e),Dr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ha(t.containerInfo)}catch(p){Xe(e,e.return,p)}break;case 4:gr(t,e),Dr(e);break;case 13:gr(t,e),Dr(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Xf=Ze())),n&4&&Mh(e);break;case 22:if(c=r!==null&&r.memoizedState!==null,e.mode&1?(Ot=(u=Ot)||c,gr(t,e),Ot=u):gr(t,e),Dr(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!c&&e.mode&1)for(ae=e,c=e.child;c!==null;){for(h=ae=c;ae!==null;){switch(f=ae,d=f.child,f.tag){case 0:case 11:case 14:case 15:Xs(4,f,f.return);break;case 1:Vi(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(p){Xe(n,r,p)}}break;case 5:Vi(f,f.return);break;case 22:if(f.memoizedState!==null){Uh(h);continue}}d!==null?(d.return=f,ae=d):Uh(h)}c=c.sibling}e:for(c=null,h=e;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Fp("display",a))}catch(p){Xe(e,e.return,p)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(p){Xe(e,e.return,p)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gr(t,e),Dr(e),n&4&&Mh(e);break;case 21:break;default:gr(t,e),Dr(e)}}function Dr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(rm(r)){var n=r;break e}r=r.return}throw Error(Y(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(la(i,""),n.flags&=-33);var s=bh(e);Wc(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=bh(e);$c(e,o,a);break;default:throw Error(Y(161))}}catch(l){Xe(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function V_(e,t,r){ae=e,sm(e)}function sm(e,t,r){for(var n=(e.mode&1)!==0;ae!==null;){var i=ae,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||ho;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Ot;o=ho;var u=Ot;if(ho=a,(Ot=l)&&!u)for(ae=i;ae!==null;)a=ae,l=a.child,a.tag===22&&a.memoizedState!==null?jh(i):l!==null?(l.return=a,ae=l):jh(i);for(;s!==null;)ae=s,sm(s),s=s.sibling;ae=i,ho=o,Ot=u}Bh(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ae=s):Bh(e)}}function Bh(e){for(;ae!==null;){var t=ae;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ot||$l(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ot)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:yr(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Eh(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Eh(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&ha(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Y(163))}Ot||t.flags&512&&jc(t)}catch(f){Xe(t,t.return,f)}}if(t===e){ae=null;break}if(r=t.sibling,r!==null){r.return=t.return,ae=r;break}ae=t.return}}function Uh(e){for(;ae!==null;){var t=ae;if(t===e){ae=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ae=r;break}ae=t.return}}function jh(e){for(;ae!==null;){var t=ae;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{$l(4,t)}catch(l){Xe(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){Xe(t,i,l)}}var s=t.return;try{jc(t)}catch(l){Xe(t,s,l)}break;case 5:var a=t.return;try{jc(t)}catch(l){Xe(t,a,l)}}}catch(l){Xe(t,t.return,l)}if(t===e){ae=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ae=o;break}ae=t.return}}var G_=Math.ceil,ll=on.ReactCurrentDispatcher,Kf=on.ReactCurrentOwner,dr=on.ReactCurrentBatchConfig,Ee=0,dt=null,rt=null,yt=0,Yt=0,Gi=Mn(0),lt=0,Sa=null,oi=0,Wl=0,qf=0,Ys=null,jt=null,Xf=0,hs=1/0,Vr=null,ul=!1,zc=null,On=null,po=!1,_n=null,cl=0,Js=0,Hc=null,jo=-1,$o=0;function bt(){return Ee&6?Ze():jo!==-1?jo:jo=Ze()}function Rn(e){return e.mode&1?Ee&2&&yt!==0?yt&-yt:R_.transition!==null?($o===0&&($o=zp()),$o):(e=Fe,e!==0||(e=window.event,e=e===void 0?16:Yp(e.type)),e):1}function Rr(e,t,r,n){if(50<Js)throw Js=0,Hc=null,Error(Y(185));Ua(e,r,n),(!(Ee&2)||e!==dt)&&(e===dt&&(!(Ee&2)&&(Wl|=r),lt===4&&vn(e,yt)),Ht(e,n),r===1&&Ee===0&&!(t.mode&1)&&(hs=Ze()+500,Bl&&Bn()))}function Ht(e,t){var r=e.callbackNode;Rx(e,t);var n=Ko(e,e===dt?yt:0);if(n===0)r!==null&&X0(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&X0(r),t===1)e.tag===0?O_($h.bind(null,e)):m1($h.bind(null,e)),T_(function(){!(Ee&6)&&Bn()}),r=null;else{switch(Hp(n)){case 1:r=yf;break;case 4:r=$p;break;case 16:r=Go;break;case 536870912:r=Wp;break;default:r=Go}r=dm(r,am.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function am(e,t){if(jo=-1,$o=0,Ee&6)throw Error(Y(327));var r=e.callbackNode;if(es()&&e.callbackNode!==r)return null;var n=Ko(e,e===dt?yt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=fl(e,n);else{t=n;var i=Ee;Ee|=2;var s=lm();(dt!==e||yt!==t)&&(Vr=null,hs=Ze()+500,ti(e,t));do try{X_();break}catch(o){om(e,o)}while(!0);Df(),ll.current=s,Ee=i,rt!==null?t=0:(dt=null,yt=0,t=lt)}if(t!==0){if(t===2&&(i=gc(e),i!==0&&(n=i,t=Vc(e,i))),t===1)throw r=Sa,ti(e,0),vn(e,n),Ht(e,Ze()),r;if(t===6)vn(e,n);else{if(i=e.current.alternate,!(n&30)&&!K_(i)&&(t=fl(e,n),t===2&&(s=gc(e),s!==0&&(n=s,t=Vc(e,s))),t===1))throw r=Sa,ti(e,0),vn(e,n),Ht(e,Ze()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Y(345));case 2:Gn(e,jt,Vr);break;case 3:if(vn(e,n),(n&130023424)===n&&(t=Xf+500-Ze(),10<t)){if(Ko(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){bt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=kc(Gn.bind(null,e,jt,Vr),t);break}Gn(e,jt,Vr);break;case 4:if(vn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-Or(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=Ze()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*G_(n/1960))-n,10<n){e.timeoutHandle=kc(Gn.bind(null,e,jt,Vr),n);break}Gn(e,jt,Vr);break;case 5:Gn(e,jt,Vr);break;default:throw Error(Y(329))}}}return Ht(e,Ze()),e.callbackNode===r?am.bind(null,e):null}function Vc(e,t){var r=Ys;return e.current.memoizedState.isDehydrated&&(ti(e,t).flags|=256),e=fl(e,t),e!==2&&(t=jt,jt=r,t!==null&&Gc(t)),e}function Gc(e){jt===null?jt=e:jt.push.apply(jt,e)}function K_(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Nr(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function vn(e,t){for(t&=~qf,t&=~Wl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Or(t),n=1<<r;e[r]=-1,t&=~n}}function $h(e){if(Ee&6)throw Error(Y(327));es();var t=Ko(e,0);if(!(t&1))return Ht(e,Ze()),null;var r=fl(e,t);if(e.tag!==0&&r===2){var n=gc(e);n!==0&&(t=n,r=Vc(e,n))}if(r===1)throw r=Sa,ti(e,0),vn(e,t),Ht(e,Ze()),r;if(r===6)throw Error(Y(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Gn(e,jt,Vr),Ht(e,Ze()),null}function Yf(e,t){var r=Ee;Ee|=1;try{return e(t)}finally{Ee=r,Ee===0&&(hs=Ze()+500,Bl&&Bn())}}function li(e){_n!==null&&_n.tag===0&&!(Ee&6)&&es();var t=Ee;Ee|=1;var r=dr.transition,n=Fe;try{if(dr.transition=null,Fe=1,e)return e()}finally{Fe=n,dr.transition=r,Ee=t,!(Ee&6)&&Bn()}}function Jf(){Yt=Gi.current,Ue(Gi)}function ti(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,S_(r)),rt!==null)for(r=rt.return;r!==null;){var n=r;switch(Nf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Qo();break;case 3:cs(),Ue(Wt),Ue(Nt),jf();break;case 5:Uf(n);break;case 4:cs();break;case 13:Ue(He);break;case 19:Ue(He);break;case 10:Lf(n.type._context);break;case 22:case 23:Jf()}r=r.return}if(dt=e,rt=e=Fn(e.current,null),yt=Yt=t,lt=0,Sa=null,qf=Wl=oi=0,jt=Ys=null,Qn!==null){for(t=0;t<Qn.length;t++)if(r=Qn[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Qn=null}return e}function om(e,t){do{var r=rt;try{if(Df(),Mo.current=ol,al){for(var n=Ve.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}al=!1}if(ai=0,ut=ot=Ve=null,qs=!1,wa=0,Kf.current=null,r===null||r.return===null){lt=1,Sa=t,rt=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=yt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var d=Oh(a);if(d!==null){d.flags&=-257,Rh(d,a,o,s,t),d.mode&1&&Ch(s,u,t),t=d,l=u;var m=t.updateQueue;if(m===null){var p=new Set;p.add(l),t.updateQueue=p}else m.add(l);break e}else{if(!(t&1)){Ch(s,u,t),Qf();break e}l=Error(Y(426))}}else if($e&&o.mode&1){var _=Oh(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),Rh(_,a,o,s,t),Pf(fs(l,o));break e}}s=l=fs(l,o),lt!==4&&(lt=2),Ys===null?Ys=[s]:Ys.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=H1(s,l,t);yh(s,x);break e;case 1:o=l;var v=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(On===null||!On.has(g)))){s.flags|=65536,t&=-t,s.lanes|=t;var T=V1(s,o,t);yh(s,T);break e}}s=s.return}while(s!==null)}cm(r)}catch(I){t=I,rt===r&&r!==null&&(rt=r=r.return);continue}break}while(!0)}function lm(){var e=ll.current;return ll.current=ol,e===null?ol:e}function Qf(){(lt===0||lt===3||lt===2)&&(lt=4),dt===null||!(oi&268435455)&&!(Wl&268435455)||vn(dt,yt)}function fl(e,t){var r=Ee;Ee|=2;var n=lm();(dt!==e||yt!==t)&&(Vr=null,ti(e,t));do try{q_();break}catch(i){om(e,i)}while(!0);if(Df(),Ee=r,ll.current=n,rt!==null)throw Error(Y(261));return dt=null,yt=0,lt}function q_(){for(;rt!==null;)um(rt)}function X_(){for(;rt!==null&&!wx();)um(rt)}function um(e){var t=hm(e.alternate,e,Yt);e.memoizedProps=e.pendingProps,t===null?cm(e):rt=t,Kf.current=null}function cm(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=W_(r,t),r!==null){r.flags&=32767,rt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{lt=6,rt=null;return}}else if(r=$_(r,t,Yt),r!==null){rt=r;return}if(t=t.sibling,t!==null){rt=t;return}rt=t=e}while(t!==null);lt===0&&(lt=5)}function Gn(e,t,r){var n=Fe,i=dr.transition;try{dr.transition=null,Fe=1,Y_(e,t,r,n)}finally{dr.transition=i,Fe=n}return null}function Y_(e,t,r,n){do es();while(_n!==null);if(Ee&6)throw Error(Y(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Y(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(Fx(e,s),e===dt&&(rt=dt=null,yt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||po||(po=!0,dm(Go,function(){return es(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=dr.transition,dr.transition=null;var a=Fe;Fe=1;var o=Ee;Ee|=4,Kf.current=null,H_(e,r),im(r,e),v_(Sc),qo=!!Ec,Sc=Ec=null,e.current=r,V_(r),yx(),Ee=o,Fe=a,dr.transition=s}else e.current=r;if(po&&(po=!1,_n=e,cl=i),s=e.pendingLanes,s===0&&(On=null),Tx(r.stateNode),Ht(e,Ze()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(ul)throw ul=!1,e=zc,zc=null,e;return cl&1&&e.tag!==0&&es(),s=e.pendingLanes,s&1?e===Hc?Js++:(Js=0,Hc=e):Js=0,Bn(),null}function es(){if(_n!==null){var e=Hp(cl),t=dr.transition,r=Fe;try{if(dr.transition=null,Fe=16>e?16:e,_n===null)var n=!1;else{if(e=_n,_n=null,cl=0,Ee&6)throw Error(Y(331));var i=Ee;for(Ee|=4,ae=e.current;ae!==null;){var s=ae,a=s.child;if(ae.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(ae=u;ae!==null;){var c=ae;switch(c.tag){case 0:case 11:case 15:Xs(8,c,s)}var h=c.child;if(h!==null)h.return=c,ae=h;else for(;ae!==null;){c=ae;var f=c.sibling,d=c.return;if(tm(c),c===u){ae=null;break}if(f!==null){f.return=d,ae=f;break}ae=d}}}var m=s.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var _=p.sibling;p.sibling=null,p=_}while(p!==null)}}ae=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,ae=a;else e:for(;ae!==null;){if(s=ae,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Xs(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,ae=x;break e}ae=s.return}}var v=e.current;for(ae=v;ae!==null;){a=ae;var g=a.child;if(a.subtreeFlags&2064&&g!==null)g.return=a,ae=g;else e:for(a=v;ae!==null;){if(o=ae,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:$l(9,o)}}catch(I){Xe(o,o.return,I)}if(o===a){ae=null;break e}var T=o.sibling;if(T!==null){T.return=o.return,ae=T;break e}ae=o.return}}if(Ee=i,Bn(),Ur&&typeof Ur.onPostCommitFiberRoot=="function")try{Ur.onPostCommitFiberRoot(Il,e)}catch{}n=!0}return n}finally{Fe=r,dr.transition=t}}return!1}function Wh(e,t,r){t=fs(r,t),t=H1(e,t,1),e=Cn(e,t,1),t=bt(),e!==null&&(Ua(e,1,t),Ht(e,t))}function Xe(e,t,r){if(e.tag===3)Wh(e,e,r);else for(;t!==null;){if(t.tag===3){Wh(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(On===null||!On.has(n))){e=fs(r,e),e=V1(t,e,1),t=Cn(t,e,1),e=bt(),t!==null&&(Ua(t,1,e),Ht(t,e));break}}t=t.return}}function J_(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=bt(),e.pingedLanes|=e.suspendedLanes&r,dt===e&&(yt&r)===r&&(lt===4||lt===3&&(yt&130023424)===yt&&500>Ze()-Xf?ti(e,0):qf|=r),Ht(e,t)}function fm(e,t){t===0&&(e.mode&1?(t=no,no<<=1,!(no&130023424)&&(no=4194304)):t=1);var r=bt();e=rn(e,t),e!==null&&(Ua(e,t,r),Ht(e,r))}function Q_(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),fm(e,r)}function Z_(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Y(314))}n!==null&&n.delete(t),fm(e,r)}var hm;hm=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Wt.current)$t=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return $t=!1,j_(e,t,r);$t=!!(e.flags&131072)}else $t=!1,$e&&t.flags&1048576&&v1(t,tl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Uo(e,t),e=t.pendingProps;var i=os(t,Nt.current);Zi(t,r),i=Wf(null,t,n,e,i,r);var s=zf();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,zt(n)?(s=!0,Zo(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Mf(t),i.updater=jl,t.stateNode=i,i._reactInternals=t,Pc(t,n,e,r),t=Lc(null,t,n,!0,s,r)):(t.tag=0,$e&&s&&Ff(t),It(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Uo(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=tw(n),e=yr(n,e),i){case 0:t=Dc(null,t,n,e,r);break e;case 1:t=Ph(null,t,n,e,r);break e;case 11:t=Fh(null,t,n,e,r);break e;case 14:t=Nh(null,t,n,yr(n.type,e),r);break e}throw Error(Y(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:yr(n,i),Dc(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:yr(n,i),Ph(e,t,n,i,r);case 3:e:{if(X1(t),e===null)throw Error(Y(387));n=t.pendingProps,s=t.memoizedState,i=s.element,E1(e,t),il(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=fs(Error(Y(423)),t),t=Ih(e,t,n,r,i);break e}else if(n!==i){i=fs(Error(Y(424)),t),t=Ih(e,t,n,r,i);break e}else for(tr=An(t.stateNode.containerInfo.firstChild),rr=t,$e=!0,kr=null,r=w1(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ls(),n===i){t=nn(e,t,r);break e}It(e,t,n,r)}t=t.child}return t;case 5:return S1(t),e===null&&Rc(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,Tc(n,i)?a=null:s!==null&&Tc(n,s)&&(t.flags|=32),q1(e,t),It(e,t,a,r),t.child;case 6:return e===null&&Rc(t),null;case 13:return Y1(e,t,r);case 4:return Bf(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=us(t,null,n,r):It(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:yr(n,i),Fh(e,t,n,i,r);case 7:return It(e,t,t.pendingProps,r),t.child;case 8:return It(e,t,t.pendingProps.children,r),t.child;case 12:return It(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,be(rl,n._currentValue),n._currentValue=a,s!==null)if(Nr(s.value,a)){if(s.children===i.children&&!Wt.current){t=nn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Yr(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Fc(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Y(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Fc(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}It(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Zi(t,r),i=pr(i),n=n(i),t.flags|=1,It(e,t,n,r),t.child;case 14:return n=t.type,i=yr(n,t.pendingProps),i=yr(n.type,i),Nh(e,t,n,i,r);case 15:return G1(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:yr(n,i),Uo(e,t),t.tag=1,zt(n)?(e=!0,Zo(t)):e=!1,Zi(t,r),z1(t,n,i),Pc(t,n,i,r),Lc(null,t,n,!0,e,r);case 19:return J1(e,t,r);case 22:return K1(e,t,r)}throw Error(Y(156,t.tag))};function dm(e,t){return jp(e,t)}function ew(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hr(e,t,r,n){return new ew(e,t,r,n)}function Zf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function tw(e){if(typeof e=="function")return Zf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===xf)return 11;if(e===_f)return 14}return 2}function Fn(e,t){var r=e.alternate;return r===null?(r=hr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Wo(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")Zf(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case bi:return ri(r.children,i,s,t);case gf:a=8,i|=8;break;case rc:return e=hr(12,r,t,i|2),e.elementType=rc,e.lanes=s,e;case nc:return e=hr(13,r,t,i),e.elementType=nc,e.lanes=s,e;case ic:return e=hr(19,r,t,i),e.elementType=ic,e.lanes=s,e;case Sp:return zl(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case yp:a=10;break e;case Ep:a=9;break e;case xf:a=11;break e;case _f:a=14;break e;case hn:a=16,n=null;break e}throw Error(Y(130,e==null?e:typeof e,""))}return t=hr(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function ri(e,t,r,n){return e=hr(7,e,n,t),e.lanes=r,e}function zl(e,t,r,n){return e=hr(22,e,n,t),e.elementType=Sp,e.lanes=r,e.stateNode={isHidden:!1},e}function bu(e,t,r){return e=hr(6,e,null,t),e.lanes=r,e}function Mu(e,t,r){return t=hr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function rw(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gu(0),this.expirationTimes=gu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gu(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function e0(e,t,r,n,i,s,a,o,l){return e=new rw(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=hr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Mf(s),e}function nw(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Li,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function pm(e){if(!e)return Pn;e=e._reactInternals;e:{if(pi(e)!==e||e.tag!==1)throw Error(Y(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(zt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Y(171))}if(e.tag===1){var r=e.type;if(zt(r))return p1(e,r,t)}return t}function mm(e,t,r,n,i,s,a,o,l){return e=e0(r,n,!0,e,i,s,a,o,l),e.context=pm(null),r=e.current,n=bt(),i=Rn(r),s=Yr(n,i),s.callback=t??null,Cn(r,s,i),e.current.lanes=i,Ua(e,i,n),Ht(e,n),e}function Hl(e,t,r,n){var i=t.current,s=bt(),a=Rn(i);return r=pm(r),t.context===null?t.context=r:t.pendingContext=r,t=Yr(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Cn(i,t,a),e!==null&&(Rr(e,i,a,s),bo(e,i,a)),a}function hl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function zh(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function t0(e,t){zh(e,t),(e=e.alternate)&&zh(e,t)}function iw(){return null}var vm=typeof reportError=="function"?reportError:function(e){console.error(e)};function r0(e){this._internalRoot=e}Vl.prototype.render=r0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Y(409));Hl(e,t,null,null)};Vl.prototype.unmount=r0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;li(function(){Hl(null,e,null,null)}),t[tn]=null}};function Vl(e){this._internalRoot=e}Vl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Kp();e={blockedOn:null,target:e,priority:t};for(var r=0;r<mn.length&&t!==0&&t<mn[r].priority;r++);mn.splice(r,0,e),r===0&&Xp(e)}};function n0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Gl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Hh(){}function sw(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=hl(a);s.call(u)}}var a=mm(t,n,e,0,null,!1,!1,"",Hh);return e._reactRootContainer=a,e[tn]=a.current,ma(e.nodeType===8?e.parentNode:e),li(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=hl(l);o.call(u)}}var l=e0(e,0,!1,null,null,!1,!1,"",Hh);return e._reactRootContainer=l,e[tn]=l.current,ma(e.nodeType===8?e.parentNode:e),li(function(){Hl(t,l,r,n)}),l}function Kl(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=hl(a);o.call(l)}}Hl(t,a,e,i)}else a=sw(r,t,e,i,n);return hl(a)}Vp=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Us(t.pendingLanes);r!==0&&(Ef(t,r|1),Ht(t,Ze()),!(Ee&6)&&(hs=Ze()+500,Bn()))}break;case 13:li(function(){var n=rn(e,1);if(n!==null){var i=bt();Rr(n,e,1,i)}}),t0(e,1)}};Sf=function(e){if(e.tag===13){var t=rn(e,134217728);if(t!==null){var r=bt();Rr(t,e,134217728,r)}t0(e,134217728)}};Gp=function(e){if(e.tag===13){var t=Rn(e),r=rn(e,t);if(r!==null){var n=bt();Rr(r,e,t,n)}t0(e,t)}};Kp=function(){return Fe};qp=function(e,t){var r=Fe;try{return Fe=e,t()}finally{Fe=r}};pc=function(e,t,r){switch(t){case"input":if(oc(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Ml(n);if(!i)throw Error(Y(90));kp(n),oc(n,i)}}}break;case"textarea":Cp(e,r);break;case"select":t=r.value,t!=null&&Xi(e,!!r.multiple,t,!1)}};Dp=Yf;Lp=li;var aw={usingClientEntryPoint:!1,Events:[$a,ji,Ml,Pp,Ip,Yf]},Is={findFiberByHostInstance:Jn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ow={bundleType:Is.bundleType,version:Is.version,rendererPackageName:Is.rendererPackageName,rendererConfig:Is.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:on.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Bp(e),e===null?null:e.stateNode},findFiberByHostInstance:Is.findFiberByHostInstance||iw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mo.isDisabled&&mo.supportsFiber)try{Il=mo.inject(ow),Ur=mo}catch{}}sr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aw;sr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!n0(t))throw Error(Y(200));return nw(e,t,null,r)};sr.createRoot=function(e,t){if(!n0(e))throw Error(Y(299));var r=!1,n="",i=vm;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=e0(e,1,!1,null,null,r,!1,n,i),e[tn]=t.current,ma(e.nodeType===8?e.parentNode:e),new r0(t)};sr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Y(188)):(e=Object.keys(e).join(","),Error(Y(268,e)));return e=Bp(t),e=e===null?null:e.stateNode,e};sr.flushSync=function(e){return li(e)};sr.hydrate=function(e,t,r){if(!Gl(t))throw Error(Y(200));return Kl(null,e,t,!0,r)};sr.hydrateRoot=function(e,t,r){if(!n0(e))throw Error(Y(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=vm;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=mm(t,null,e,1,r??null,i,!1,s,a),e[tn]=t.current,ma(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Vl(t)};sr.render=function(e,t,r){if(!Gl(t))throw Error(Y(200));return Kl(null,e,t,!1,r)};sr.unmountComponentAtNode=function(e){if(!Gl(e))throw Error(Y(40));return e._reactRootContainer?(li(function(){Kl(null,null,e,!1,function(){e._reactRootContainer=null,e[tn]=null})}),!0):!1};sr.unstable_batchedUpdates=Yf;sr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Gl(r))throw Error(Y(200));if(e==null||e._reactInternals===void 0)throw Error(Y(38));return Kl(e,t,r,!1,n)};sr.version="18.3.1-next-f1338f8080-20240426";function gm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gm)}catch(e){console.error(e)}}gm(),gp.exports=sr;var lw=gp.exports,Vh=lw;ec.createRoot=Vh.createRoot,ec.hydrateRoot=Vh.hydrateRoot;var Qs=(e=>(e.ADMIN="ADMIN",e.USER="USER",e))(Qs||{});const Gh={username:"summeet"},ui=[{id:"ev_001",name:"Screening Piazza Duomo",date:"2024-05-15",city:"Milano"},{id:"ev_002",name:"Giornata della Salute",date:"2024-06-20",city:"Roma"},{id:"ev_003",name:"Check-up Torino",date:"2024-09-10",city:"Torino"},{id:"ev_004",name:"Prevenzione Cardiovascolare",date:"2024-04-12",city:"Milano"}],Kc=[{id:"eta",text:"Et",type:"text"},{id:"genere",text:"Genere",type:"multiple_choice",options:["M","F"]},{id:"fumo",text:"Fumo attivo o pregresso",type:"multiple_choice",options:["No","Attivo","Ex fumatore"]},{id:"alcol",text:"Consumo alcol",type:"multiple_choice",options:["No","Saltuario","Frequente"]},{id:"fam_cardio",text:"Familiarit per Malattie cardiovascolari precoci (et <55 M)",type:"multiple_choice",options:["S","No"]},{id:"fam_diabete",text:"Familiarit per Diabete tipo 2",type:"multiple_choice",options:["S","No","Non so"]},{id:"dieta",text:"Segue una dieta bilanciata?",type:"multiple_choice",options:["S","No","Non sempre"]},{id:"att_fisica",text:"Pratica attivit fisica regolare (almeno 150 min/settimana)?",type:"multiple_choice",options:["S","No"]},{id:"insonnia",text:"Soffre di insonnia o disturbi del sonno?",type:"multiple_choice",options:["S","No"]},{id:"terapia_ipertensione",text:"Farmaci antiipertensivi in corso",type:"multiple_choice",options:["S","No"]},{id:"terapia_statine",text:"Statine o ipolipemizzanti in corso",type:"multiple_choice",options:["S","No"]},{id:"terapia_diabete",text:"Antidiabetici orali / insulina in corso",type:"multiple_choice",options:["S","No"]},{id:"terapia_anticoagulanti",text:"Anticoagulanti / antiaggreganti in corso",type:"multiple_choice",options:["S","No"]}];function ql(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function uw(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(h){a(h)}}function l(c){try{u(n.throw(c))}catch(h){a(h)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(e,t||[])).next())})}const cw=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class i0 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class fw extends i0{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Kh extends i0{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class qh extends i0{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var qc;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(qc||(qc={}));class hw{constructor(t,{headers:r={},customFetch:n,region:i=qc.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=cw(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return uw(this,arguments,void 0,function*(r,n={}){var i;let s,a;try{const{headers:o,method:l,body:u,signal:c,timeout:h}=n;let f={},{region:d}=n;d||(d=this.region);const m=new URL(`${this.url}/${r}`);d&&d!=="any"&&(f["x-region"]=d,m.searchParams.set("forceFunctionRegion",d));let p;u&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",p=u):typeof u=="string"?(f["Content-Type"]="text/plain",p=u):typeof FormData<"u"&&u instanceof FormData?p=u:(f["Content-Type"]="application/json",p=JSON.stringify(u)):u&&typeof u!="string"&&!(typeof Blob<"u"&&u instanceof Blob)&&!(u instanceof ArrayBuffer)&&!(typeof FormData<"u"&&u instanceof FormData)?p=JSON.stringify(u):p=u;let _=c;h&&(a=new AbortController,s=setTimeout(()=>a.abort(),h),c?(_=a.signal,c.addEventListener("abort",()=>a.abort())):_=a.signal);const x=yield this.fetch(m.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),o),body:p,signal:_}).catch(I=>{throw new fw(I)}),v=x.headers.get("x-relay-error");if(v&&v==="true")throw new Kh(x);if(!x.ok)throw new qh(x);let g=((i=x.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),T;return g==="application/json"?T=yield x.json():g==="application/octet-stream"||g==="application/pdf"?T=yield x.blob():g==="text/event-stream"?T=x:g==="multipart/form-data"?T=yield x.formData():T=yield x.text(),{data:T,error:null,response:x}}catch(o){return{data:null,error:o,response:o instanceof qh||o instanceof Kh?o.context:void 0}}finally{s&&clearTimeout(s)}})}}var dw=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},pw=class{constructor(e){var t,r,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,this.urlLengthLimit=(n=e.urlLengthLimit)!==null&&n!==void 0?n:8e3,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{let a=null,o=null,l=null,u=s.status,c=s.statusText;if(s.ok){var h,f;if(r.method!=="HEAD"){var d;const x=await s.text();x===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((d=r.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?o=x:o=JSON.parse(x))}const p=(h=r.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),_=(f=s.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");p&&_&&_.length>1&&(l=parseInt(_[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(a={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,u=406,c="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var m;const p=await s.text();try{a=JSON.parse(p),Array.isArray(a)&&s.status===404&&(o=[],a=null,u=200,c="OK")}catch{s.status===404&&p===""?(u=204,c="No Content"):a={message:p}}if(a&&r.isMaybeSingle&&(!(a==null||(m=a.details)===null||m===void 0)&&m.includes("0 rows"))&&(a=null,u=200,c="OK"),a&&r.shouldThrowOnError)throw new dw(a)}return{error:a,data:o,count:l,status:u,statusText:c}});return this.shouldThrowOnError||(i=i.catch(s=>{var a;let o="",l="",u="";const c=s==null?void 0:s.cause;if(c){var h,f,d,m;const x=(h=c==null?void 0:c.message)!==null&&h!==void 0?h:"",v=(f=c==null?void 0:c.code)!==null&&f!==void 0?f:"";o=`${(d=s==null?void 0:s.name)!==null&&d!==void 0?d:"FetchError"}: ${s==null?void 0:s.message}`,o+=`

Caused by: ${(m=c==null?void 0:c.name)!==null&&m!==void 0?m:"Error"}: ${x}`,v&&(o+=` (${v})`),c!=null&&c.stack&&(o+=`
${c.stack}`)}else{var p;o=(p=s==null?void 0:s.stack)!==null&&p!==void 0?p:""}const _=this.url.toString().length;return(s==null?void 0:s.name)==="AbortError"||(s==null?void 0:s.code)==="ABORT_ERR"?(u="",l="Request was aborted (timeout or manual cancellation)",_>this.urlLengthLimit&&(l+=`. Note: Your request URL is ${_} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):((c==null?void 0:c.name)==="HeadersOverflowError"||(c==null?void 0:c.code)==="UND_ERR_HEADERS_OVERFLOW")&&(u="",l="HTTP headers exceeded server limits (typically 16KB)",_>this.urlLengthLimit&&(l+=`. Your request URL is ${_} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:o,hint:l,code:u},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},mw=class extends pw{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const s=i?`${i}.order`:"order",a=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(s,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:s="text"}={}){var a;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${l}"; options=${o};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Xh=new RegExp("[,()]");var Ni=class extends mw{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Xh.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Xh.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const s=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},vw=class{constructor(e,{headers:t={},schema:r,fetch:n,urlLengthLimit:i=8e3}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n,this.urlLengthLimit=i}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},i=r?"HEAD":"GET";let s=!1;const a=(e??"*").split("").map(u=>/\s/.test(u)&&!s?"":(u==='"'&&(s=!s),u)).join(""),{url:o,headers:l}=this.cloneRequestState();return o.searchParams.set("select",a),n&&l.append("Prefer",`count=${n}`),new Ni({method:i,url:o,headers:l,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const i="POST",{url:s,headers:a}=this.cloneRequestState();if(t&&a.append("Prefer",`count=${t}`),r||a.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(o.length>0){const l=[...new Set(o)].map(u=>`"${u}"`);s.searchParams.set("columns",l.join(","))}}return new Ni({method:i,url:s,headers:a,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var s;const a="POST",{url:o,headers:l}=this.cloneRequestState();if(l.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&o.searchParams.set("on_conflict",t),n&&l.append("Prefer",`count=${n}`),i||l.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((c,h)=>c.concat(Object.keys(h)),[]);if(u.length>0){const c=[...new Set(u)].map(h=>`"${h}"`);o.searchParams.set("columns",c.join(","))}}return new Ni({method:a,url:o,headers:l,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch,urlLengthLimit:this.urlLengthLimit})}update(e,{count:t}={}){var r;const n="PATCH",{url:i,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new Ni({method:n,url:i,headers:s,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new Ni({method:r,url:n,headers:i,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch,urlLengthLimit:this.urlLengthLimit})}};function Ta(e){"@babel/helpers - typeof";return Ta=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ta(e)}function gw(e,t){if(Ta(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ta(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xw(e){var t=gw(e,"string");return Ta(t)=="symbol"?t:t+""}function _w(e,t,r){return(t=xw(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yh(Object(r),!0).forEach(function(n){_w(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yh(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var ww=class xm{constructor(t,{headers:r={},schema:n,fetch:i,timeout:s,urlLengthLimit:a=8e3}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.urlLengthLimit=a;const o=i??globalThis.fetch;s!==void 0&&s>0?this.fetch=(l,u)=>{const c=new AbortController,h=setTimeout(()=>c.abort(),s),f=u==null?void 0:u.signal;if(f){if(f.aborted)return clearTimeout(h),o(l,u);const d=()=>{clearTimeout(h),c.abort()};return f.addEventListener("abort",d,{once:!0}),o(l,vo(vo({},u),{},{signal:c.signal})).finally(()=>{clearTimeout(h),f.removeEventListener("abort",d)})}return o(l,vo(vo({},u),{},{signal:c.signal})).finally(()=>clearTimeout(h))}:this.fetch=o}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new vw(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(t){return new xm(this.url,{headers:this.headers,schema:t,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(t,r={},{head:n=!1,get:i=!1,count:s}={}){var a;let o;const l=new URL(`${this.url}/rpc/${t}`);let u;const c=d=>d!==null&&typeof d=="object"&&(!Array.isArray(d)||d.some(c)),h=n&&Object.values(r).some(c);h?(o="POST",u=r):n||i?(o=n?"HEAD":"GET",Object.entries(r).filter(([d,m])=>m!==void 0).map(([d,m])=>[d,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([d,m])=>{l.searchParams.append(d,m)})):(o="POST",u=r);const f=new Headers(this.headers);return h?f.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&f.set("Prefer",`count=${s}`),new Ni({method:o,url:l,headers:f,schema:this.schemaName,body:u,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch,urlLengthLimit:this.urlLengthLimit})}};class yw{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const i=n.node,s=parseInt(i.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Ew="2.95.2",Sw=`realtime-js/${Ew}`,Tw="1.0.0",_m="2.0.0",Jh=_m,Xc=1e4,kw=1e3,Aw=100;var pn;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(pn||(pn={}));var st;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(st||(st={}));var Tr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Tr||(Tr={}));var Yc;(function(e){e.websocket="websocket"})(Yc||(Yc={}));var qn;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(qn||(qn={}));class Cw{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},a=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(t,r,n){var i,s;const a=t.topic,o=(i=t.ref)!==null&&i!==void 0?i:"",l=(s=t.join_ref)!==null&&s!==void 0?s:"",u=t.payload.event,c=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},h=Object.keys(c).length===0?"":JSON.stringify(c);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+a.length+u.length+h.length,d=new ArrayBuffer(this.HEADER_LENGTH+f);let m=new DataView(d),p=0;m.setUint8(p++,this.KINDS.userBroadcastPush),m.setUint8(p++,l.length),m.setUint8(p++,o.length),m.setUint8(p++,a.length),m.setUint8(p++,u.length),m.setUint8(p++,h.length),m.setUint8(p++,r),Array.from(l,x=>m.setUint8(p++,x.charCodeAt(0))),Array.from(o,x=>m.setUint8(p++,x.charCodeAt(0))),Array.from(a,x=>m.setUint8(p++,x.charCodeAt(0))),Array.from(u,x=>m.setUint8(p++,x.charCodeAt(0))),Array.from(h,x=>m.setUint8(p++,x.charCodeAt(0)));var _=new Uint8Array(d.byteLength+n.byteLength);return _.set(new Uint8Array(d),0),_.set(new Uint8Array(n),d.byteLength),_.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,s,a,o,l]=n;return r({join_ref:i,ref:s,topic:a,event:o,payload:l})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,i)}}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),a=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+4;const u=n.decode(t.slice(l,l+i));l=l+i;const c=n.decode(t.slice(l,l+s));l=l+s;const h=n.decode(t.slice(l,l+a));l=l+a;const f=t.slice(l,t.byteLength),d=o===this.JSON_ENCODING?JSON.parse(n.decode(f)):f,m={type:this.BROADCAST_EVENT,event:c,payload:d};return a>0&&(m.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:m}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class wm{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var De;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(De||(De={}));const Qh=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,a)=>(s[a]=Ow(a,e,t,i),s),{}):{}},Ow=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i==null?void 0:i.type,a=r[e];return s&&!n.includes(s)?ym(s,a):Jc(a)},ym=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Pw(t,r)}switch(e){case De.bool:return Rw(t);case De.float4:case De.float8:case De.int2:case De.int4:case De.int8:case De.numeric:case De.oid:return Fw(t);case De.json:case De.jsonb:return Nw(t);case De.timestamp:return Iw(t);case De.abstime:case De.date:case De.daterange:case De.int4range:case De.int8range:case De.money:case De.reltime:case De.text:case De.time:case De.timestamptz:case De.timetz:case De.tsrange:case De.tstzrange:return Jc(t);default:return Jc(t)}},Jc=e=>e,Rw=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Fw=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Nw=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},Pw=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const a=e.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>ym(t,o))}return e},Iw=e=>typeof e=="string"?e.replace(" ","T"):e,Em=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Bu{constructor(t,r,n={},i=Xc){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Zh;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Zh||(Zh={}));class Zs{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Zs.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=Zs.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Zs.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),a=this.transformState(r),o={},l={};return this.map(s,(u,c)=>{a[u]||(l[u]=c)}),this.map(a,(u,c)=>{const h=s[u];if(h){const f=c.map(_=>_.presence_ref),d=h.map(_=>_.presence_ref),m=c.filter(_=>d.indexOf(_.presence_ref)<0),p=h.filter(_=>f.indexOf(_.presence_ref)<0);m.length>0&&(o[u]=m),p.length>0&&(l[u]=p)}else o[u]=c}),this.syncDiff(s,{joins:o,leaves:l},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var u;const c=(u=t[o])!==null&&u!==void 0?u:[];if(t[o]=this.cloneDeep(l),c.length>0){const h=t[o].map(d=>d.presence_ref),f=c.filter(d=>h.indexOf(d.presence_ref)<0);t[o].unshift(...f)}n(o,c,l)}),this.map(a,(o,l)=>{let u=t[o];if(!u)return;const c=l.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),t[o]=u,i(o,u,l),u.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ed;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(ed||(ed={}));var ea;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(ea||(ea={}));var Gr;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Gr||(Gr={}));class Ki{constructor(t,r={config:{}},n){var i,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=st.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Bu(this,Tr.join,this.params,this.timeout),this.rejoinTimer=new wm(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=st.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=st.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Tr.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new Zs(this),this.broadcastEndpointURL=Em(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==st.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,u=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&i!==void 0?i:[],c=!!this.bindings[ea.PRESENCE]&&this.bindings[ea.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,h={},f={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:c}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(d=>t==null?void 0:t(Gr.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(Gr.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var m;if(this.socket._isManualToken()||this.socket.setAuth(),d===void 0){t==null||t(Gr.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,_=(m=p==null?void 0:p.length)!==null&&m!==void 0?m:0,x=[];for(let v=0;v<_;v++){const g=p[v],{filter:{event:T,schema:I,table:L,filter:A}}=g,P=d&&d[v];if(P&&P.event===T&&Ki.isFilterValueEqual(P.schema,I)&&Ki.isFilterValueEqual(P.table,L)&&Ki.isFilterValueEqual(P.filter,A))x.push(Object.assign(Object.assign({},g),{id:P.id}));else{this.unsubscribe(),this.state=st.errored,t==null||t(Gr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(Gr.SUBSCRIBED);return}}).receive("error",d=>{this.state=st.errored,t==null||t(Gr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Gr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===st.joined&&t===ea.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const u=await o.json();l=u.error||u.message||l}catch{}return Promise.reject(new Error(l))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:a}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=st.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Tr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Bu(this,Tr.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=st.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Bu(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Aw){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const a=t.toLocaleLowerCase(),{close:o,error:l,leave:u,join:c}=Tr;if(n&&[o,l,u,c].indexOf(a)>=0&&n!==this._joinRef())return;let f=this._onMessage(a,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(d=>{var m,p,_;return((m=d.filter)===null||m===void 0?void 0:m.event)==="*"||((_=(p=d.filter)===null||p===void 0?void 0:p.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===a}).map(d=>d.callback(f,n)):(s=this.bindings[a])===null||s===void 0||s.filter(d=>{var m,p,_,x,v,g;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in d){const T=d.id,I=(m=d.filter)===null||m===void 0?void 0:m.event;return T&&((p=r.ids)===null||p===void 0?void 0:p.includes(T))&&(I==="*"||(I==null?void 0:I.toLocaleLowerCase())===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const T=(v=(x=d==null?void 0:d.filter)===null||x===void 0?void 0:x.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return T==="*"||T===((g=r==null?void 0:r.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===a}).map(d=>{if(typeof f=="object"&&"ids"in f){const m=f.data,{schema:p,table:_,commit_timestamp:x,type:v,errors:g}=m;f=Object.assign(Object.assign({},{schema:p,table:_,commit_timestamp:x,eventType:v,new:{},old:{},errors:g}),this._getPayloadRecords(m))}d.callback(f,n)})}_isClosed(){return this.state===st.closed}_isJoined(){return this.state===st.joined}_isJoining(){return this.state===st.joining}_isLeaving(){return this.state===st.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Ki.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Tr.close,{},t)}_onError(t){this._on(Tr.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=st.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Qh(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Qh(t.columns,t.old_record)),r}}const Uu=()=>{},go={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Dw=[1e3,2e3,5e3,1e4],Lw=1e4,bw=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Mw{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Xc,this.transport=null,this.heartbeatIntervalMs=go.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Uu,this.ref=0,this.reconnectTimer=null,this.vsn=Jh,this.logger=Uu,this.conn=null,this.sendBuffer=[],this.serializer=new Cw,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Yc.websocket}`,this.httpEndpoint=Em(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=yw.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case pn.connecting:return qn.Connecting;case pn.open:return qn.Open;case pn.closing:return qn.Closing;default:return qn.Closed}}isConnected(){return this.connectionState()===qn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new Ki(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,a=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(kw,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},go.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const u=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",u)}catch(c){this.log("error","error in heartbeat callback",c)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:i,payload:s,ref:a}=r,o=a?`(${a})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${i} ${o}`.trim(),s),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(i,s,a)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===pn.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===pn.open||this.conn.readyState===pn.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(Tr.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([bw],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const s={access_token:r,version:Sw};r&&i.updateJoinPayload(s),i.joinedOnce&&i._isJoined()&&i._push(Tr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new wm(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},go.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,s,a,o,l,u,c,h,f,d;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Xc,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:go.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(a=t==null?void 0:t.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Uu,this.vsn=(l=t==null?void 0:t.vsn)!==null&&l!==void 0?l:Jh,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:m=>Dw[m-1]||Lw,this.vsn){case Tw:this.encode=(c=t==null?void 0:t.encode)!==null&&c!==void 0?c:(m,p)=>p(JSON.stringify(m)),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:(m,p)=>p(JSON.parse(m));break;case _m:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var ka=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Bw(e,t,r){const n=new URL(t,e);if(r)for(const[i,s]of Object.entries(r))s!==void 0&&n.searchParams.set(i,s);return n.toString()}async function Uw(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function jw(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:s,headers:a}){const o=Bw(e.baseUrl,n,i),l=await Uw(e.auth),u=await t(o,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...l,...a},body:s?JSON.stringify(s):void 0}),c=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),f=h&&c?JSON.parse(c):c;if(!u.ok){const d=h?f:void 0,m=d==null?void 0:d.error;throw new ka((m==null?void 0:m.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:m==null?void 0:m.type,icebergCode:m==null?void 0:m.code,details:d})}return{status:u.status,headers:u.headers,data:f}}}}function xo(e){return e.join("")}var $w=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:xo(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${xo(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${xo(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${xo(e.namespace)}`}),!0}catch(t){if(t instanceof ka&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof ka&&r.status===409)return;throw r}}};function Ei(e){return e.join("")}var Ww=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ei(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ei(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ei(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ei(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ei(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ei(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof ka&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof ka&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},zw=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=jw({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new $w(this.client,t),this.tableOps=new Ww(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Xl=class extends Error{constructor(e,t="storage",r,n){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function Yl(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var _o=class extends Xl{constructor(e,t,r,n="storage"){super(e,n,t,r),this.name=n==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Sm=class extends Xl{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const Hw=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Vw=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Qc=e=>{if(Array.isArray(e))return e.map(r=>Qc(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=Qc(n)}),t},Gw=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Aa(e){"@babel/helpers - typeof";return Aa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Aa(e)}function Kw(e,t){if(Aa(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Aa(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qw(e){var t=Kw(e,"string");return Aa(t)=="symbol"?t:t+""}function Xw(e,t,r){return(t=qw(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function td(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function me(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?td(Object(r),!0).forEach(function(n){Xw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):td(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const rd=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},Yw=async(e,t,r,n)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const i=e,s=i.status||500;if(typeof i.json=="function")i.json().then(a=>{const o=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||s+"";t(new _o(rd(a),s,o,n))}).catch(()=>{if(n==="vectors"){const a=s+"";t(new _o(i.statusText||`HTTP ${s} error`,s,a,n))}else{const a=s+"";t(new _o(i.statusText||`HTTP ${s} error`,s,a,n))}});else{const a=s+"";t(new _o(i.statusText||`HTTP ${s} error`,s,a,n))}}else t(new Sm(rd(e),e,n))},Jw=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||e==="HEAD"||!n?me(me({},i),r):(Vw(n)?(i.headers=me({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),me(me({},i),r))};async function Ds(e,t,r,n,i,s,a){return new Promise((o,l)=>{e(r,Jw(t,n,i,s)).then(u=>{if(!u.ok)throw u;if(n!=null&&n.noResolveJson)return u;if(a==="vectors"){const c=u.headers.get("content-type");if(u.headers.get("content-length")==="0"||u.status===204)return{};if(!c||!c.includes("application/json"))return{}}return u.json()}).then(u=>o(u)).catch(u=>Yw(u,l,n,a))})}function Tm(e="storage"){return{get:async(t,r,n,i)=>Ds(t,"GET",r,n,i,void 0,e),post:async(t,r,n,i,s)=>Ds(t,"POST",r,i,s,n,e),put:async(t,r,n,i,s)=>Ds(t,"PUT",r,i,s,n,e),head:async(t,r,n,i)=>Ds(t,"HEAD",r,me(me({},n),{},{noResolveJson:!0}),i,void 0,e),remove:async(t,r,n,i,s)=>Ds(t,"DELETE",r,i,s,n,e)}}const Qw=Tm("storage"),{get:Ca,post:Er,put:Zc,head:Zw,remove:s0}=Qw,er=Tm("vectors");var xs=class{constructor(e,t={},r,n="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=Hw(r),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yl(r))return{data:null,error:r};throw r}}},ey=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Yl(t))return{data:null,error:t};throw t}}};let km;km=Symbol.toStringTag;var ty=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[km]="BlobDownloadBuilder",this.promise=null}asStream(){return new ey(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Yl(t))return{data:null,error:t};throw t}}};const ry={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},nd={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var ny=class extends xs{constructor(e,t={},r,n){super(e,t,n,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,n){var i=this;return i.handleOperation(async()=>{let s;const a=me(me({},nd),n);let o=me(me({},i.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",i.encodeMetadata(l)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.has("cacheControl")||s.append("cacheControl",a.cacheControl),l&&!s.has("metadata")&&s.append("metadata",i.encodeMetadata(l))):(s=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=i.toBase64(i.encodeMetadata(l))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!a.duplex&&(a.duplex="half")),n!=null&&n.headers&&(o=me(me({},o),n.headers));const u=i._removeEmptyFolders(t),c=i._getFinalPath(u),h=await(e=="PUT"?Zc:Er)(i.fetch,`${i.url}/object/${c}`,s,me({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{path:u,id:h.Id,fullPath:h.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var i=this;const s=i._removeEmptyFolders(e),a=i._getFinalPath(s),o=new URL(i.url+`/object/upload/sign/${a}`);return o.searchParams.set("token",t),i.handleOperation(async()=>{let l;const u=me({upsert:nd.upsert},n),c=me(me({},i.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType),{path:s,fullPath:(await Zc(i.fetch,o.toString(),l,{headers:c})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(e);const i=me({},r.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const s=await Er(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(r.url+s.url),o=a.searchParams.get("token");if(!o)throw new Xl("No token returned by API");return{signedUrl:a.toString(),path:e,token:o}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;return n.handleOperation(async()=>await Er(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}))}async copy(e,t,r){var n=this;return n.handleOperation(async()=>({path:(await Er(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,r){var n=this;return n.handleOperation(async()=>{let i=n._getFinalPath(e),s=await Er(n.fetch,`${n.url}/object/sign/${i}`,me({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${s.signedURL}${a}`)}})}async createSignedUrls(e,t,r){var n=this;return n.handleOperation(async()=>{const i=await Er(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i.map(a=>me(me({},a),{},{signedUrl:a.signedURL?encodeURI(`${n.url}${a.signedURL}${s}`):null}))})}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=n?`?${n}`:"",s=this._getFinalPath(e),a=()=>Ca(this.fetch,`${this.url}/${r}/${s}${i}`,{headers:this.headers,noResolveJson:!0});return new ty(a,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>Qc(await Ca(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await Zw(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Yl(n)&&n instanceof Sm){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const s=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});a!==""&&n.push(a);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${o}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await s0(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var n=this;return n.handleOperation(async()=>{const i=me(me(me({},ry),t),{},{prefix:e||""});return await Er(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const n=me({},e);return await Er(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const iy="2.95.2",za={"X-Client-Info":`storage-js/${iy}`};var sy=class extends xs{constructor(e,t={},r,n){const i=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase."));const s=i.href.replace(/\/$/,""),a=me(me({},za),t);super(s,a,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await Ca(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await Ca(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await Er(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await Zc(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await Er(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await s0(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},ay=class extends xs{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=me(me({},za),t);super(n,i,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await Er(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),i=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return await Ca(t.fetch,i,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await s0(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!Gw(e))throw new Xl("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new zw({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(i,s){const a=i[s];return typeof a!="function"?a:async(...o)=>{try{return{data:await a.apply(i,o),error:null}}catch(l){if(n)throw l;return{data:null,error:l}}}}})}},oy=class extends xs{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=me(me({},za),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await er.post(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await er.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await er.post(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await er.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},ly=class extends xs{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=me(me({},za),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await er.post(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await er.post(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await er.post(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await er.post(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await er.post(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},uy=class extends xs{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=me(me({},za),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await er.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await er.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await er.post(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await er.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},cy=class extends uy{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new fy(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},fy=class extends oy{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,me(me({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,me(me({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new hy(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},hy=class extends ly{constructor(e,t,r,n,i){super(e,t,i),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,me(me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,me(me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,me(me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,me(me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,me(me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},dy=class extends sy{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new ny(this.url,this.headers,e,this.fetch)}get vectors(){return new cy(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new ay(this.url+"/iceberg",this.headers,this.fetch)}};const Am="2.95.2",Pi=30*1e3,ef=3,ju=ef*Pi,py="http://localhost:9999",my="supabase.auth.token",vy={"X-Client-Info":`gotrue-js/${Am}`},tf="X-Supabase-Api-Version",Cm={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},gy=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,xy=10*60*1e3;class Oa extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function fe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class _y extends Oa{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function wy(e){return fe(e)&&e.name==="AuthApiError"}class Xn extends Oa{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ln extends Oa{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class qt extends ln{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function $u(e){return fe(e)&&e.name==="AuthSessionMissingError"}class Si extends ln{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class wo extends ln{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class yo extends ln{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function yy(e){return fe(e)&&e.name==="AuthImplicitGrantRedirectError"}class id extends ln{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ey extends ln{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class rf extends ln{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Wu(e){return fe(e)&&e.name==="AuthRetryableFetchError"}class sd extends ln{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class nf extends ln{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const dl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ad=` 	
\r=`.split(""),Sy=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<ad.length;t+=1)e[ad[t].charCodeAt(0)]=-2;for(let t=0;t<dl.length;t+=1)e[dl[t].charCodeAt(0)]=t;return e})();function od(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(dl[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(dl[n]),t.queuedBits-=6}}function Om(e,t,r){const n=Sy[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function ld(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{Ay(a,n,r)};for(let a=0;a<e.length;a+=1)Om(e.charCodeAt(a),i,s);return t.join("")}function Ty(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function ky(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}Ty(n,t)}}function Ay(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function ts(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Om(e.charCodeAt(i),r,n);return new Uint8Array(t)}function Cy(e){const t=[];return ky(e,r=>t.push(r)),new Uint8Array(t)}function ei(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>od(i,r,n)),od(null,r,n),t.join("")}function Oy(e){return Math.round(Date.now()/1e3)+e}function Ry(){return Symbol("auth-callback")}const mt=()=>typeof window<"u"&&typeof document<"u",zn={tested:!1,writable:!1},Rm=()=>{if(!mt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(zn.tested)return zn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),zn.tested=!0,zn.writable=!0}catch{zn.tested=!0,zn.writable=!1}return zn.writable};function Fy(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const Fm=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Ny=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ii=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Hn=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},pt=async(e,t)=>{await e.removeItem(t)};class Jl{constructor(){this.promise=new Jl.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Jl.promiseConstructor=Promise;function Eo(e){const t=e.split(".");if(t.length!==3)throw new nf("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!gy.test(t[n]))throw new nf("JWT not in base64url format");return{header:JSON.parse(ld(t[0])),payload:JSON.parse(ld(t[1])),signature:ts(t[2]),raw:{header:t[0],payload:t[1]}}}async function Py(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Iy(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await e(s);if(!t(s,null,a)){n(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function Dy(e){return("0"+e.toString(16)).substr(-2)}function Ly(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,Dy).join("")}async function by(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function My(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await by(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ti(e,t,r=!1){const n=Ly();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Ii(e,`${t}-code-verifier`,i);const s=await My(n);return[s,n===s?"plain":"s256"]}const By=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Uy(e){const t=e.headers.get(tf);if(!t||!t.match(By))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function jy(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function $y(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Wy=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ki(e){if(!Wy.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function zu(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function zy(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function ud(e){return JSON.parse(JSON.stringify(e))}const Kn=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Hy=[502,503,504];async function cd(e){var t;if(!Ny(e))throw new rf(Kn(e),0);if(Hy.includes(e.status))throw new rf(Kn(e),e.status);let r;try{r=await e.json()}catch(s){throw new Xn(Kn(s),s)}let n;const i=Uy(e);if(i&&i.getTime()>=Cm["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new sd(Kn(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new qt}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new sd(Kn(r),e.status,r.weak_password.reasons);throw new _y(Kn(r),e.status||500,n)}const Vy=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function pe(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[tf]||(s[tf]=Cm["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Gy(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function Gy(e,t,r,n,i,s){const a=Vy(t,n,i,s);let o;try{o=await e(r,Object.assign({},a))}catch(l){throw console.error(l),new rf(Kn(l),0)}if(o.ok||await cd(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await cd(l)}}function wr(e){var t;let r=null;Xy(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Oy(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function fd(e){const t=wr(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function gn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Ky(e){return{data:e,error:null}}function qy(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,a=ql(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function hd(e){return e}function Xy(e){return e.access_token&&e.refresh_token&&e.expires_in}const Hu=["global","local","others"];class Yy{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Fm(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Hu[0]){if(Hu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Hu.join(", ")}`);try{return await pe(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(fe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await pe(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:gn})}catch(n){if(fe(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=ql(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await pe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:qy,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(fe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await pe(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:gn})}catch(r){if(fe(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},c=await pe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:hd});if(c.error)throw c.error;const h=await c.json(),f=(a=c.headers.get("x-total-count"))!==null&&a!==void 0?a:0,d=(l=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(m=>{const p=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(m.split(";")[1].split("=")[1]);u[`${_}Page`]=p}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(fe(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){ki(t);try{return await pe(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:gn})}catch(r){if(fe(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){ki(t);try{return await pe(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:gn})}catch(n){if(fe(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){ki(t);try{return await pe(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:gn})}catch(n){if(fe(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){ki(t.userId);try{const{data:r,error:n}=await pe(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(fe(r))return{data:null,error:r};throw r}}async _deleteFactor(t){ki(t.userId),ki(t.id);try{return{data:await pe(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(fe(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,s,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},c=await pe(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:hd});if(c.error)throw c.error;const h=await c.json(),f=(a=c.headers.get("x-total-count"))!==null&&a!==void 0?a:0,d=(l=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(m=>{const p=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(m.split(";")[1].split("=")[1]);u[`${_}Page`]=p}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(fe(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await pe(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(fe(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await pe(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(fe(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await pe(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(fe(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await pe(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(fe(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await pe(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(fe(r))return{data:null,error:r};throw r}}}function dd(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Ai={debug:!!(globalThis&&Rm()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Nm extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Jy extends Nm{}async function Qy(e,t,r){Ai.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Ai.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Ai.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{Ai.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw Ai.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Jy(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ai.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Zy(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Pm(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function e2(e){return parseInt(e,16)}function t2(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function r2(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:a,notBefore:o,requestId:l,resources:u,scheme:c,uri:h,version:f}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const d=Pm(e.address),m=c?`${c}://${n}`:n,p=e.statement?`${e.statement}
`:"",_=`${m} wants you to sign in with your Ethereum account:
${d}

${p}`;let x=`URI: ${h}
Version: ${f}
Chain ID: ${r}${a?`
Nonce: ${a}`:""}
Issued At: ${s.toISOString()}`;if(i&&(x+=`
Expiration Time: ${i.toISOString()}`),o&&(x+=`
Not Before: ${o.toISOString()}`),l&&(x+=`
Request ID: ${l}`),u){let v=`
Resources:`;for(const g of u){if(!g||typeof g!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${g}`);v+=`
- ${g}`}x+=v}return`${_}
${x}`}class tt extends Error{constructor({message:t,code:r,cause:n,name:i}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class pl extends tt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function n2({error:e,options:t}){var r,n,i;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new tt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new tt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new tt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new tt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new tt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new tt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new tt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new tt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(Im(a)){if(s.rp.id!==a)return new tt({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new tt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new tt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new tt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new tt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function i2({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new tt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new tt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(Im(n)){if(r.rpId!==n)return new tt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new tt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new tt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new tt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class s2{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const a2=new s2;function o2(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=ql(e,["challenge","user","excludeCredentials"]),s=ts(t).buffer,a=Object.assign(Object.assign({},r),{id:ts(r.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:s,user:a});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const u=n[l];o.excludeCredentials[l]=Object.assign(Object.assign({},u),{id:ts(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function l2(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=ql(e,["challenge","allowCredentials"]),i=ts(t).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let a=0;a<r.length;a++){const o=r[a];s.allowCredentials[a]=Object.assign(Object.assign({},o),{id:ts(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function u2(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:ei(new Uint8Array(e.response.attestationObject)),clientDataJSON:ei(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function c2(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ei(new Uint8Array(i.authenticatorData)),clientDataJSON:ei(new Uint8Array(i.clientDataJSON)),signature:ei(new Uint8Array(i.signature)),userHandle:i.userHandle?ei(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Im(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function pd(){var e,t;return!!(mt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function f2(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new pl("Browser returned unexpected credential type",t)}:{data:null,error:new pl("Empty credential response",t)}}catch(t){return{data:null,error:n2({error:t,options:e})}}}async function h2(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new pl("Browser returned unexpected credential type",t)}:{data:null,error:new pl("Empty credential response",t)}}catch(t){return{data:null,error:i2({error:t,options:e})}}}const d2={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},p2={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ml(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const s in i){const a=i[s];if(a!==void 0)if(Array.isArray(a))n[s]=a;else if(r(a))n[s]=a;else if(t(a)){const o=n[s];t(o)?n[s]=ml(o,a):n[s]=ml(a)}else n[s]=a}return n}function m2(e,t){return ml(d2,e,t||{})}function v2(e,t){return ml(p2,e,t||{})}class g2{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},s){var a;try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:l};const u=i??a2.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:c}=o.webauthn.credential_options.publicKey;if(!c.name){const h=n;if(h)c.name=`${c.id}:${h}`;else{const d=(await this.client.getUser()).data.user,m=((a=d==null?void 0:d.user_metadata)===null||a===void 0?void 0:a.name)||(d==null?void 0:d.email)||(d==null?void 0:d.id)||"User";c.name=`${c.id}:${m}`}}c.displayName||(c.displayName=c.name)}switch(o.webauthn.type){case"create":{const c=m2(o.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:h,error:f}=await f2({publicKey:c,signal:u});return h?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:h}},error:null}:{data:null,error:f}}case"request":{const c=v2(o.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:h,error:f}=await h2(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:c,signal:u}));return h?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:h}},error:null}:{data:null,error:f}}}}catch(o){return fe(o)?{data:null,error:o}:{data:null,error:new Xn("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new Oa("rpId is required for WebAuthn authentication")};try{if(!pd())return{data:null,error:new Xn("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!a)return{data:null,error:o};const{webauthn:l}=a;return this._verify({factorId:t,challengeId:a.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(a){return fe(a)?{data:null,error:a}:{data:null,error:new Xn("Unexpected error in authenticate",a)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new Oa("rpId is required for WebAuthn registration")};try{if(!pd())return{data:null,error:new Xn("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:t});if(!a)return await this.client.mfa.listFactors().then(c=>{var h;return(h=c.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===t&&f.status!=="unverified")}).then(c=>c?this.client.mfa.unenroll({factorId:c==null?void 0:c.id}):void 0),{data:null,error:o};const{data:l,error:u}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:u}}catch(a){return fe(a)?{data:null,error:a}:{data:null,error:new Xn("Unexpected error in register",a)}}}}Zy();const x2={url:py,storageKey:my,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:vy,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function md(e,t,r){return await r()}const Ci={};class Ra{get jwks(){var t,r;return(r=(t=Ci[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Ci[this.storageKey]=Object.assign(Object.assign({},Ci[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Ci[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Ci[this.storageKey]=Object.assign(Object.assign({},Ci[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},x2),t);if(this.storageKey=s.storageKey,this.instanceID=(r=Ra.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Ra.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&mt()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Yy({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Fm(s.fetch),this.lock=s.lock||md,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,this.lockAcquireTimeout=s.lockAcquireTimeout,s.lock?this.lock=s.lock:this.persistSession&&mt()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Qy:this.lock=md,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new g2(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:Rm()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=dd(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=dd(this.memoryStorage)),mt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a);try{await this._notifyAllSubscribers(a.data.event,a.data.session,!1)}catch(o){this._debug("#broadcastChannel","error",o)}})}this.initialize().catch(a=>{this._debug("#initialize()","error",a)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Am}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(mt()&&(r=Fy(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),mt()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),yy(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return fe(r)?this._returnResult({error:r}):this._returnResult({error:new Xn("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:wr}),{data:a,error:o}=s;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(s){if(fe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:c,password:h,options:f}=t;let d=null,m=null;this.flowType==="pkce"&&([d,m]=await Ti(this.storage,this.storageKey)),s=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:c,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:d,code_challenge_method:m},xform:wr})}else if("phone"in t){const{phone:c,password:h,options:f}=t;s=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:wr})}else throw new wo("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return await pt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(s){if(await pt(this.storage,`${this.storageKey}-code-verifier`),fe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:a,options:o}=t;r=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:fd})}else if("phone"in t){const{phone:s,password:a,options:o}=t;r=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:fd})}else throw new wo("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new Si;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(fe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,s,a,o,l,u,c,h,f;let d,m;if("message"in t)d=t.message,m=t.signature;else{const{chain:p,wallet:_,statement:x,options:v}=t;let g;if(mt())if(typeof _=="object")g=_;else{const N=window;if("ethereum"in N&&typeof N.ethereum=="object"&&"request"in N.ethereum&&typeof N.ethereum.request=="function")g=N.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=_}const T=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href),I=await g.request({method:"eth_requestAccounts"}).then(N=>N).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!I||I.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const L=Pm(I[0]);let A=(n=v==null?void 0:v.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!A){const N=await g.request({method:"eth_chainId"});A=e2(N)}const P={domain:T.host,address:L,statement:x,uri:T.href,version:"1",chainId:A,nonce:(i=v==null?void 0:v.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(a=(s=v==null?void 0:v.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=v==null?void 0:v.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=v==null?void 0:v.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(u=v==null?void 0:v.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(c=v==null?void 0:v.signInWithEthereum)===null||c===void 0?void 0:c.resources};d=r2(P),m=await g.request({method:"personal_sign",params:[t2(d),L]})}try{const{data:p,error:_}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:d,signature:m},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:wr});if(_)throw _;if(!p||!p.session||!p.user){const x=new Si;return this._returnResult({data:{user:null,session:null},error:x})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:Object.assign({},p),error:_})}catch(p){if(fe(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSolana(t){var r,n,i,s,a,o,l,u,c,h,f,d;let m,p;if("message"in t)m=t.message,p=t.signature;else{const{chain:_,wallet:x,statement:v,options:g}=t;let T;if(mt())if(typeof x=="object")T=x;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))T=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=x}const I=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in T&&T.signIn){const L=await T.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:I.host,uri:I.href}),v?{statement:v}:null));let A;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")A=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)A=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)m=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),p=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in T)||typeof T.signMessage!="function"||!("publicKey"in T)||typeof T!="object"||!T.publicKey||!("toBase58"in T.publicKey)||typeof T.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${I.host} wants you to sign in with your Solana account:`,T.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${I.href}`,`Issued At: ${(i=(n=g==null?void 0:g.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=g==null?void 0:g.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((a=g==null?void 0:g.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((o=g==null?void 0:g.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((u=g==null?void 0:g.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((h=(c=g==null?void 0:g.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||h===void 0)&&h.length?["Resources",...g.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const L=await T.signMessage(new TextEncoder().encode(m),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=L}}try{const{data:_,error:x}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:ei(p)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(d=t.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:wr});if(x)throw x;if(!_||!_.session||!_.user){const v=new Si;return this._returnResult({data:{user:null,session:null},error:v})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:x})}catch(_){if(fe(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async _exchangeCodeForSession(t){const r=await Hn(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new Ey;const{data:s,error:a}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:wr});if(await pt(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!s||!s.session||!s.user){const o=new Si;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(await pt(this.storage,`${this.storageKey}-code-verifier`),fe(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=t,o=await pe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:wr}),{data:l,error:u}=o;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const c=new Si;return this._returnResult({data:{user:null,session:null},error:c})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:u})}catch(r){if(fe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,s,a;try{if("email"in t){const{email:o,options:l}=t;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await Ti(this.storage,this.storageKey));const{error:h}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in t){const{phone:o,options:l}=t,{data:u,error:c}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c})}throw new wo("You must provide either an email or phone number.")}catch(o){if(await pt(this.storage,`${this.storageKey}-code-verifier`),fe(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await pe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:wr});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,u=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(fe(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,s,a;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await Ti(this.storage,this.storageKey));const u=await pe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:Ky});return!((s=u.data)===null||s===void 0)&&s.url&&mt()&&!(!((a=t.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(o){if(await pt(this.storage,`${this.storageKey}-code-verifier`),fe(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new qt;const{error:i}=await pe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(fe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:a}=await pe(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:a,error:o}=await pe(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o})}throw new wo("You must provide either an email or phone number and a type")}catch(r){if(fe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Hn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<ju:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const a=await Hn(this.userStorage,this.storageKey+"-user");a!=null&&a.user?t.user=a.user:t.user=zu()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};t.user=zy(t.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:gn}):await this._useSession(async r=>{var n,i,s;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new qt}:await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:gn})})}catch(r){if(fe(r))return $u(r)&&(await this._removeSession(),await pt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new qt;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Ti(this.storage,this.storageKey));const{data:u,error:c}=await pe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:gn});if(c)throw c;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(n){if(await pt(this.storage,`${this.storageKey}-code-verifier`),fe(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new qt;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=Eo(t.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(fe(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:o}=r;if(o)throw o;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new qt;const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(fe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!mt())throw new yo("No browser detected.");if(t.error||t.error_description||t.error_code)throw new yo(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new id("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new yo("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new id("No code detected.");const{data:v,error:g}=await this._exchangeCodeForSession(t.code);if(g)throw g;const T=new URL(window.location.href);return T.searchParams.delete("code"),window.history.replaceState(window.history.state,"",T.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:u}=t;if(!s||!o||!a||!u)throw new yo("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(o);let f=c+h;l&&(f=parseInt(l));const d=f-c;d*1e3<=Pi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${h}s`);const m=f-h;c-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,f,c):c-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,f,c);const{data:p,error:_}=await this._getUser(s);if(_)throw _;const x={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:h,expires_at:f,refresh_token:a,token_type:u,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:t.type},error:null})}catch(n){if(fe(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Hn(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s&&!$u(s))return this._returnResult({error:s});const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,t);if(o&&!(wy(o)&&(o.status===404||o.status===401||o.status===403)||$u(o)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await pt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=Ry(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Ti(this.storage,this.storageKey,!0));try{return await pe(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(await pt(this.storage,`${this.storageKey}-code-verifier`),fe(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,o,l,u,c;const{data:h,error:f}=s;if(f)throw f;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await pe(this.fetch,"GET",d,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(i)throw i;return mt()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(fe(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:a,provider:o,token:l,access_token:u,nonce:c}=t,h=await pe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:l,access_token:u,nonce:c,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:wr}),{data:f,error:d}=h;return d?this._returnResult({data:{user:null,session:null},error:d}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Si}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:d}))}catch(i){if(await pt(this.storage,`${this.storageKey}-code-verifier`),fe(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await pe(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Iy(async i=>(i>0&&await Py(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await pe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:wr})),(i,s)=>{const a=200*Math.pow(2,i);return s&&Wu(s)&&Date.now()+a-n<Pi})}catch(n){if(this._debug(r,"error",n),fe(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),mt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await Hn(this.storage,this.storageKey);if(i&&this.userStorage){let a=await Hn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await Ii(this.userStorage,this.storageKey+"-user",a)),i.user=(t=a==null?void 0:a.user)!==null&&t!==void 0?t:zu()}else if(i&&!i.user&&!i.user){const a=await Hn(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(i.user=a.user,await pt(this.storage,this.storageKey+"-user"),await Ii(this.storage,this.storageKey,i)):i.user=zu()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<ju;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${ju}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),Wu(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(i.access_token);!o&&(a!=null&&a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new qt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Jl;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new qt;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),fe(s)){const a={data:null,error:s};return Wu(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await pt(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Ii(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=ud(i);await Ii(this.storage,this.storageKey,s)}else{const i=ud(r);await Ii(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await pt(this.storage,this.storageKey),await pt(this.storage,this.storageKey+"-code-verifier"),await pt(this.storage,this.storageKey+"-user"),this.userStorage&&await pt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&mt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Pi);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Pi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Pi}ms, refresh threshold is ${ef} ticks`),i<=ef&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Nm)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!mt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await Ti(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await pe(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:l,error:u}=await pe(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&l.type==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?u2(t.webauthn.credential_response):c2(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:l}=await pe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:a,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=await pe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:o2(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:l2(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(t){var r,n,i,s;if(t)try{const{payload:d}=Eo(t);let m=null;d.aal&&(m=d.aal);let p=m;const{data:{user:_},error:x}=await this.getUser(t);if(x)return this._returnResult({data:null,error:x});((n=(r=_==null?void 0:_.factors)===null||r===void 0?void 0:r.filter(T=>T.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(p="aal2");const g=d.amr||[];return{data:{currentLevel:m,nextLevel:p,currentAuthenticationMethods:g},error:null}}catch(d){if(fe(d))return this._returnResult({data:null,error:d});throw d}const{data:{session:a},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Eo(a.access_token);let u=null;l.aal&&(u=l.aal);let c=u;((s=(i=a.user.factors)===null||i===void 0?void 0:i.filter(d=>d.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const f=l.amr||[];return{data:{currentLevel:u,nextLevel:c,currentAuthenticationMethods:f},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await pe(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new qt})})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new qt});const a=await pe(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&mt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(fe(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new qt});const a=await pe(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&mt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(fe(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await pe(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new qt})})}catch(t){if(fe(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await pe(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new qt})})}catch(r){if(fe(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+xy>i)return n;const{data:s,error:a}=await pe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:d,error:m}=await this.getSession();if(m||!d.session)return this._returnResult({data:null,error:m});n=d.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=Eo(n);r!=null&&r.allowExpired||jy(s.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:d}=await this.getUser(n);if(d)throw d;return{data:{claims:s,header:i,signature:a},error:null}}const c=$y(i.alg),h=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,a,Cy(`${o}.${l}`)))throw new nf("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(fe(n))return this._returnResult({data:null,error:n});throw n}}}Ra.nextInstanceID={};const _2=Ra,w2="2.95.2";let $s="";typeof Deno<"u"?$s="deno":typeof document<"u"?$s="web":typeof navigator<"u"&&navigator.product==="ReactNative"?$s="react-native":$s="node";const y2={"X-Client-Info":`supabase-js-${$s}/${w2}`},E2={headers:y2},S2={schema:"public"},T2={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},k2={};function Fa(e){"@babel/helpers - typeof";return Fa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fa(e)}function A2(e,t){if(Fa(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Fa(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C2(e){var t=A2(e,"string");return Fa(t)=="symbol"?t:t+""}function O2(e,t,r){return(t=C2(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function qe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vd(Object(r),!0).forEach(function(n){O2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vd(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const R2=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),F2=()=>Headers,N2=(e,t,r)=>{const n=R2(r),i=F2();return async(s,a)=>{var o;const l=(o=await t())!==null&&o!==void 0?o:e;let u=new i(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(s,qe(qe({},a),{},{headers:u}))}};function P2(e){return e.endsWith("/")?e:e+"/"}function I2(e,t){var r,n;const{db:i,auth:s,realtime:a,global:o}=e,{db:l,auth:u,realtime:c,global:h}=t,f={db:qe(qe({},l),i),auth:qe(qe({},u),s),realtime:qe(qe({},c),a),storage:{},global:qe(qe(qe({},h),o),{},{headers:qe(qe({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}function D2(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(P2(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var L2=class extends _2{constructor(e){super(e)}},b2=class{constructor(e,t,r){var n,i;this.supabaseUrl=e,this.supabaseKey=t;const s=D2(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const a=`sb-${s.hostname.split(".")[0]}-auth-token`,o={db:S2,realtime:k2,auth:qe(qe({},T2),{},{storageKey:a}),global:E2},l=I2(r??{},o);if(this.storageKey=(n=l.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=l.global.headers)!==null&&i!==void 0?i:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(c,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=l.auth)!==null&&u!==void 0?u:{},this.headers,l.global.fetch)}this.fetch=N2(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(qe({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(c=>this.realtime.setAuth(c)).catch(c=>console.warn("Failed to set initial Realtime auth token:",c)),this.rest=new ww(new URL("rest/v1",s).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch,timeout:l.db.timeout,urlLengthLimit:l.db.urlLengthLimit}),this.storage=new dy(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new hw(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,storageKey:s,flowType:a,lock:o,debug:l,throwOnError:u},c,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new L2({url:this.authUrl.href,headers:qe(qe({},f),c),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,flowType:a,lock:o,debug:l,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(d=>d.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Mw(this.realtimeUrl.href,qe(qe({},e),{},{params:qe(qe({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const M2=(e,t,r)=>new b2(e,t,r);function B2(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}B2()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const U2={},Dm=U2||{},gd=Dm.VITE_SUPABASE_URL||"",xd=Dm.VITE_SUPABASE_ANON_KEY||"";let sf;if(!gd||!xd){console.warn(" Supabase URLs are missing. Running in disconnected mode.");const e=t=>Promise.resolve({data:null,error:{message:`MISSING API KEYS: ${t}`}});sf={from:t=>({select:()=>({eq:()=>({single:()=>e(`Cannot select from ${t}`),order:()=>e(`Cannot select from ${t}`)}),order:()=>e(`Cannot list ${t}`),insert:()=>e(`Cannot insert into ${t}`)}),insert:r=>({select:()=>({single:()=>e(`Cannot insert/select from ${t}`)}),then:n=>n({data:null,error:{message:"MISSING API KEYS"}})})})}}else sf=M2(gd,xd);const ds=sf,vl=[],j2=async(e,t)=>{try{const{data:r,error:n}=await ds.from("users").select("*").eq("username",e).eq("password",t).single();return n||!r?null:{id:r.id,name:r.name,surname:r.surname,username:r.username,role:r.role,eventId:r.event_id}}catch(r){return console.error("Login error:",r),null}},$2=async e=>{try{const{data:t}=await ds.from("users").select("id").eq("username",e.username).single();if(t)throw new Error("Username already taken");const{data:r,error:n}=await ds.from("users").insert([{username:e.username,password:e.password,name:e.name,surname:e.surname,role:e.role,event_id:e.eventId}]).select().single();if(n)throw n;return{id:r.id,name:r.name,surname:r.surname,username:r.username,role:r.role,eventId:r.event_id}}catch(t){throw console.error("Registration error:",t),t}},W2=async()=>{const{data:e,error:t}=await ds.from("responses").select("*").order("timestamp",{ascending:!1});if(t)return console.warn("Supabase load error:",t.message),vl;const r=e.map(n=>({id:n.id,userId:n.user_id,eventId:n.event_id,username:n.username,answers:n.answers,timestamp:n.timestamp}));return[...vl,...r]},_d=async e=>{if(e==="demo_user_preview")return vl.filter(n=>n.userId===e).length;const{count:t,error:r}=await ds.from("responses").select("*",{count:"exact",head:!0}).eq("user_id",e);return r?(console.error("Error counting user responses",r),0):t||0},z2=async e=>{if(e.userId==="demo_user_preview")return console.log("Saving demo response to local memory:",e),vl.push(e),Promise.resolve();console.log("Attempting to save to Supabase:",e);const{data:t,error:r}=await ds.from("responses").insert([{id:e.id,user_id:e.userId,event_id:e.eventId,username:e.username,answers:e.answers,timestamp:e.timestamp}]).select();if(r)throw console.error("Supabase CRITICAL Save Error:",r),new Error(r.message);console.log("Supabase Save Success:",t)},H2=async()=>{},wn=({children:e,variant:t="primary",isLoading:r,className:n="",disabled:i,...s})=>{const a="px-4 py-2 rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",o={primary:"bg-[#F26627] text-white hover:bg-[#d9561b] focus:ring-[#F9A26C] shadow-md hover:shadow-lg",secondary:"bg-white text-[#325D79] hover:bg-[#EFEEEE] border border-[#325D79] focus:ring-[#325D79]",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",outline:"bg-transparent border-2 border-[#F26627] text-[#F26627] hover:bg-[#fff5f0] focus:ring-[#F26627]"};return D.jsxs("button",{className:`${a} ${o[t]} ${n} flex items-center justify-center`,disabled:r||i,...s,children:[r&&D.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[D.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),D.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e]})},Ls=({label:e,error:t,className:r="",id:n,...i})=>{const s=n||e.toLowerCase().replace(/\s+/g,"-");return D.jsxs("div",{className:`flex flex-col gap-1.5 ${r}`,children:[D.jsx("label",{htmlFor:s,className:"text-sm font-medium text-[#325D79]",children:e}),D.jsx("input",{id:s,className:`px-3 py-2 bg-white border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F9A26C] focus:border-[#F26627] transition-colors
          ${t?"border-red-500 focus:ring-red-200":"border-[#9BD7D1] text-[#325D79]"}
        `,...i}),t&&D.jsx("span",{className:"text-xs text-red-500",children:t})]})},Ql=({className:e="",variant:t="dark"})=>{const r=t==="light"?"/logo-dark.png":"/logo-light.png";return D.jsx("img",{src:r,alt:"SUMMEET Logo",className:`h-12 w-auto object-contain ${e}`})};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var V2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Pr=(e,t)=>{const r=Le.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...u},c)=>Le.createElement("svg",{ref:c,...V2,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${G2(e)}`,o].join(" "),...u},[...t.map(([h,f])=>Le.createElement(h,f)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K2=Pr("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lm=Pr("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bm=Pr("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=Pr("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=Pr("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=Pr("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mm=Pr("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J2=Pr("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=Pr("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=Pr("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eE=Pr("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),tE=({onLogin:e})=>{const[t,r]=Le.useState(!0),[n,i]=Le.useState(!1),[s,a]=Le.useState(""),[o,l]=Le.useState(""),[u,c]=Le.useState(""),[h,f]=Le.useState(""),[d,m]=Le.useState(""),[p,_]=Le.useState(""),[x,v]=Le.useState(""),g=async A=>{A.preventDefault(),c(""),i(!0);try{const P=await j2(s,o);P?e(P):c("Credenziali non valide. Riprova.")}catch{c("Errore di connessione. Verifica la configurazione Supabase.")}finally{i(!1)}},T=async A=>{if(A.preventDefault(),c(""),!p){c("Seleziona un evento.");return}const P=(h+d).toLowerCase().replace(/\s/g,"");if(P===Gh.username){c("Questo nome utente  riservato.");return}i(!0);try{const N=await $2({name:h,surname:d,username:P,password:x,role:Qs.USER,eventId:p});N&&e(N)}catch(N){N.message&&(N.message.includes("unique")||N.message.includes("taken"))?c("Utente gi registrato con questo nome e cognome."):c("Errore durante la registrazione. Verifica Supabase.")}finally{i(!1)}},I=()=>{var A;e({id:"demo_user_preview",name:"Utente",surname:"Demo",username:"demouser",role:Qs.USER,eventId:((A=ui[0])==null?void 0:A.id)||"ev_001"})},L=()=>{e({id:"demo_admin_preview",name:"Admin",surname:"Demo",username:Gh.username,role:Qs.ADMIN})};return D.jsxs("div",{className:"min-h-screen bg-[#EFEEEE] flex items-center justify-center p-4",children:[D.jsx("div",{className:"absolute top-0 left-0 w-full h-1/2 bg-[#325D79] z-0"}),D.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-2xl overflow-hidden flex flex-col z-10",children:[D.jsxs("div",{className:"bg-white pt-10 pb-6 text-center border-b border-[#EFEEEE]",children:[D.jsx(Ql,{className:"scale-75 transform mx-auto block"}),D.jsx("p",{className:"text-[#325D79] mt-2 text-sm font-medium tracking-wide",children:"SURVEY PLATFORM"})]}),D.jsxs("div",{className:"p-8",children:[D.jsxs("div",{className:"flex gap-4 mb-8 p-1.5 bg-[#EFEEEE] rounded-lg",children:[D.jsx("button",{onClick:()=>{r(!0),c("")},className:`flex-1 py-2 text-sm font-medium rounded-md transition-all ${t?"bg-white text-[#325D79] shadow-sm":"text-slate-500 hover:text-[#325D79]"}`,children:"Accedi"}),D.jsx("button",{onClick:()=>{r(!1),c("")},className:`flex-1 py-2 text-sm font-medium rounded-md transition-all ${t?"text-slate-500 hover:text-[#325D79]":"bg-white text-[#325D79] shadow-sm"}`,children:"Registrati"})]}),u&&D.jsx("div",{className:"mb-6 p-3 bg-red-50 border border-red-200 text-red-700 text-sm rounded-lg",children:u}),t?D.jsxs("form",{onSubmit:g,className:"space-y-5",children:[D.jsx(Ls,{label:"Nome Utente",type:"text",placeholder:"es. mariorossi",value:s,onChange:A=>a(A.target.value),required:!0}),D.jsx(Ls,{label:"Password",type:"password",placeholder:"",value:o,onChange:A=>l(A.target.value),required:!0}),D.jsx(wn,{type:"submit",isLoading:n,className:"w-full",children:"Accedi"})]}):D.jsxs("form",{onSubmit:T,className:"space-y-5",children:[D.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[D.jsx(Ls,{label:"Nome",type:"text",placeholder:"Mario",value:h,onChange:A=>f(A.target.value),required:!0}),D.jsx(Ls,{label:"Cognome",type:"text",placeholder:"Rossi",value:d,onChange:A=>m(A.target.value),required:!0})]}),D.jsxs("div",{className:"flex flex-col gap-1.5",children:[D.jsx("label",{className:"text-sm font-medium text-[#325D79]",children:"Seleziona Evento"}),D.jsxs("select",{className:"px-3 py-2 bg-white border border-[#9BD7D1] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F9A26C] text-[#325D79]",value:p,onChange:A=>_(A.target.value),required:!0,children:[D.jsx("option",{value:"",children:"-- Scegli evento --"}),ui.map(A=>D.jsxs("option",{value:A.id,children:[A.name," (",A.date,")"]},A.id))]})]}),D.jsx(Ls,{label:"Password",type:"password",placeholder:"Crea una password",value:x,onChange:A=>v(A.target.value),required:!0}),D.jsxs("div",{className:"text-xs text-slate-500 bg-[#EFEEEE] p-2 rounded border border-[#9BD7D1]/30",children:["Il tuo nome utente sar: ",D.jsx("strong",{children:(h+d).toLowerCase()||"..."})]}),D.jsx(wn,{type:"submit",isLoading:n,className:"w-full",children:"Crea Account"})]}),D.jsxs("div",{className:"mt-8 pt-6 border-t border-[#EFEEEE]",children:[D.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[D.jsxs(wn,{type:"button",variant:"secondary",onClick:I,className:"w-full text-xs",children:[D.jsx(X2,{className:"w-3 h-3 mr-2"}),"User Demo"]}),D.jsxs(wn,{type:"button",variant:"secondary",onClick:L,className:"w-full text-xs",children:[D.jsx(Q2,{className:"w-3 h-3 mr-2"}),"Admin Demo"]})]}),D.jsx("p",{className:"text-center text-xs text-slate-400 mt-3",children:"Accesso rapido per testare le funzionalit"})]})]})]})]})},rE=({user:e,onBack:t})=>{const[r,n]=Le.useState({}),[i,s]=Le.useState(!1),a=ui.find(u=>u.id===e.eventId),o=(u,c)=>{n(h=>({...h,[u]:c}))},l=async u=>{u.preventDefault(),s(!0);const h={id:"paz_"+Math.random().toString(36).substr(2,9),userId:e.id,eventId:e.eventId,username:e.username,answers:r,timestamp:new Date().toISOString()};try{await z2(h),alert("Scheda salvata correttamente!"),t()}catch(f){console.error("Submission error details:",f),alert(`Errore durante il salvataggio: ${f.message||"Errore sconosciuto"}. Controlla la console.`)}finally{s(!1)}};return D.jsxs("div",{className:"min-h-screen bg-[#EFEEEE]",children:[D.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10 border-b border-[#9BD7D1]/30",children:D.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-3 flex justify-between items-center",children:[D.jsx("div",{className:"scale-50 origin-left -ml-4",children:D.jsx(Ql,{})}),D.jsxs("div",{className:"flex items-center gap-4",children:[D.jsxs("span",{className:"text-sm text-slate-500 hidden sm:block",children:["Op: ",e.username]}),D.jsxs("button",{onClick:t,className:"flex items-center text-sm font-medium text-slate-500 hover:text-[#F26627] transition-colors",children:[D.jsx(K2,{className:"w-4 h-4 mr-1"}),"Dashboard"]})]})]})}),D.jsx("main",{className:"max-w-4xl mx-auto px-4 py-8",children:D.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden border border-[#9BD7D1]/30",children:[D.jsx("div",{className:"bg-[#325D79] px-6 py-6 text-white",children:D.jsxs("div",{className:"flex justify-between items-start",children:[D.jsxs("div",{children:[D.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-white",children:[D.jsx(bm,{className:"w-5 h-5 text-[#9BD7D1]"}),"Parte da compilare a cura del cittadino"]}),D.jsx("p",{className:"mt-2 text-[#9BD7D1] text-sm",children:"Compilare tutti i campi relativi allo stato di salute e stile di vita."})]}),D.jsx("div",{className:"text-right text-xs bg-[#24465F] px-3 py-1 rounded-full text-[#F9A26C]",children:a==null?void 0:a.name})]})}),D.jsxs("form",{onSubmit:l,className:"p-6 md:p-8 space-y-8",children:[Kc.map(u=>{var c;return D.jsxs("div",{className:"space-y-3 pb-6 border-b border-slate-100 last:border-0",children:[D.jsx("label",{className:"block text-base font-semibold text-[#325D79]",children:u.text}),u.type==="text"?D.jsx("input",{type:u.id==="eta"?"number":"text",required:!0,className:"w-full sm:w-1/3 p-3 border border-[#9BD7D1] rounded-lg focus:ring-2 focus:ring-[#F9A26C] focus:border-[#F26627] outline-none font-medium text-lg bg-[#EFEEEE]",placeholder:"_____",value:r[u.id]||"",onChange:h=>o(u.id,h.target.value)}):D.jsxs("div",{className:"flex flex-wrap gap-3",children:[(c=u.options)==null?void 0:c.map(h=>{const f=r[u.id]===h;return D.jsx("button",{type:"button",onClick:()=>o(u.id,h),className:`
                            px-6 py-2.5 rounded-lg border text-sm font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-[#F9A26C]
                            ${f?"bg-[#F26627] border-[#F26627] text-white shadow-md transform scale-105":"bg-white border-[#9BD7D1] text-[#325D79] hover:bg-[#EFEEEE] hover:border-[#F9A26C]"}
                          `,children:h},h)}),D.jsx("input",{type:"text",className:"sr-only",required:!0,value:r[u.id]||"",onChange:()=>{},tabIndex:-1})]})]},u.id)}),D.jsx("div",{className:"pt-6",children:D.jsx(wn,{type:"submit",isLoading:i,className:"w-full py-4 text-lg shadow-lg shadow-[#F9A26C]/50",children:"Salva Scheda"})})]})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var gl={};gl.version="0.18.5";var Bm=1252,nE=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Um=function(e){nE.indexOf(e)!=-1&&(Bm=e)};function iE(){Um(1252)}var Na=function(e){Um(e)};function sE(){Na(1200),iE()}var So=function(t){return String.fromCharCode(t)},wd=function(t){return String.fromCharCode(t)},xl,yn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Pa(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),a=(r&3)<<4|n>>4,i=e.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=yn.charAt(s)+yn.charAt(a)+yn.charAt(o)+yn.charAt(l);return t}function sn(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=yn.indexOf(e.charAt(u++)),a=yn.indexOf(e.charAt(u++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=yn.indexOf(e.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=yn.indexOf(e.charAt(u++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var ke=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),un=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ci(e){return ke?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function yd(e){return ke?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ar=function(t){return ke?un(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Zl(e){if(typeof ArrayBuffer>"u")return Ar(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ha(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function aE(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var _t=ke?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:un(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function oE(e){for(var t=[],r=0,n=e.length+250,i=ci(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=ci(65535),n=65530)}return t.push(i.slice(0,r)),_t(t)}var ta=/\u0000/g,To=/[\u0001-\u0006]/g;function rs(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Cr(e,t){var r=""+e;return r.length>=t?r:Ye("0",t-r.length)+r}function a0(e,t){var r=""+e;return r.length>=t?r:Ye(" ",t-r.length)+r}function _l(e,t){var r=""+e;return r.length>=t?r:r+Ye(" ",t-r.length)}function lE(e,t){var r=""+Math.round(e);return r.length>=t?r:Ye("0",t-r.length)+r}function uE(e,t){var r=""+e;return r.length>=t?r:Ye("0",t-r.length)+r}var Ed=Math.pow(2,32);function Oi(e,t){if(e>Ed||e<-Ed)return lE(e,t);var r=Math.round(e);return uE(r,t)}function wl(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Sd=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Vu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function cE(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Je={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Td={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},fE={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function yl(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,l=1,u=0,c=0,h=Math.floor(i);u<t&&(h=Math.floor(i),o=h*a+s,c=h*u+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=u,u=c;if(c>t&&(u>t?(c=l,o=s):(c=u,o=a)),!r)return[0,n*o,c];var f=Math.floor(n*o/c);return[f,n*o-f*c,c]}function ko(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=xE(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var jm=new Date(1899,11,31,0,0,0),hE=jm.getTime(),dE=new Date(1900,2,1,0,0,0);function $m(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=dE&&(r+=24*60*60*1e3),(r-(hE+(e.getTimezoneOffset()-jm.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function o0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function pE(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function mE(e){var t=e<0?12:11,r=o0(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function vE(e){var t=o0(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function gE(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=mE(e):t===10?r=e.toFixed(10).substr(0,12):r=vE(e),o0(pE(r.toUpperCase()))}function af(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):gE(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return In(14,$m(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function xE(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function _E(e,t,r,n){var i="",s=0,a=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return Vu[r.m-1][1];case 5:return Vu[r.m-1][0];default:return Vu[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return Sd[r.q][0];default:return Sd[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Cr(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=Cr(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var c=u>0?Cr(l,u):"";return c}function En(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Wm=/%/g;function wE(e,t,r){var n=t.replace(Wm,""),i=t.length-n.length;return Jr(e,n,r*Math.pow(10,2*i))+Ye("%",i)}function yE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Jr(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function zm(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+zm(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,c){return l+u+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Hm=/# (\?+)( ?)\/( ?)(\d+)/;function EE(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Ye(" ",e[1].length+1+e[4].length):a0(a,e[1].length)+e[2]+"/"+e[3]+Cr(o,e[4].length))}function SE(e,t,r){return r+(t===0?"":""+t)+Ye(" ",e[1].length+2+e[4].length)}var Vm=/^#*0*\.([0#]+)/,Gm=/\).*[0#]/,Km=/\(###\) ###\\?-####/;function Dt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function kd(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ad(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function TE(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function kE(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function lr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Gm)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?lr("n",n,r):"("+lr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return yE(e,t,r);if(t.indexOf("%")!==-1)return wE(e,t,r);if(t.indexOf("E")!==-1)return zm(t,r);if(t.charCodeAt(0)===36)return"$"+lr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Oi(l,t.length);if(t.match(/^[#?]+$/))return i=Oi(r,0),i==="0"&&(i=""),i.length>t.length?i:Dt(t.substr(0,t.length-i.length))+i;if(s=t.match(Hm))return EE(s,l,u);if(t.match(/^#+0+$/))return u+Oi(l,t.length-t.indexOf("0"));if(s=t.match(Vm))return i=kd(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Dt(s[1])).replace(/\.$/,"."+Dt(s[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+Ye("0",Dt(s[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+kd(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+En(Oi(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+lr(e,t,-r):En(""+(Math.floor(r)+TE(r,s[1].length)))+"."+Cr(Ad(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return lr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=rs(lr(e,t.replace(/[\\-]/g,""),r)),a=0,rs(rs(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<i.length?i.charAt(a++):m==="0"?"0":""}));if(t.match(Km))return i=lr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=yl(l,Math.pow(10,a)-1,!1),i=""+u,c=Jr("n",s[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=_l(o[2],a),c.length<s[4].length&&(c=Dt(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=yl(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?a0(o[1],a)+s[2]+"/"+s[3]+_l(o[2],a):Ye(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Oi(r,0),t.length<=i.length?i:Dt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=t.indexOf(".")-a,f=t.length-i.length-h;return Dt(t.substr(0,h)+i+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=Ad(r,s[1].length),r<0?"-"+lr(e,t,-r):En(kE(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Cr(0,3-m.length):"")+m})+"."+Cr(a,s[1].length);switch(t){case"###,##0.00":return lr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=En(Oi(l,0));return d!=="0"?u+d:"";case"###,###.00":return lr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return lr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function AE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Jr(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function CE(e,t,r){var n=t.replace(Wm,""),i=t.length-n.length;return Jr(e,n,r*Math.pow(10,2*i))+Ye("%",i)}function qm(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+qm(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,c){return l+u+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Lr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Gm)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Lr("n",n,r):"("+Lr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return AE(e,t,r);if(t.indexOf("%")!==-1)return CE(e,t,r);if(t.indexOf("E")!==-1)return qm(t,r);if(t.charCodeAt(0)===36)return"$"+Lr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Cr(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Dt(t.substr(0,t.length-i.length))+i;if(s=t.match(Hm))return SE(s,l,u);if(t.match(/^#+0+$/))return u+Cr(l,t.length-t.indexOf("0"));if(s=t.match(Vm))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Dt(s[1])).replace(/\.$/,"."+Dt(s[1])),i=i.replace(/\.(\d*)$/,function(m,p){return"."+p+Ye("0",Dt(s[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+En(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Lr(e,t,-r):En(""+r)+"."+Ye("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Lr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=rs(Lr(e,t.replace(/[\\-]/g,""),r)),a=0,rs(rs(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<i.length?i.charAt(a++):m==="0"?"0":""}));if(t.match(Km))return i=Lr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=yl(l,Math.pow(10,a)-1,!1),i=""+u,c=Jr("n",s[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=_l(o[2],a),c.length<s[4].length&&(c=Dt(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=yl(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?a0(o[1],a)+s[2]+"/"+s[3]+_l(o[2],a):Ye(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Dt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=t.indexOf(".")-a,f=t.length-i.length-h;return Dt(t.substr(0,h)+i+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Lr(e,t,-r):En(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Cr(0,3-m.length):"")+m})+"."+Cr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=En(""+l);return d!=="0"?u+d:"";default:if(t.match(/\.[0#?]*$/))return Lr(e,t.slice(0,t.lastIndexOf(".")),r)+Dt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Jr(e,t,r){return(r|0)===r?Lr(e,t,r):lr(e,t,r)}function OE(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Xm=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ym(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":wl(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Xm))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function RE(e,t,r,n){for(var i=[],s="",a=0,o="",l="t",u,c,h,f="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!wl(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var d=e.charAt(++a),m=d==="("||d===")"?d:"t";i[i.length]={t:m,v:d},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(u==null&&(u=ko(t,r,e.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=ko(t,r),u==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var p={t:o,v:o};if(u==null&&(u=ko(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",f="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",a+=5,f="h"):e.substr(a,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",a+=5,f="h"):(p.t="t",++a),u==null&&p.t==="T")return"";i[i.length]=p,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Xm)){if(u==null&&(u=ko(t,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ym(e)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var _=0,x=0,v;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=f,l="h",_<1&&(_=1);break;case"s":(v=i[a].v.match(/\.0+$/))&&(x=Math.max(x,v[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[a].v.match(/[Hh]/)&&(_=1),_<2&&i[a].v.match(/[Mm]/)&&(_=2),_<3&&i[a].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var g="",T;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=_E(i[a].t.charCodeAt(0),i[a].v,u,x),i[a].t="t";break;case"n":case"?":for(T=a+1;i[T]!=null&&((o=i[T].t)==="?"||o==="D"||(o===" "||o==="t")&&i[T+1]!=null&&(i[T+1].t==="?"||i[T+1].t==="t"&&i[T+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[T].v==="/"||i[T].v===" "&&i[T+1]!=null&&i[T+1].t=="?"));)i[a].v+=i[T].v,i[T]={v:"",t:";"},++T;g+=i[a].v,a=T-1;break;case"G":i[a].t="t",i[a].v=af(t,r);break}var I="",L,A;if(g.length>0){g.charCodeAt(0)==40?(L=t<0&&g.charCodeAt(0)===45?-t:t,A=Jr("n",g,L)):(L=t<0&&n>1?-t:t,A=Jr("n",g,L),L<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),T=A.length-1;var P=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){P=a;break}var N=i.length;if(P===i.length&&A.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(T>=i[a].v.length-1?(T-=i[a].v.length,i[a].v=A.substr(T+1,i[a].v.length)):T<0?i[a].v="":(i[a].v=A.substr(0,T+1),T=-1),i[a].t="t",N=a);T>=0&&N<i.length&&(i[N].v=A.substr(0,T+1)+i[N].v)}else if(P!==i.length&&A.indexOf("E")===-1){for(T=A.indexOf(".")-1,a=P;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(c=i[a].v.indexOf(".")>-1&&a===P?i[a].v.indexOf(".")-1:i[a].v.length-1,I=i[a].v.substr(c+1);c>=0;--c)T>=0&&(i[a].v.charAt(c)==="0"||i[a].v.charAt(c)==="#")&&(I=A.charAt(T--)+I);i[a].v=I,i[a].t="t",N=a}for(T>=0&&N<i.length&&(i[N].v=A.substr(0,T+1)+i[N].v),T=A.indexOf(".")+1,a=P;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==P)){for(c=i[a].v.indexOf(".")>-1&&a===P?i[a].v.indexOf(".")+1:0,I=i[a].v.substr(0,c);c<i[a].v.length;++c)T<A.length&&(I+=A.charAt(T++));i[a].v=I,i[a].t="t",N=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(L=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=Jr(i[a].t,i[a].v,L),i[a].t="t");var W="";for(a=0;a!==i.length;++a)i[a]!=null&&(W+=i[a].v);return W}var Cd=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Od(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function FE(e,t){var r=OE(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Cd),o=r[1].match(Cd);return Od(t,a)?[n,r[0]]:Od(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function In(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Je)[e],n==null&&(n=r.table&&r.table[Td[e]]||Je[Td[e]]),n==null&&(n=fE[e]||"General");break}if(wl(n,0))return af(t,r);t instanceof Date&&(t=$m(t,r.date1904));var i=FE(n,t);if(wl(i[1]))return af(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return RE(i[1],t,r,i[0])}function Jm(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Je[r]==null){t<0&&(t=r);continue}if(Je[r]==e){t=r;break}}t<0&&(t=391)}return Je[t]=e,t}function eu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Jm(e[t],t)}function tu(){Je=cE()}var Qm=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function NE(e){var t=typeof e=="number"?Je[e]:e;return t=t.replace(Qm,"(\\d+)"),new RegExp("^"+t+"$")}function PE(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(Qm)||[]).forEach(function(h,f){var d=parseInt(r[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":a=d;break;case"s":l=d;break;case"m":a>=0?o=d:i=d;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var c=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&s==-1?c:u+"T"+c}var IE=function(){var e={};e.version="1.2.0";function t(){for(var A=0,P=new Array(256),N=0;N!=256;++N)A=N,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,P[N]=A;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(A){var P=0,N=0,W=0,G=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)G[W]=A[W];for(W=0;W!=256;++W)for(N=A[W],P=256+W;P<4096;P+=256)N=G[P]=N>>>8^A[N&255];var q=[];for(W=1;W!=16;++W)q[W-1]=typeof Int32Array<"u"?G.subarray(W*256,W*256+256):G.slice(W*256,W*256+256);return q}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],c=i[5],h=i[6],f=i[7],d=i[8],m=i[9],p=i[10],_=i[11],x=i[12],v=i[13],g=i[14];function T(A,P){for(var N=P^-1,W=0,G=A.length;W<G;)N=N>>>8^r[(N^A.charCodeAt(W++))&255];return~N}function I(A,P){for(var N=P^-1,W=A.length-15,G=0;G<W;)N=g[A[G++]^N&255]^v[A[G++]^N>>8&255]^x[A[G++]^N>>16&255]^_[A[G++]^N>>>24]^p[A[G++]]^m[A[G++]]^d[A[G++]]^f[A[G++]]^h[A[G++]]^c[A[G++]]^u[A[G++]]^l[A[G++]]^o[A[G++]]^a[A[G++]]^s[A[G++]]^r[A[G++]];for(W+=15;G<W;)N=N>>>8^r[(N^A[G++])&255];return~N}function L(A,P){for(var N=P^-1,W=0,G=A.length,q=0,re=0;W<G;)q=A.charCodeAt(W++),q<128?N=N>>>8^r[(N^q)&255]:q<2048?(N=N>>>8^r[(N^(192|q>>6&31))&255],N=N>>>8^r[(N^(128|q&63))&255]):q>=55296&&q<57344?(q=(q&1023)+64,re=A.charCodeAt(W++)&1023,N=N>>>8^r[(N^(240|q>>8&7))&255],N=N>>>8^r[(N^(128|q>>2&63))&255],N=N>>>8^r[(N^(128|re>>6&15|(q&3)<<4))&255],N=N>>>8^r[(N^(128|re&63))&255]):(N=N>>>8^r[(N^(224|q>>12&15))&255],N=N>>>8^r[(N^(128|q>>6&63))&255],N=N>>>8^r[(N^(128|q&63))&255]);return~N}return e.table=r,e.bstr=T,e.buf=I,e.str=L,e}(),Pe=function(){var t={};t.version="1.2.1";function r(w,S){for(var y=w.split("/"),E=S.split("/"),k=0,C=0,M=Math.min(y.length,E.length);k<M;++k){if(C=y[k].length-E[k].length)return C;if(y[k]!=E[k])return y[k]<E[k]?-1:1}return y.length-E.length}function n(w){if(w.charAt(w.length-1)=="/")return w.slice(0,-1).indexOf("/")===-1?w:n(w.slice(0,-1));var S=w.lastIndexOf("/");return S===-1?w:w.slice(0,S+1)}function i(w){if(w.charAt(w.length-1)=="/")return i(w.slice(0,-1));var S=w.lastIndexOf("/");return S===-1?w:w.slice(S+1)}function s(w,S){typeof S=="string"&&(S=new Date(S));var y=S.getHours();y=y<<6|S.getMinutes(),y=y<<5|S.getSeconds()>>>1,w.write_shift(2,y);var E=S.getFullYear()-1980;E=E<<4|S.getMonth()+1,E=E<<5|S.getDate(),w.write_shift(2,E)}function a(w){var S=w.read_shift(2)&65535,y=w.read_shift(2)&65535,E=new Date,k=y&31;y>>>=5;var C=y&15;y>>>=4,E.setMilliseconds(0),E.setFullYear(y+1980),E.setMonth(C-1),E.setDate(k);var M=S&31;S>>>=5;var H=S&63;return S>>>=6,E.setHours(S),E.setMinutes(H),E.setSeconds(M<<1),E}function o(w){Jt(w,0);for(var S={},y=0;w.l<=w.length-4;){var E=w.read_shift(2),k=w.read_shift(2),C=w.l+k,M={};switch(E){case 21589:y=w.read_shift(1),y&1&&(M.mtime=w.read_shift(4)),k>5&&(y&2&&(M.atime=w.read_shift(4)),y&4&&(M.ctime=w.read_shift(4))),M.mtime&&(M.mt=new Date(M.mtime*1e3));break}w.l=C,S[E]=M}return S}var l;function u(){return l||(l={})}function c(w,S){if(w[0]==80&&w[1]==75)return b0(w,S);if((w[0]|32)==109&&(w[1]|32)==105)return Rg(w,S);if(w.length<512)throw new Error("CFB file size "+w.length+" < 512");var y=3,E=512,k=0,C=0,M=0,H=0,b=0,B=[],j=w.slice(0,512);Jt(j,0);var X=h(j);switch(y=X[0],y){case 3:E=512;break;case 4:E=4096;break;case 0:if(X[1]==0)return b0(w,S);default:throw new Error("Major Version: Expected 3 or 4 saw "+y)}E!==512&&(j=w.slice(0,E),Jt(j,28));var ee=w.slice(0,E);f(j,y);var se=j.read_shift(4,"i");if(y===3&&se!==0)throw new Error("# Directory Sectors: Expected 0 saw "+se);j.l+=4,M=j.read_shift(4,"i"),j.l+=4,j.chk("00100000","Mini Stream Cutoff Size: "),H=j.read_shift(4,"i"),k=j.read_shift(4,"i"),b=j.read_shift(4,"i"),C=j.read_shift(4,"i");for(var J=-1,ie=0;ie<109&&(J=j.read_shift(4,"i"),!(J<0));++ie)B[ie]=J;var ge=d(w,E);_(b,C,ge,E,B);var We=v(ge,M,B,E);We[M].name="!Directory",k>0&&H!==re&&(We[H].name="!MiniFAT"),We[B[0]].name="!FAT",We.fat_addrs=B,We.ssz=E;var ze={},kt=[],Ss=[],Ts=[];g(M,We,ge,kt,k,ze,Ss,H),m(Ss,Ts,kt),kt.shift();var ks={FileIndex:Ss,FullPaths:Ts};return S&&S.raw&&(ks.raw={header:ee,sectors:ge}),ks}function h(w){if(w[w.l]==80&&w[w.l+1]==75)return[0,0];w.chk(Te,"Header Signature: "),w.l+=16;var S=w.read_shift(2,"u");return[w.read_shift(2,"u"),S]}function f(w,S){var y=9;switch(w.l+=2,y=w.read_shift(2)){case 9:if(S!=3)throw new Error("Sector Shift: Expected 9 saw "+y);break;case 12:if(S!=4)throw new Error("Sector Shift: Expected 12 saw "+y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+y)}w.chk("0600","Mini Sector Shift: "),w.chk("000000000000","Reserved: ")}function d(w,S){for(var y=Math.ceil(w.length/S)-1,E=[],k=1;k<y;++k)E[k-1]=w.slice(k*S,(k+1)*S);return E[y-1]=w.slice(y*S),E}function m(w,S,y){for(var E=0,k=0,C=0,M=0,H=0,b=y.length,B=[],j=[];E<b;++E)B[E]=j[E]=E,S[E]=y[E];for(;H<j.length;++H)E=j[H],k=w[E].L,C=w[E].R,M=w[E].C,B[E]===E&&(k!==-1&&B[k]!==k&&(B[E]=B[k]),C!==-1&&B[C]!==C&&(B[E]=B[C])),M!==-1&&(B[M]=E),k!==-1&&E!=B[E]&&(B[k]=B[E],j.lastIndexOf(k)<H&&j.push(k)),C!==-1&&E!=B[E]&&(B[C]=B[E],j.lastIndexOf(C)<H&&j.push(C));for(E=1;E<b;++E)B[E]===E&&(C!==-1&&B[C]!==C?B[E]=B[C]:k!==-1&&B[k]!==k&&(B[E]=B[k]));for(E=1;E<b;++E)if(w[E].type!==0){if(H=E,H!=B[H])do H=B[H],S[E]=S[H]+"/"+S[E];while(H!==0&&B[H]!==-1&&H!=B[H]);B[E]=-1}for(S[0]+="/",E=1;E<b;++E)w[E].type!==2&&(S[E]+="/")}function p(w,S,y){for(var E=w.start,k=w.size,C=[],M=E;y&&k>0&&M>=0;)C.push(S.slice(M*q,M*q+q)),k-=q,M=Yn(y,M*4);return C.length===0?z(0):_t(C).slice(0,w.size)}function _(w,S,y,E,k){var C=re;if(w===re){if(S!==0)throw new Error("DIFAT chain shorter than expected")}else if(w!==-1){var M=y[w],H=(E>>>2)-1;if(!M)return;for(var b=0;b<H&&(C=Yn(M,b*4))!==re;++b)k.push(C);_(Yn(M,E-4),S-1,y,E,k)}}function x(w,S,y,E,k){var C=[],M=[];k||(k=[]);var H=E-1,b=0,B=0;for(b=S;b>=0;){k[b]=!0,C[C.length]=b,M.push(w[b]);var j=y[Math.floor(b*4/E)];if(B=b*4&H,E<4+B)throw new Error("FAT boundary crossed: "+b+" 4 "+E);if(!w[j])break;b=Yn(w[j],B)}return{nodes:C,data:bd([M])}}function v(w,S,y,E){var k=w.length,C=[],M=[],H=[],b=[],B=E-1,j=0,X=0,ee=0,se=0;for(j=0;j<k;++j)if(H=[],ee=j+S,ee>=k&&(ee-=k),!M[ee]){b=[];var J=[];for(X=ee;X>=0;){J[X]=!0,M[X]=!0,H[H.length]=X,b.push(w[X]);var ie=y[Math.floor(X*4/E)];if(se=X*4&B,E<4+se)throw new Error("FAT boundary crossed: "+X+" 4 "+E);if(!w[ie]||(X=Yn(w[ie],se),J[X]))break}C[ee]={nodes:H,data:bd([b])}}return C}function g(w,S,y,E,k,C,M,H){for(var b=0,B=E.length?2:0,j=S[w].data,X=0,ee=0,se;X<j.length;X+=128){var J=j.slice(X,X+128);Jt(J,64),ee=J.read_shift(2),se=h0(J,0,ee-B),E.push(se);var ie={name:se,type:J.read_shift(1),color:J.read_shift(1),L:J.read_shift(4,"i"),R:J.read_shift(4,"i"),C:J.read_shift(4,"i"),clsid:J.read_shift(16),state:J.read_shift(4,"i"),start:0,size:0},ge=J.read_shift(2)+J.read_shift(2)+J.read_shift(2)+J.read_shift(2);ge!==0&&(ie.ct=T(J,J.l-8));var We=J.read_shift(2)+J.read_shift(2)+J.read_shift(2)+J.read_shift(2);We!==0&&(ie.mt=T(J,J.l-8)),ie.start=J.read_shift(4,"i"),ie.size=J.read_shift(4,"i"),ie.size<0&&ie.start<0&&(ie.size=ie.type=0,ie.start=re,ie.name=""),ie.type===5?(b=ie.start,k>0&&b!==re&&(S[b].name="!StreamData")):ie.size>=4096?(ie.storage="fat",S[ie.start]===void 0&&(S[ie.start]=x(y,ie.start,S.fat_addrs,S.ssz)),S[ie.start].name=ie.name,ie.content=S[ie.start].data.slice(0,ie.size)):(ie.storage="minifat",ie.size<0?ie.size=0:b!==re&&ie.start!==re&&S[b]&&(ie.content=p(ie,S[b].data,(S[H]||{}).data))),ie.content&&Jt(ie.content,0),C[se]=ie,M.push(ie)}}function T(w,S){return new Date((Zt(w,S+4)/1e7*Math.pow(2,32)+Zt(w,S)/1e7-11644473600)*1e3)}function I(w,S){return u(),c(l.readFileSync(w),S)}function L(w,S){var y=S&&S.type;switch(y||ke&&Buffer.isBuffer(w)&&(y="buffer"),y||"base64"){case"file":return I(w,S);case"base64":return c(Ar(sn(w)),S);case"binary":return c(Ar(w),S)}return c(w,S)}function A(w,S){var y=S||{},E=y.root||"Root Entry";if(w.FullPaths||(w.FullPaths=[]),w.FileIndex||(w.FileIndex=[]),w.FullPaths.length!==w.FileIndex.length)throw new Error("inconsistent CFB structure");w.FullPaths.length===0&&(w.FullPaths[0]=E+"/",w.FileIndex[0]={name:E,type:5}),y.CLSID&&(w.FileIndex[0].clsid=y.CLSID),P(w)}function P(w){var S="Sh33tJ5";if(!Pe.find(w,"/"+S)){var y=z(4);y[0]=55,y[1]=y[3]=50,y[2]=54,w.FileIndex.push({name:S,type:2,content:y,size:4,L:69,R:69,C:69}),w.FullPaths.push(w.FullPaths[0]+S),N(w)}}function N(w,S){A(w);for(var y=!1,E=!1,k=w.FullPaths.length-1;k>=0;--k){var C=w.FileIndex[k];switch(C.type){case 0:E?y=!0:(w.FileIndex.pop(),w.FullPaths.pop());break;case 1:case 2:case 5:E=!0,isNaN(C.R*C.L*C.C)&&(y=!0),C.R>-1&&C.L>-1&&C.R==C.L&&(y=!0);break;default:y=!0;break}}if(!(!y&&!S)){var M=new Date(1987,1,19),H=0,b=Object.create?Object.create(null):{},B=[];for(k=0;k<w.FullPaths.length;++k)b[w.FullPaths[k]]=!0,w.FileIndex[k].type!==0&&B.push([w.FullPaths[k],w.FileIndex[k]]);for(k=0;k<B.length;++k){var j=n(B[k][0]);E=b[j],E||(B.push([j,{name:i(j).replace("/",""),type:1,clsid:Qe,ct:M,mt:M,content:null}]),b[j]=!0)}for(B.sort(function(se,J){return r(se[0],J[0])}),w.FullPaths=[],w.FileIndex=[],k=0;k<B.length;++k)w.FullPaths[k]=B[k][0],w.FileIndex[k]=B[k][1];for(k=0;k<B.length;++k){var X=w.FileIndex[k],ee=w.FullPaths[k];if(X.name=i(ee).replace("/",""),X.L=X.R=X.C=-(X.color=1),X.size=X.content?X.content.length:0,X.start=0,X.clsid=X.clsid||Qe,k===0)X.C=B.length>1?1:-1,X.size=0,X.type=5;else if(ee.slice(-1)=="/"){for(H=k+1;H<B.length&&n(w.FullPaths[H])!=ee;++H);for(X.C=H>=B.length?-1:H,H=k+1;H<B.length&&n(w.FullPaths[H])!=n(ee);++H);X.R=H>=B.length?-1:H,X.type=1}else n(w.FullPaths[k+1]||"")==n(ee)&&(X.R=k+1),X.type=2}}}function W(w,S){var y=S||{};if(y.fileType=="mad")return Fg(w,y);switch(N(w),y.fileType){case"zip":return Sg(w,y)}var E=function(se){for(var J=0,ie=0,ge=0;ge<se.FileIndex.length;++ge){var We=se.FileIndex[ge];if(We.content){var ze=We.content.length;ze>0&&(ze<4096?J+=ze+63>>6:ie+=ze+511>>9)}}for(var kt=se.FullPaths.length+3>>2,Ss=J+7>>3,Ts=J+127>>7,ks=Ss+ie+kt+Ts,Wn=ks+127>>7,fu=Wn<=109?0:Math.ceil((Wn-109)/127);ks+Wn+fu+127>>7>Wn;)fu=++Wn<=109?0:Math.ceil((Wn-109)/127);var Hr=[1,fu,Wn,Ts,kt,ie,J,0];return se.FileIndex[0].size=J<<6,Hr[7]=(se.FileIndex[0].start=Hr[0]+Hr[1]+Hr[2]+Hr[3]+Hr[4]+Hr[5])+(Hr[6]+7>>3),Hr}(w),k=z(E[7]<<9),C=0,M=0;{for(C=0;C<8;++C)k.write_shift(1,ve[C]);for(C=0;C<8;++C)k.write_shift(2,0);for(k.write_shift(2,62),k.write_shift(2,3),k.write_shift(2,65534),k.write_shift(2,9),k.write_shift(2,6),C=0;C<3;++C)k.write_shift(2,0);for(k.write_shift(4,0),k.write_shift(4,E[2]),k.write_shift(4,E[0]+E[1]+E[2]+E[3]-1),k.write_shift(4,0),k.write_shift(4,4096),k.write_shift(4,E[3]?E[0]+E[1]+E[2]-1:re),k.write_shift(4,E[3]),k.write_shift(-4,E[1]?E[0]-1:re),k.write_shift(4,E[1]),C=0;C<109;++C)k.write_shift(-4,C<E[2]?E[1]+C:-1)}if(E[1])for(M=0;M<E[1];++M){for(;C<236+M*127;++C)k.write_shift(-4,C<E[2]?E[1]+C:-1);k.write_shift(-4,M===E[1]-1?re:M+1)}var H=function(se){for(M+=se;C<M-1;++C)k.write_shift(-4,C+1);se&&(++C,k.write_shift(-4,re))};for(M=C=0,M+=E[1];C<M;++C)k.write_shift(-4,Me.DIFSECT);for(M+=E[2];C<M;++C)k.write_shift(-4,Me.FATSECT);H(E[3]),H(E[4]);for(var b=0,B=0,j=w.FileIndex[0];b<w.FileIndex.length;++b)j=w.FileIndex[b],j.content&&(B=j.content.length,!(B<4096)&&(j.start=M,H(B+511>>9)));for(H(E[6]+7>>3);k.l&511;)k.write_shift(-4,Me.ENDOFCHAIN);for(M=C=0,b=0;b<w.FileIndex.length;++b)j=w.FileIndex[b],j.content&&(B=j.content.length,!(!B||B>=4096)&&(j.start=M,H(B+63>>6)));for(;k.l&511;)k.write_shift(-4,Me.ENDOFCHAIN);for(C=0;C<E[4]<<2;++C){var X=w.FullPaths[C];if(!X||X.length===0){for(b=0;b<17;++b)k.write_shift(4,0);for(b=0;b<3;++b)k.write_shift(4,-1);for(b=0;b<12;++b)k.write_shift(4,0);continue}j=w.FileIndex[C],C===0&&(j.start=j.size?j.start-1:re);var ee=C===0&&y.root||j.name;if(B=2*(ee.length+1),k.write_shift(64,ee,"utf16le"),k.write_shift(2,B),k.write_shift(1,j.type),k.write_shift(1,j.color),k.write_shift(-4,j.L),k.write_shift(-4,j.R),k.write_shift(-4,j.C),j.clsid)k.write_shift(16,j.clsid,"hex");else for(b=0;b<4;++b)k.write_shift(4,0);k.write_shift(4,j.state||0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,j.start),k.write_shift(4,j.size),k.write_shift(4,0)}for(C=1;C<w.FileIndex.length;++C)if(j=w.FileIndex[C],j.size>=4096)if(k.l=j.start+1<<9,ke&&Buffer.isBuffer(j.content))j.content.copy(k,k.l,0,j.size),k.l+=j.size+511&-512;else{for(b=0;b<j.size;++b)k.write_shift(1,j.content[b]);for(;b&511;++b)k.write_shift(1,0)}for(C=1;C<w.FileIndex.length;++C)if(j=w.FileIndex[C],j.size>0&&j.size<4096)if(ke&&Buffer.isBuffer(j.content))j.content.copy(k,k.l,0,j.size),k.l+=j.size+63&-64;else{for(b=0;b<j.size;++b)k.write_shift(1,j.content[b]);for(;b&63;++b)k.write_shift(1,0)}if(ke)k.l=k.length;else for(;k.l<k.length;)k.write_shift(1,0);return k}function G(w,S){var y=w.FullPaths.map(function(b){return b.toUpperCase()}),E=y.map(function(b){var B=b.split("/");return B[B.length-(b.slice(-1)=="/"?2:1)]}),k=!1;S.charCodeAt(0)===47?(k=!0,S=y[0].slice(0,-1)+S):k=S.indexOf("/")!==-1;var C=S.toUpperCase(),M=k===!0?y.indexOf(C):E.indexOf(C);if(M!==-1)return w.FileIndex[M];var H=!C.match(To);for(C=C.replace(ta,""),H&&(C=C.replace(To,"!")),M=0;M<y.length;++M)if((H?y[M].replace(To,"!"):y[M]).replace(ta,"")==C||(H?E[M].replace(To,"!"):E[M]).replace(ta,"")==C)return w.FileIndex[M];return null}var q=64,re=-2,Te="d0cf11e0a1b11ae1",ve=[208,207,17,224,161,177,26,225],Qe="00000000000000000000000000000000",Me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:re,FREESECT:-1,HEADER_SIGNATURE:Te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Qe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function te(w,S,y){u();var E=W(w,y);l.writeFileSync(S,E)}function ce(w){for(var S=new Array(w.length),y=0;y<w.length;++y)S[y]=String.fromCharCode(w[y]);return S.join("")}function de(w,S){var y=W(w,S);switch(S&&S.type||"buffer"){case"file":return u(),l.writeFileSync(S.filename,y),y;case"binary":return typeof y=="string"?y:ce(y);case"base64":return Pa(typeof y=="string"?y:ce(y));case"buffer":if(ke)return Buffer.isBuffer(y)?y:un(y);case"array":return typeof y=="string"?Ar(y):y}return y}var we;function O(w){try{var S=w.InflateRaw,y=new S;if(y._processChunk(new Uint8Array([3,0]),y._finishFlushFlag),y.bytesRead)we=w;else throw new Error("zlib does not expose bytesRead")}catch(E){console.error("cannot use native zlib: "+(E.message||E))}}function U(w,S){if(!we)return D0(w,S);var y=we.InflateRaw,E=new y,k=E._processChunk(w.slice(w.l),E._finishFlushFlag);return w.l+=E.bytesRead,k}function F(w){return we?we.deflateRawSync(w):O0(w)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function he(w){var S=(w<<1|w<<11)&139536|(w<<5|w<<15)&558144;return(S>>16|S>>8|S)&255}for(var ue=typeof Uint8Array<"u",ne=ue?new Uint8Array(256):[],Ie=0;Ie<256;++Ie)ne[Ie]=he(Ie);function ye(w,S){var y=ne[w&255];return S<=8?y>>>8-S:(y=y<<8|ne[w>>8&255],S<=16?y>>>16-S:(y=y<<8|ne[w>>16&255],y>>>24-S))}function Pt(w,S){var y=S&7,E=S>>>3;return(w[E]|(y<=6?0:w[E+1]<<8))>>>y&3}function Ae(w,S){var y=S&7,E=S>>>3;return(w[E]|(y<=5?0:w[E+1]<<8))>>>y&7}function Wr(w,S){var y=S&7,E=S>>>3;return(w[E]|(y<=4?0:w[E+1]<<8))>>>y&15}function Ke(w,S){var y=S&7,E=S>>>3;return(w[E]|(y<=3?0:w[E+1]<<8))>>>y&31}function le(w,S){var y=S&7,E=S>>>3;return(w[E]|(y<=1?0:w[E+1]<<8))>>>y&127}function or(w,S,y){var E=S&7,k=S>>>3,C=(1<<y)-1,M=w[k]>>>E;return y<8-E||(M|=w[k+1]<<8-E,y<16-E)||(M|=w[k+2]<<16-E,y<24-E)||(M|=w[k+3]<<24-E),M&C}function zr(w,S,y){var E=S&7,k=S>>>3;return E<=5?w[k]|=(y&7)<<E:(w[k]|=y<<E&255,w[k+1]=(y&7)>>8-E),S+3}function jn(w,S,y){var E=S&7,k=S>>>3;return y=(y&1)<<E,w[k]|=y,S+1}function wi(w,S,y){var E=S&7,k=S>>>3;return y<<=E,w[k]|=y&255,y>>>=8,w[k+1]=y,S+8}function C0(w,S,y){var E=S&7,k=S>>>3;return y<<=E,w[k]|=y&255,y>>>=8,w[k+1]=y&255,w[k+2]=y>>>8,S+16}function ou(w,S){var y=w.length,E=2*y>S?2*y:S+5,k=0;if(y>=S)return w;if(ke){var C=yd(E);if(w.copy)w.copy(C);else for(;k<w.length;++k)C[k]=w[k];return C}else if(ue){var M=new Uint8Array(E);if(M.set)M.set(w);else for(;k<y;++k)M[k]=w[k];return M}return w.length=E,w}function Ir(w){for(var S=new Array(w),y=0;y<w;++y)S[y]=0;return S}function Ya(w,S,y){var E=1,k=0,C=0,M=0,H=0,b=w.length,B=ue?new Uint16Array(32):Ir(32);for(C=0;C<32;++C)B[C]=0;for(C=b;C<y;++C)w[C]=0;b=w.length;var j=ue?new Uint16Array(b):Ir(b);for(C=0;C<b;++C)B[k=w[C]]++,E<k&&(E=k),j[C]=0;for(B[0]=0,C=1;C<=E;++C)B[C+16]=H=H+B[C-1]<<1;for(C=0;C<b;++C)H=w[C],H!=0&&(j[C]=B[H+16]++);var X=0;for(C=0;C<b;++C)if(X=w[C],X!=0)for(H=ye(j[C],E)>>E-X,M=(1<<E+4-X)-1;M>=0;--M)S[H|M<<X]=X&15|C<<4;return E}var lu=ue?new Uint16Array(512):Ir(512),uu=ue?new Uint16Array(32):Ir(32);if(!ue){for(var $n=0;$n<512;++$n)lu[$n]=0;for($n=0;$n<32;++$n)uu[$n]=0}(function(){for(var w=[],S=0;S<32;S++)w.push(5);Ya(w,uu,32);var y=[];for(S=0;S<=143;S++)y.push(8);for(;S<=255;S++)y.push(9);for(;S<=279;S++)y.push(7);for(;S<=287;S++)y.push(8);Ya(y,lu,288)})();var _g=function(){for(var S=ue?new Uint8Array(32768):[],y=0,E=0;y<oe.length-1;++y)for(;E<oe[y+1];++E)S[E]=y;for(;E<32768;++E)S[E]=29;var k=ue?new Uint8Array(259):[];for(y=0,E=0;y<V.length-1;++y)for(;E<V[y+1];++E)k[E]=y;function C(H,b){for(var B=0;B<H.length;){var j=Math.min(65535,H.length-B),X=B+j==H.length;for(b.write_shift(1,+X),b.write_shift(2,j),b.write_shift(2,~j&65535);j-- >0;)b[b.l++]=H[B++]}return b.l}function M(H,b){for(var B=0,j=0,X=ue?new Uint16Array(32768):[];j<H.length;){var ee=Math.min(65535,H.length-j);if(ee<10){for(B=zr(b,B,+(j+ee==H.length)),B&7&&(B+=8-(B&7)),b.l=B/8|0,b.write_shift(2,ee),b.write_shift(2,~ee&65535);ee-- >0;)b[b.l++]=H[j++];B=b.l*8;continue}B=zr(b,B,+(j+ee==H.length)+2);for(var se=0;ee-- >0;){var J=H[j];se=(se<<5^J)&32767;var ie=-1,ge=0;if((ie=X[se])&&(ie|=j&-32768,ie>j&&(ie-=32768),ie<j))for(;H[ie+ge]==H[j+ge]&&ge<250;)++ge;if(ge>2){J=k[ge],J<=22?B=wi(b,B,ne[J+1]>>1)-1:(wi(b,B,3),B+=5,wi(b,B,ne[J-23]>>5),B+=3);var We=J<8?0:J-4>>2;We>0&&(C0(b,B,ge-V[J]),B+=We),J=S[j-ie],B=wi(b,B,ne[J]>>3),B-=3;var ze=J<4?0:J-2>>1;ze>0&&(C0(b,B,j-ie-oe[J]),B+=ze);for(var kt=0;kt<ge;++kt)X[se]=j&32767,se=(se<<5^H[j])&32767,++j;ee-=ge-1}else J<=143?J=J+48:B=jn(b,B,1),B=wi(b,B,ne[J]),X[se]=j&32767,++j}B=wi(b,B,0)-1}return b.l=(B+7)/8|0,b.l}return function(b,B){return b.length<8?C(b,B):M(b,B)}}();function O0(w){var S=z(50+Math.floor(w.length*1.1)),y=_g(w,S);return S.slice(0,y)}var R0=ue?new Uint16Array(32768):Ir(32768),F0=ue?new Uint16Array(32768):Ir(32768),N0=ue?new Uint16Array(128):Ir(128),P0=1,I0=1;function wg(w,S){var y=Ke(w,S)+257;S+=5;var E=Ke(w,S)+1;S+=5;var k=Wr(w,S)+4;S+=4;for(var C=0,M=ue?new Uint8Array(19):Ir(19),H=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=1,B=ue?new Uint8Array(8):Ir(8),j=ue?new Uint8Array(8):Ir(8),X=M.length,ee=0;ee<k;++ee)M[R[ee]]=C=Ae(w,S),b<C&&(b=C),B[C]++,S+=3;var se=0;for(B[0]=0,ee=1;ee<=b;++ee)j[ee]=se=se+B[ee-1]<<1;for(ee=0;ee<X;++ee)(se=M[ee])!=0&&(H[ee]=j[se]++);var J=0;for(ee=0;ee<X;++ee)if(J=M[ee],J!=0){se=ne[H[ee]]>>8-J;for(var ie=(1<<7-J)-1;ie>=0;--ie)N0[se|ie<<J]=J&7|ee<<3}var ge=[];for(b=1;ge.length<y+E;)switch(se=N0[le(w,S)],S+=se&7,se>>>=3){case 16:for(C=3+Pt(w,S),S+=2,se=ge[ge.length-1];C-- >0;)ge.push(se);break;case 17:for(C=3+Ae(w,S),S+=3;C-- >0;)ge.push(0);break;case 18:for(C=11+le(w,S),S+=7;C-- >0;)ge.push(0);break;default:ge.push(se),b<se&&(b=se);break}var We=ge.slice(0,y),ze=ge.slice(y);for(ee=y;ee<286;++ee)We[ee]=0;for(ee=E;ee<30;++ee)ze[ee]=0;return P0=Ya(We,R0,286),I0=Ya(ze,F0,30),S}function yg(w,S){if(w[0]==3&&!(w[1]&3))return[ci(S),2];for(var y=0,E=0,k=yd(S||1<<18),C=0,M=k.length>>>0,H=0,b=0;!(E&1);){if(E=Ae(w,y),y+=3,E>>>1)E>>1==1?(H=9,b=5):(y=wg(w,y),H=P0,b=I0);else{y&7&&(y+=8-(y&7));var B=w[y>>>3]|w[(y>>>3)+1]<<8;if(y+=32,B>0)for(!S&&M<C+B&&(k=ou(k,C+B),M=k.length);B-- >0;)k[C++]=w[y>>>3],y+=8;continue}for(;;){!S&&M<C+32767&&(k=ou(k,C+32767),M=k.length);var j=or(w,y,H),X=E>>>1==1?lu[j]:R0[j];if(y+=X&15,X>>>=4,!(X>>>8&255))k[C++]=X;else{if(X==256)break;X-=257;var ee=X<8?0:X-4>>2;ee>5&&(ee=0);var se=C+V[X];ee>0&&(se+=or(w,y,ee),y+=ee),j=or(w,y,b),X=E>>>1==1?uu[j]:F0[j],y+=X&15,X>>>=4;var J=X<4?0:X-2>>1,ie=oe[X];for(J>0&&(ie+=or(w,y,J),y+=J),!S&&M<se&&(k=ou(k,se+100),M=k.length);C<se;)k[C]=k[C-ie],++C}}}return S?[k,y+7>>>3]:[k.slice(0,C),y+7>>>3]}function D0(w,S){var y=w.slice(w.l||0),E=yg(y,S);return w.l+=E[1],E[0]}function L0(w,S){if(w)typeof console<"u"&&console.error(S);else throw new Error(S)}function b0(w,S){var y=w;Jt(y,0);var E=[],k=[],C={FileIndex:E,FullPaths:k};A(C,{root:S.root});for(var M=y.length-4;(y[M]!=80||y[M+1]!=75||y[M+2]!=5||y[M+3]!=6)&&M>=0;)--M;y.l=M+4,y.l+=4;var H=y.read_shift(2);y.l+=6;var b=y.read_shift(4);for(y.l=b,M=0;M<H;++M){y.l+=20;var B=y.read_shift(4),j=y.read_shift(4),X=y.read_shift(2),ee=y.read_shift(2),se=y.read_shift(2);y.l+=8;var J=y.read_shift(4),ie=o(y.slice(y.l+X,y.l+X+ee));y.l+=X+ee+se;var ge=y.l;y.l=J+4,Eg(y,B,j,C,ie),y.l=ge}return C}function Eg(w,S,y,E,k){w.l+=2;var C=w.read_shift(2),M=w.read_shift(2),H=a(w);if(C&8257)throw new Error("Unsupported ZIP encryption");for(var b=w.read_shift(4),B=w.read_shift(4),j=w.read_shift(4),X=w.read_shift(2),ee=w.read_shift(2),se="",J=0;J<X;++J)se+=String.fromCharCode(w[w.l++]);if(ee){var ie=o(w.slice(w.l,w.l+ee));(ie[21589]||{}).mt&&(H=ie[21589].mt),((k||{})[21589]||{}).mt&&(H=k[21589].mt)}w.l+=ee;var ge=w.slice(w.l,w.l+B);switch(M){case 8:ge=U(w,j);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+M)}var We=!1;C&8&&(b=w.read_shift(4),b==134695760&&(b=w.read_shift(4),We=!0),B=w.read_shift(4),j=w.read_shift(4)),B!=S&&L0(We,"Bad compressed size: "+S+" != "+B),j!=y&&L0(We,"Bad uncompressed size: "+y+" != "+j),cu(E,se,ge,{unsafe:!0,mt:H})}function Sg(w,S){var y=S||{},E=[],k=[],C=z(1),M=y.compression?8:0,H=0,b=0,B=0,j=0,X=0,ee=w.FullPaths[0],se=ee,J=w.FileIndex[0],ie=[],ge=0;for(b=1;b<w.FullPaths.length;++b)if(se=w.FullPaths[b].slice(ee.length),J=w.FileIndex[b],!(!J.size||!J.content||se=="Sh33tJ5")){var We=j,ze=z(se.length);for(B=0;B<se.length;++B)ze.write_shift(1,se.charCodeAt(B)&127);ze=ze.slice(0,ze.l),ie[X]=IE.buf(J.content,0);var kt=J.content;M==8&&(kt=F(kt)),C=z(30),C.write_shift(4,67324752),C.write_shift(2,20),C.write_shift(2,H),C.write_shift(2,M),J.mt?s(C,J.mt):C.write_shift(4,0),C.write_shift(-4,ie[X]),C.write_shift(4,kt.length),C.write_shift(4,J.content.length),C.write_shift(2,ze.length),C.write_shift(2,0),j+=C.length,E.push(C),j+=ze.length,E.push(ze),j+=kt.length,E.push(kt),C=z(46),C.write_shift(4,33639248),C.write_shift(2,0),C.write_shift(2,20),C.write_shift(2,H),C.write_shift(2,M),C.write_shift(4,0),C.write_shift(-4,ie[X]),C.write_shift(4,kt.length),C.write_shift(4,J.content.length),C.write_shift(2,ze.length),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(4,0),C.write_shift(4,We),ge+=C.l,k.push(C),ge+=ze.length,k.push(ze),++X}return C=z(22),C.write_shift(4,101010256),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,X),C.write_shift(2,X),C.write_shift(4,ge),C.write_shift(4,j),C.write_shift(2,0),_t([_t(E),_t(k),C])}var Ja={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Tg(w,S){if(w.ctype)return w.ctype;var y=w.name||"",E=y.match(/\.([^\.]+)$/);return E&&Ja[E[1]]||S&&(E=(y=S).match(/[\.\\]([^\.\\])+$/),E&&Ja[E[1]])?Ja[E[1]]:"application/octet-stream"}function kg(w){for(var S=Pa(w),y=[],E=0;E<S.length;E+=76)y.push(S.slice(E,E+76));return y.join(`\r
`)+`\r
`}function Ag(w){var S=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(B){var j=B.charCodeAt(0).toString(16).toUpperCase();return"="+(j.length==1?"0"+j:j)});S=S.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),S.charAt(0)==`
`&&(S="=0D"+S.slice(1)),S=S.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var y=[],E=S.split(`\r
`),k=0;k<E.length;++k){var C=E[k];if(C.length==0){y.push("");continue}for(var M=0;M<C.length;){var H=76,b=C.slice(M,M+H);b.charAt(H-1)=="="?H--:b.charAt(H-2)=="="?H-=2:b.charAt(H-3)=="="&&(H-=3),b=C.slice(M,M+H),M+=H,M<C.length&&(b+="="),y.push(b)}}return y.join(`\r
`)}function Cg(w){for(var S=[],y=0;y<w.length;++y){for(var E=w[y];y<=w.length&&E.charAt(E.length-1)=="=";)E=E.slice(0,E.length-1)+w[++y];S.push(E)}for(var k=0;k<S.length;++k)S[k]=S[k].replace(/[=][0-9A-Fa-f]{2}/g,function(C){return String.fromCharCode(parseInt(C.slice(1),16))});return Ar(S.join(`\r
`))}function Og(w,S,y){for(var E="",k="",C="",M,H=0;H<10;++H){var b=S[H];if(!b||b.match(/^\s*$/))break;var B=b.match(/^(.*?):\s*([^\s].*)$/);if(B)switch(B[1].toLowerCase()){case"content-location":E=B[2].trim();break;case"content-type":C=B[2].trim();break;case"content-transfer-encoding":k=B[2].trim();break}}switch(++H,k.toLowerCase()){case"base64":M=Ar(sn(S.slice(H).join("")));break;case"quoted-printable":M=Cg(S.slice(H));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}var j=cu(w,E.slice(y.length),M,{unsafe:!0});C&&(j.ctype=C)}function Rg(w,S){if(ce(w.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var y=S&&S.root||"",E=(ke&&Buffer.isBuffer(w)?w.toString("binary"):ce(w)).split(`\r
`),k=0,C="";for(k=0;k<E.length;++k)if(C=E[k],!!/^Content-Location:/i.test(C)&&(C=C.slice(C.indexOf("file")),y||(y=C.slice(0,C.lastIndexOf("/")+1)),C.slice(0,y.length)!=y))for(;y.length>0&&(y=y.slice(0,y.length-1),y=y.slice(0,y.lastIndexOf("/")+1),C.slice(0,y.length)!=y););var M=(E[1]||"").match(/boundary="(.*?)"/);if(!M)throw new Error("MAD cannot find boundary");var H="--"+(M[1]||""),b=[],B=[],j={FileIndex:b,FullPaths:B};A(j);var X,ee=0;for(k=0;k<E.length;++k){var se=E[k];se!==H&&se!==H+"--"||(ee++&&Og(j,E.slice(X,k),y),X=k)}return j}function Fg(w,S){var y=S||{},E=y.boundary||"SheetJS";E="------="+E;for(var k=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+E.slice(2)+'"',"","",""],C=w.FullPaths[0],M=C,H=w.FileIndex[0],b=1;b<w.FullPaths.length;++b)if(M=w.FullPaths[b].slice(C.length),H=w.FileIndex[b],!(!H.size||!H.content||M=="Sh33tJ5")){M=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ge){return"_x"+ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ge){return"_u"+ge.charCodeAt(0).toString(16)+"_"});for(var B=H.content,j=ke&&Buffer.isBuffer(B)?B.toString("binary"):ce(B),X=0,ee=Math.min(1024,j.length),se=0,J=0;J<=ee;++J)(se=j.charCodeAt(J))>=32&&se<128&&++X;var ie=X>=ee*4/5;k.push(E),k.push("Content-Location: "+(y.root||"file:///C:/SheetJS/")+M),k.push("Content-Transfer-Encoding: "+(ie?"quoted-printable":"base64")),k.push("Content-Type: "+Tg(H,M)),k.push(""),k.push(ie?Ag(j):kg(j))}return k.push(E+`--\r
`),k.join(`\r
`)}function Ng(w){var S={};return A(S,w),S}function cu(w,S,y,E){var k=E&&E.unsafe;k||A(w);var C=!k&&Pe.find(w,S);if(!C){var M=w.FullPaths[0];S.slice(0,M.length)==M?M=S:(M.slice(-1)!="/"&&(M+="/"),M=(M+S).replace("//","/")),C={name:i(S),type:2},w.FileIndex.push(C),w.FullPaths.push(M),k||Pe.utils.cfb_gc(w)}return C.content=y,C.size=y?y.length:0,E&&(E.CLSID&&(C.clsid=E.CLSID),E.mt&&(C.mt=E.mt),E.ct&&(C.ct=E.ct)),C}function Pg(w,S){A(w);var y=Pe.find(w,S);if(y){for(var E=0;E<w.FileIndex.length;++E)if(w.FileIndex[E]==y)return w.FileIndex.splice(E,1),w.FullPaths.splice(E,1),!0}return!1}function Ig(w,S,y){A(w);var E=Pe.find(w,S);if(E){for(var k=0;k<w.FileIndex.length;++k)if(w.FileIndex[k]==E)return w.FileIndex[k].name=i(y),w.FullPaths[k]=y,!0}return!1}function Dg(w){N(w,!0)}return t.find=G,t.read=L,t.parse=c,t.write=de,t.writeFile=te,t.utils={cfb_new:Ng,cfb_add:cu,cfb_del:Pg,cfb_mov:Ig,cfb_gc:Dg,ReadShift:na,CheckField:vv,prep_blob:Jt,bconcat:_t,use_zlib:O,_deflateRaw:O0,_inflateRaw:D0,consts:Me},t}();function DE(e){return typeof e=="string"?Zl(e):Array.isArray(e)?aE(e):e}function Va(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Zl(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Da(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([DE(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ha(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Tt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Rd(e,t){for(var r=[],n=Tt(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function l0(e){for(var t=[],r=Tt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function ru(e){for(var t=[],r=Tt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function LE(e){for(var t=[],r=Tt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var El=new Date(1899,11,30,0,0,0);function Gt(e,t){var r=e.getTime(),n=El.getTime()+(e.getTimezoneOffset()-El.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Zm=new Date,bE=El.getTime()+(Zm.getTimezoneOffset()-El.getTimezoneOffset())*6e4,Fd=Zm.getTimezoneOffset();function ev(e){var t=new Date;return t.setTime(e*24*60*60*1e3+bE),t.getTimezoneOffset()!==Fd&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Fd)*6e4),t}var Nd=new Date("2017-02-19T19:06:09.000Z"),tv=isNaN(Nd.getFullYear())?new Date("2/19/17"):Nd,ME=tv.getFullYear()==2017;function Mt(e,t){var r=new Date(e);if(ME)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(tv.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function nu(e,t){if(ke&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Kt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Kt(e[r]));return t}function Ye(e,t){for(var r="";r.length<t;)r+=e;return r}function Qr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var BE=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ia(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&BE.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function xe(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ke?n=un(r):n=oE(r),Pe.utils.cfb_add(e,t,n)}Pe.utils.cfb_add(e,t,r)}else e.file(t,r)}function u0(){return Pe.utils.cfb_new()}var it=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,UE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},c0=l0(UE),f0=/[&<>'"]/g,jE=/[\u0000-\u0008\u000b-\u001f]/g;function Re(e){var t=e+"";return t.replace(f0,function(r){return c0[r]}).replace(jE,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Pd(e){return Re(e).replace(/ /g,"_x0020_")}var rv=/[\u0000-\u001f]/g;function $E(e){var t=e+"";return t.replace(f0,function(r){return c0[r]}).replace(/\n/g,"<br/>").replace(rv,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function WE(e){var t=e+"";return t.replace(f0,function(r){return c0[r]}).replace(rv,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function zE(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function HE(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Gu(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Id(e){var t=ci(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Dd(e){return un(e,"binary").toString("utf8")}var Ao="foo bar baz",ra=ke&&(Dd(Ao)==Gu(Ao)&&Dd||Id(Ao)==Gu(Ao)&&Id)||Gu,Da=ke?function(e){return un(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},VE=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),nv=/(^\s|\s$|\n)/;function wt(e,t){return"<"+e+(t.match(nv)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function La(e){return Tt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Q(e,t,r){return"<"+e+(r!=null?La(r):"")+(t!=null?(t.match(nv)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function of(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function GE(e,t){switch(typeof e){case"string":var r=Q("vt:lpwstr",Re(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Q((e|0)==e?"vt:i4":"vt:r8",Re(String(e)));case"boolean":return Q("vt:bool",e?"true":"false")}if(e instanceof Date)return Q("vt:filetime",of(e));throw new Error("Unable to serialize "+e)}var ct={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},_s=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Qt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function KE(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function qE(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var Ld=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},bd=ke?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:un(t)})):Ld(e)}:Ld,Md=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Ws(e,i)));return n.join("").replace(ta,"")},h0=ke?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ta,""):Md(e,t,r)}:Md,Bd=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},iv=ke?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Bd(e,t,r)}:Bd,Ud=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Di(e,i)));return n.join("")},Ga=ke?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Ud(t,r,n)}:Ud,sv=function(e,t){var r=Zt(e,t);return r>0?Ga(e,t+4,t+4+r-1):""},av=sv,ov=function(e,t){var r=Zt(e,t);return r>0?Ga(e,t+4,t+4+r-1):""},lv=ov,uv=function(e,t){var r=2*Zt(e,t);return r>0?Ga(e,t+4,t+4+r-1):""},cv=uv,fv=function(t,r){var n=Zt(t,r);return n>0?h0(t,r+4,r+4+n):""},hv=fv,dv=function(e,t){var r=Zt(e,t);return r>0?Ga(e,t+4,t+4+r):""},pv=dv,mv=function(e,t){return KE(e,t)},Sl=mv,d0=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ke&&(av=function(t,r){if(!Buffer.isBuffer(t))return sv(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},lv=function(t,r){if(!Buffer.isBuffer(t))return ov(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},cv=function(t,r){if(!Buffer.isBuffer(t))return uv(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},hv=function(t,r){if(!Buffer.isBuffer(t))return fv(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},pv=function(t,r){if(!Buffer.isBuffer(t))return dv(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Sl=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):mv(t,r)},d0=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Di=function(e,t){return e[t]},Ws=function(e,t){return e[t+1]*256+e[t]},XE=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Zt=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Yn=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},YE=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function na(e,t){var r="",n,i,s=[],a,o,l,u;switch(t){case"dbcs":if(u=this.l,ke&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Ws(this,u)),u+=2;e*=2;break;case"utf8":r=Ga(this,this.l,this.l+e);break;case"utf16le":e*=2,r=h0(this,this.l,this.l+e);break;case"wstr":return na.call(this,e,"dbcs");case"lpstr-ansi":r=av(this,this.l),e=4+Zt(this,this.l);break;case"lpstr-cp":r=lv(this,this.l),e=4+Zt(this,this.l);break;case"lpwstr":r=cv(this,this.l),e=4+2*Zt(this,this.l);break;case"lpp4":e=4+Zt(this,this.l),r=hv(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Zt(this,this.l),r=pv(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=Di(this,this.l+e++))!==0;)s.push(So(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=Ws(this,this.l+e))!==0;)s.push(So(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Di(this,u),this.l=u+1,o=na.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(So(Ws(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Di(this,u),this.l=u+1,o=na.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(So(Di(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=Di(this,this.l),this.l++,n;case 2:return n=(t==="i"?XE:Ws)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Yn:YE)(this,this.l),this.l+=4,n):(i=Zt(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Sl(this,this.l):i=Sl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=iv(this,this.l,e);break}}return this.l+=e,r}var JE=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},QE=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},ZE=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function eS(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)ZE(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,JE(this,t,this.l);break;case 8:if(n=8,r==="f"){qE(this,t,this.l);break}case 16:break;case-4:n=4,QE(this,t,this.l);break}return this.l+=n,this}function vv(e,t){var r=iv(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Jt(e,t){e.l=t,e.read_shift=na,e.chk=vv,e.write_shift=eS}function $r(e,t){e.l+=t}function z(e){var t=ci(e);return Jt(t,0),t}function Vt(){var e=[],t=ke?256:2048,r=function(u){var c=z(u);return Jt(c,0),c},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},a=function(){return i(),_t(e)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function K(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=K3[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=e.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&d0(r)&&e.push(r)}}function ia(e,t,r){var n=Kt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function jd(e,t,r){var n=Kt(e);return n.s=ia(n.s,t.s,r),n.e=ia(n.e,t.s,r),n}function sa(e,t){if(e.cRel&&e.c<0)for(e=Kt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Kt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ne(e);return!e.cRel&&e.cRel!=null&&(r=nS(r)),!e.rRel&&e.rRel!=null&&(r=tS(r)),r}function Ku(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Rt(e.s.c)+":"+(e.e.cRel?"":"$")+Rt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Et(e.s.r)+":"+(e.e.rRel?"":"$")+Et(e.e.r):sa(e.s,t.biff)+":"+sa(e.e,t.biff)}function p0(e){return parseInt(rS(e),10)-1}function Et(e){return""+(e+1)}function tS(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function rS(e){return e.replace(/\$(\d+)$/,"$1")}function m0(e){for(var t=iS(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Rt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function nS(e){return e.replace(/^([A-Z])/,"$$$1")}function iS(e){return e.replace(/^\$([A-Z])/,"$1")}function sS(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ft(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Ne(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ir(e){var t=e.indexOf(":");return t==-1?{s:ft(e),e:ft(e)}:{s:ft(e.slice(0,t)),e:ft(e.slice(t+1))}}function nt(e,t){return typeof t>"u"||typeof t=="number"?nt(e.s,e.e):(typeof e!="string"&&(e=Ne(e)),typeof t!="string"&&(t=Ne(t)),e==t?e:e+":"+t)}function je(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function $d(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=In(e.z,r?Gt(t):t)}catch{}try{return e.w=In((e.XF||{}).numFmtId||(r?14:0),r?Gt(t):t)}catch{return""+t}}function an(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ka[e.v]||e.v:t==null?$d(e,e.v):$d(e,t))}function mi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function gv(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?ft(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var c=je(s["!ref"]);u.s.c=c.s.c,u.s.r=c.s.r,u.e.c=Math.max(u.e.c,c.e.c),u.e.r=Math.max(u.e.r,c.e.r),a==-1&&(u.e.r=a=c.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[h].length;++f)if(!(typeof t[h][f]>"u")){var d={v:t[h][f]},m=a+h,p=o+f;if(u.s.r>m&&(u.s.r=m),u.s.c>p&&(u.s.c=p),u.e.r<m&&(u.e.r=m),u.e.c<p&&(u.e.c=p),t[h][f]&&typeof t[h][f]=="object"&&!Array.isArray(t[h][f])&&!(t[h][f]instanceof Date))d=t[h][f];else if(Array.isArray(d.v)&&(d.f=t[h][f][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||Je[14],n.cellDates?(d.t="d",d.w=In(d.z,Gt(d.v))):(d.t="n",d.v=Gt(d.v),d.w=In(d.z,d.v))):d.t="s";if(i)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(d.z=s[m][p].z),s[m][p]=d;else{var _=Ne({c:p,r:m});s[_]&&s[_].z&&(d.z=s[_].z),s[_]=d}}}return u.s.c<1e7&&(s["!ref"]=nt(u)),s}function ws(e,t){return gv(null,e,t)}function aS(e){return e.read_shift(4,"i")}function Fr(e,t){return t||(t=z(4)),t.write_shift(4,e),t}function Ft(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ht(e,t){var r=!1;return t==null&&(r=!0,t=z(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function oS(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function lS(e,t){return t||(t=z(4)),t.write_shift(2,0),t.write_shift(2,0),t}function v0(e,t){var r=e.l,n=e.read_shift(1),i=Ft(e),s=[],a={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(oS(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function uS(e,t){var r=!1;return t==null&&(r=!0,t=z(15+4*e.t.length)),t.write_shift(1,0),ht(e.t,t),r?t.slice(0,t.l):t}var cS=v0;function fS(e,t){var r=!1;return t==null&&(r=!0,t=z(23+4*e.t.length)),t.write_shift(1,1),ht(e.t,t),t.write_shift(4,1),lS({},t),r?t.slice(0,t.l):t}function vr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function vi(e,t){return t==null&&(t=z(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function gi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function xi(e,t){return t==null&&(t=z(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var hS=Ft,xv=ht;function g0(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Tl(e,t){var r=!1;return t==null&&(r=!0,t=z(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var dS=Ft,lf=g0,x0=Tl;function _v(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Sl([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Yn(t,0)>>2;return r?i/100:i}function wv(e,t){t==null&&(t=z(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function yv(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function pS(e,t){return t||(t=z(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var _i=yv,ys=pS;function Es(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function fi(e,t){return(t||z(8)).write_shift(8,e,"f")}function mS(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=TS[i];u&&(t.rgb=Qd(u));break;case 2:t.rgb=Qd([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function kl(e,t){if(t||(t=z(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function vS(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function gS(e,t){t||(t=z(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Ev=2,Xt=3,Co=11,Al=19,Oo=64,xS=65,_S=71,wS=4108,yS=4126,xt=80,Wd={1:{n:"CodePage",t:Ev},2:{n:"Category",t:xt},3:{n:"PresentationFormat",t:xt},4:{n:"ByteCount",t:Xt},5:{n:"LineCount",t:Xt},6:{n:"ParagraphCount",t:Xt},7:{n:"SlideCount",t:Xt},8:{n:"NoteCount",t:Xt},9:{n:"HiddenCount",t:Xt},10:{n:"MultimediaClipCount",t:Xt},11:{n:"ScaleCrop",t:Co},12:{n:"HeadingPairs",t:wS},13:{n:"TitlesOfParts",t:yS},14:{n:"Manager",t:xt},15:{n:"Company",t:xt},16:{n:"LinksUpToDate",t:Co},17:{n:"CharacterCount",t:Xt},19:{n:"SharedDoc",t:Co},22:{n:"HyperlinksChanged",t:Co},23:{n:"AppVersion",t:Xt,p:"version"},24:{n:"DigSig",t:xS},26:{n:"ContentType",t:xt},27:{n:"ContentStatus",t:xt},28:{n:"Language",t:xt},29:{n:"Version",t:xt},255:{},2147483648:{n:"Locale",t:Al},2147483651:{n:"Behavior",t:Al},1919054434:{}},zd={1:{n:"CodePage",t:Ev},2:{n:"Title",t:xt},3:{n:"Subject",t:xt},4:{n:"Author",t:xt},5:{n:"Keywords",t:xt},6:{n:"Comments",t:xt},7:{n:"Template",t:xt},8:{n:"LastAuthor",t:xt},9:{n:"RevNumber",t:xt},10:{n:"EditTime",t:Oo},11:{n:"LastPrinted",t:Oo},12:{n:"CreatedDate",t:Oo},13:{n:"ModifiedDate",t:Oo},14:{n:"PageCount",t:Xt},15:{n:"WordCount",t:Xt},16:{n:"CharCount",t:Xt},17:{n:"Thumbnail",t:_S},18:{n:"Application",t:xt},19:{n:"DocSecurity",t:Xt},255:{},2147483648:{n:"Locale",t:Al},2147483651:{n:"Behavior",t:Al},1919054434:{}};function ES(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var SS=ES([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),TS=Kt(SS),Ka={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},kS={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ro={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Sv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Tv(e,t){var r=LE(kS),n=[],i;n[n.length]=it,n[n.length]=Q("Types",null,{xmlns:ct.CT,"xmlns:xsd":ct.xsd,"xmlns:xsi":ct.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Q("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=Q("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Ro[l][t.bookType]||Ro[l].xlsx}))},a=function(l){(e[l]||[]).forEach(function(u){n[n.length]=Q("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Ro[l][t.bookType]||Ro[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(u){n[n.length]=Q("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Se={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function kv(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ns(e){var t=[it,Q("Relationships",null,{xmlns:ct.RELS})];return Tt(e["!id"]).forEach(function(r){t[t.length]=Q("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Oe(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Se.HLINK,Se.XPATH,Se.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function AS(e){var t=[it];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Hd(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function CS(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function OS(e){var t=[it];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Hd(e[r][0],e[r][1])),t.push(CS("",e[r][0]));return t.push(Hd("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Av(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+gl.version+"</meta:generator></office:meta></office:document-meta>"}var ni=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function qu(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Re(t),n[n.length]=r?Q(e,t,r):wt(e,t))}function Cv(e,t){var r=t||{},n=[it,Q("cp:coreProperties",null,{"xmlns:cp":ct.CORE_PROPS,"xmlns:dc":ct.dc,"xmlns:dcterms":ct.dcterms,"xmlns:dcmitype":ct.dcmitype,"xmlns:xsi":ct.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&qu("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:of(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&qu("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:of(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=ni.length;++s){var a=ni[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&qu(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var is=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Ov=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Rv(e){var t=[],r=Q;return e||(e={}),e.Application="SheetJS",t[t.length]=it,t[t.length]=Q("Properties",null,{xmlns:ct.EXT_PROPS,"xmlns:vt":ct.vt}),is.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Re(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Re(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Fv(e){var t=[it,Q("Properties",null,{xmlns:ct.CUST_PROPS,"xmlns:vt":ct.vt})];if(!e)return t.join("");var r=1;return Tt(e).forEach(function(i){++r,t[t.length]=Q("property",GE(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Re(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Vd={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function RS(e,t){var r=[];return Tt(Vd).map(function(n){for(var i=0;i<ni.length;++i)if(ni[i][1]==n)return ni[i];for(i=0;i<is.length;++i)if(is[i][1]==n)return is[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(wt(Vd[n[1]]||n[1],i))}}),Q("DocumentProperties",r.join(""),{xmlns:Qt.o})}function FS(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Tt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var a=0;a<ni.length;++a)if(s==ni[a][1])return;for(a=0;a<is.length;++a)if(s==is[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Q(Pd(s),o,{"dt:dt":l}))}}),t&&Tt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Q(Pd(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Qt.o+'">'+i.join("")+"</"+n+">"}function NS(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=z(8);return a.write_shift(4,n),a.write_shift(4,i),a}function Gd(e,t){var r=z(4),n=z(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=z(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=NS(t);break;case 31:case 80:for(n=z(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return _t([r,n])}var Nv=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function PS(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Kd(e,t,r){var n=z(8),i=[],s=[],a=8,o=0,l=z(8),u=z(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!t){u=z(8),u.write_shift(4,0),i.unshift(u);var c=[z(4)];for(c[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(l=z(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);c.push(l)}l=_t(c),s.unshift(l),a+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Nv.indexOf(e[o][0])>-1||Ov.indexOf(e[o][0])>-1)&&e[o][1]!=null){var f=e[o][1],d=0;if(t){d=+t[e[o][0]];var m=r[d];if(m.p=="version"&&typeof f=="string"){var p=f.split(".");f=(+p[0]<<16)+(+p[1]||0)}l=Gd(m.t,f)}else{var _=PS(f);_==-1&&(_=31,f=String(f)),l=Gd(_,f)}s.push(l),u=z(8),u.write_shift(4,t?d:2+o),i.push(u),a+=8+l.length}var x=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,x),x+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),_t([n].concat(i).concat(s))}function qd(e,t,r,n,i,s){var a=z(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Pe.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var l=Kd(e,r,n);if(o.push(l),i){var u=Kd(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return _t(o)}function IS(e,t){t||(t=z(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function DS(e,t){return e.read_shift(t)===1}function Lt(e,t){return t||(t=z(2)),t.write_shift(2,+!!e),t}function Pv(e){return e.read_shift(2,"u")}function ur(e,t){return t||(t=z(2)),t.write_shift(2,e),t}function Iv(e,t,r){return r||(r=z(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Dv(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function LS(e){var t=e.t||"",r=z(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=z(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return _t(i)}function bS(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function MS(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):bS(e,n,r)}function BS(e,t,r){if(r.biff>5)return MS(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Lv(e,t,r){return r||(r=z(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Xd(e,t){t||(t=z(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function US(e){var t=z(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(s==28)n=n.slice(1),Xd(n,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&Xd(i>-1?n.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function hi(e,t,r,n){return n||(n=z(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function jS(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function $S(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function bv(e,t){return t||(t=z(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function _0(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=z(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function WS(e,t){var r=!t||t.biff==8,n=z(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function zS(e,t){var r=!t||t.biff>=8?2:1,n=z(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function HS(e,t){var r=z(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=LS(e[i]);var s=_t([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function VS(){var e=z(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function GS(e){var t=z(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function KS(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=z(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function qS(e,t,r,n){var i=z(10);return hi(e,t,n,i),i.write_shift(4,r),i}function XS(e,t,r,n,i){var s=!i||i.biff==8,a=z(8+ +s+(1+s)*r.length);return hi(e,t,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function YS(e,t,r,n){var i=r&&r.biff==5;n||(n=z(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function JS(e,t){var r=t.biff==8||!t.biff?4:2,n=z(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Yd(e,t,r,n){var i=r&&r.biff==5;n||(n=z(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function QS(e){var t=z(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function ZS(e,t,r,n,i,s){var a=z(8);return hi(e,t,n,a),Iv(r,s,a),a}function eT(e,t,r,n){var i=z(14);return hi(e,t,n,i),fi(r,i),i}function tT(e,t,r){if(r.biff<8)return rT(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(jS(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function rT(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Dv(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function nT(e){var t=z(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)bv(e[r],t);return t}function iT(e){var t=z(24),r=ft(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return _t([t,US(e[1])])}function sT(e){var t=e[1].Tooltip,r=z(10+2*(t.length+1));r.write_shift(2,2048);var n=ft(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function aT(e){return e||(e=z(4)),e.write_shift(2,1),e.write_shift(2,1),e}function oT(e,t,r){if(!r.cellStyles)return $r(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function lT(e,t){var r=z(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function uT(e){for(var t=z(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function cT(e,t,r){var n=z(15);return Xa(n,e,t),n.write_shift(8,r,"f"),n}function fT(e,t,r){var n=z(9);return Xa(n,e,t),n.write_shift(2,r),n}var hT=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=l0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],c=ci(1);switch(l.type){case"base64":c=Ar(sn(o));break;case"binary":c=Ar(o);break;case"buffer":case"array":c=o;break}Jt(c,0);var h=c.read_shift(1),f=!!(h&136),d=!1,m=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,f=!0;break;case 49:d=!0,f=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var p=0,_=521;h==2&&(p=c.read_shift(2)),c.l+=3,h!=2&&(p=c.read_shift(4)),p>1048576&&(p=1e6),h!=2&&(_=c.read_shift(2));var x=c.read_shift(2),v=l.codepage||1252;h!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(v=e[c[c.l]]),c.l+=1,c.l+=2),m&&(c.l+=36);for(var g=[],T={},I=Math.min(c.length,h==2?521:_-10-(d?264:0)),L=m?32:11;c.l<I&&c[c.l]!=13;)switch(T={},T.name=xl.utils.decode(v,c.slice(c.l,c.l+L)).replace(/[\u0000\r\n].*$/g,""),c.l+=L,T.type=String.fromCharCode(c.read_shift(1)),h!=2&&!m&&(T.offset=c.read_shift(4)),T.len=c.read_shift(1),h==2&&(T.offset=c.read_shift(2)),T.dec=c.read_shift(1),T.name.length&&g.push(T),h!=2&&(c.l+=m?13:14),T.type){case"B":(!d||T.len!=8)&&l.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(c[c.l]!==13&&(c.l=_-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=_;var A=0,P=0;for(u[0]=[],P=0;P!=g.length;++P)u[0][P]=g[P].name;for(;p-- >0;){if(c[c.l]===42){c.l+=x;continue}for(++c.l,u[++A]=[],P=0,P=0;P!=g.length;++P){var N=c.slice(c.l,c.l+g[P].len);c.l+=g[P].len,Jt(N,0);var W=xl.utils.decode(v,N);switch(g[P].type){case"C":W.trim().length&&(u[A][P]=W.replace(/\s+$/,""));break;case"D":W.length===8?u[A][P]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):u[A][P]=W;break;case"F":u[A][P]=parseFloat(W.trim());break;case"+":case"I":u[A][P]=m?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":u[A][P]=!0;break;case"N":case"F":u[A][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[A][P]="##MEMO##"+(m?parseInt(W.trim(),10):N.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(u[A][P]=+W||0);break;case"@":u[A][P]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":u[A][P]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":u[A][P]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[A][P]=-N.read_shift(-8,"f");break;case"B":if(d&&g[P].len==8){u[A][P]=N.read_shift(8,"f");break}case"G":case"P":N.l+=g[P].len;break;case"0":if(g[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[P].type)}}}if(h!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=g,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var c=ws(r(o,u),u);return c["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,c}function i(o,l){try{return mi(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&Na(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var c=Vt(),h=Nl(o,{header:1,raw:!0,cellDates:!0}),f=h[0],d=h.slice(1),m=o["!cols"]||[],p=0,_=0,x=0,v=1;for(p=0;p<f.length;++p){if(((m[p]||{}).DBF||{}).name){f[p]=m[p].DBF.name,++x;continue}if(f[p]!=null){if(++x,typeof f[p]=="number"&&(f[p]=f[p].toString(10)),typeof f[p]!="string")throw new Error("DBF Invalid column name "+f[p]+" |"+typeof f[p]+"|");if(f.indexOf(f[p])!==p){for(_=0;_<1024;++_)if(f.indexOf(f[p]+"_"+_)==-1){f[p]+="_"+_;break}}}}var g=je(o["!ref"]),T=[],I=[],L=[];for(p=0;p<=g.e.c-g.s.c;++p){var A="",P="",N=0,W=[];for(_=0;_<d.length;++_)d[_][p]!=null&&W.push(d[_][p]);if(W.length==0||f[p]==null){T[p]="?";continue}for(_=0;_<W.length;++_){switch(typeof W[_]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=W[_]instanceof Date?"D":"C";break;default:P="C"}N=Math.max(N,String(W[_]).length),A=A&&A!=P?"C":P}N>250&&(N=250),P=((m[p]||{}).DBF||{}).type,P=="C"&&m[p].DBF.len>N&&(N=m[p].DBF.len),A=="B"&&P=="N"&&(A="N",L[p]=m[p].DBF.dec,N=m[p].DBF.len),I[p]=A=="C"||P=="N"?N:s[A]||0,v+=I[p],T[p]=A}var G=c.next(32);for(G.write_shift(4,318902576),G.write_shift(4,d.length),G.write_shift(2,296+32*x),G.write_shift(2,v),p=0;p<4;++p)G.write_shift(4,0);for(G.write_shift(4,0|(+t[Bm]||3)<<8),p=0,_=0;p<f.length;++p)if(f[p]!=null){var q=c.next(32),re=(f[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);q.write_shift(1,re,"sbcs"),q.write_shift(1,T[p]=="?"?"C":T[p],"sbcs"),q.write_shift(4,_),q.write_shift(1,I[p]||s[T[p]]||0),q.write_shift(1,L[p]||0),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(1,0),q.write_shift(4,0),q.write_shift(4,0),_+=I[p]||s[T[p]]||0}var Te=c.next(264);for(Te.write_shift(4,13),p=0;p<65;++p)Te.write_shift(4,0);for(p=0;p<d.length;++p){var ve=c.next(v);for(ve.write_shift(1,0),_=0;_<f.length;++_)if(f[_]!=null)switch(T[_]){case"L":ve.write_shift(1,d[p][_]==null?63:d[p][_]?84:70);break;case"B":ve.write_shift(8,d[p][_]||0,"f");break;case"N":var Qe="0";for(typeof d[p][_]=="number"&&(Qe=d[p][_].toFixed(L[_]||0)),x=0;x<I[_]-Qe.length;++x)ve.write_shift(1,32);ve.write_shift(1,Qe,"sbcs");break;case"D":d[p][_]?(ve.write_shift(4,("0000"+d[p][_].getFullYear()).slice(-4),"sbcs"),ve.write_shift(2,("00"+(d[p][_].getMonth()+1)).slice(-2),"sbcs"),ve.write_shift(2,("00"+d[p][_].getDate()).slice(-2),"sbcs")):ve.write_shift(8,"00000000","sbcs");break;case"C":var Me=String(d[p][_]!=null?d[p][_]:"").slice(0,I[_]);for(ve.write_shift(1,Me,"sbcs"),x=0;x<I[_]-Me.length;++x)ve.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),dT=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Tt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,d){var m=e[d];return typeof m=="number"?wd(m):m},n=function(f,d,m){var p=d.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?f:wd(p)};e["|"]=254;function i(f,d){switch(d.type){case"base64":return s(sn(f),d);case"binary":return s(f,d);case"buffer":return s(ke&&Buffer.isBuffer(f)?f.toString("binary"):Ha(f),d);case"array":return s(nu(f),d)}throw new Error("Unrecognized type "+d.type)}function s(f,d){var m=f.split(/[\n\r]+/),p=-1,_=-1,x=0,v=0,g=[],T=[],I=null,L={},A=[],P=[],N=[],W=0,G;for(+d.codepage>=0&&Na(+d.codepage);x!==m.length;++x){W=0;var q=m[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),re=q.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),Te=re[0],ve;if(q.length>0)switch(Te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":re[1].charAt(0)=="P"&&T.push(q.slice(3).replace(/;;/g,";"));break;case"C":var Qe=!1,Me=!1,te=!1,ce=!1,de=-1,we=-1;for(v=1;v<re.length;++v)switch(re[v].charAt(0)){case"A":break;case"X":_=parseInt(re[v].slice(1))-1,Me=!0;break;case"Y":for(p=parseInt(re[v].slice(1))-1,Me||(_=0),G=g.length;G<=p;++G)g[G]=[];break;case"K":ve=re[v].slice(1),ve.charAt(0)==='"'?ve=ve.slice(1,ve.length-1):ve==="TRUE"?ve=!0:ve==="FALSE"?ve=!1:isNaN(Qr(ve))?isNaN(Ia(ve).getDate())||(ve=Mt(ve)):(ve=Qr(ve),I!==null&&Ym(I)&&(ve=ev(ve))),Qe=!0;break;case"E":ce=!0;var O=f4(re[v].slice(1),{r:p,c:_});g[p][_]=[g[p][_],O];break;case"S":te=!0,g[p][_]=[g[p][_],"S5S"];break;case"G":break;case"R":de=parseInt(re[v].slice(1))-1;break;case"C":we=parseInt(re[v].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+q)}if(Qe&&(g[p][_]&&g[p][_].length==2?g[p][_][0]=ve:g[p][_]=ve,I=null),te){if(ce)throw new Error("SYLK shared formula cannot have own formula");var U=de>-1&&g[de][we];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");g[p][_][1]=h4(U[1],{r:p-de,c:_-we})}break;case"F":var F=0;for(v=1;v<re.length;++v)switch(re[v].charAt(0)){case"X":_=parseInt(re[v].slice(1))-1,++F;break;case"Y":for(p=parseInt(re[v].slice(1))-1,G=g.length;G<=p;++G)g[G]=[];break;case"M":W=parseInt(re[v].slice(1))/20;break;case"F":break;case"G":break;case"P":I=T[parseInt(re[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=re[v].slice(1).split(" "),G=parseInt(N[0],10);G<=parseInt(N[1],10);++G)W=parseInt(N[2],10),P[G-1]=W===0?{hidden:!0}:{wch:W},w0(P[G-1]);break;case"C":_=parseInt(re[v].slice(1))-1,P[_]||(P[_]={});break;case"R":p=parseInt(re[v].slice(1))-1,A[p]||(A[p]={}),W>0?(A[p].hpt=W,A[p].hpx=$v(W)):W===0&&(A[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+q)}F<1&&(I=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+q)}}return A.length>0&&(L["!rows"]=A),P.length>0&&(L["!cols"]=P),d&&d.sheetRows&&(g=g.slice(0,d.sheetRows)),[g,L]}function a(f,d){var m=i(f,d),p=m[0],_=m[1],x=ws(p,d);return Tt(_).forEach(function(v){x[v]=_[v]}),x}function o(f,d){return mi(a(f,d),d)}function l(f,d,m,p){var _="C;Y"+(m+1)+";X"+(p+1)+";K";switch(f.t){case"n":_+=f.v||0,f.f&&!f.F&&(_+=";E"+E0(f.f,{r:m,c:p}));break;case"b":_+=f.v?"TRUE":"FALSE";break;case"e":_+=f.w||f.v;break;case"d":_+='"'+(f.w||f.v)+'"';break;case"s":_+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function u(f,d){d.forEach(function(m,p){var _="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?_+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Cl(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Ol(m.wpx)),typeof m.wch=="number"&&(_+=Math.round(m.wch))),_.charAt(_.length-1)!=" "&&f.push(_)})}function c(f,d){d.forEach(function(m,p){var _="F;";m.hidden?_+="M0;":m.hpt?_+="M"+20*m.hpt+";":m.hpx&&(_+="M"+20*Rl(m.hpx)+";"),_.length>2&&f.push(_+"R"+(p+1))})}function h(f,d){var m=["ID;PWXL;N;E"],p=[],_=je(f["!ref"]),x,v=Array.isArray(f),g=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),f["!cols"]&&u(m,f["!cols"]),f["!rows"]&&c(m,f["!rows"]),m.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var T=_.s.r;T<=_.e.r;++T)for(var I=_.s.c;I<=_.e.c;++I){var L=Ne({r:T,c:I});x=v?(f[T]||[])[I]:f[L],!(!x||x.v==null&&(!x.f||x.F))&&p.push(l(x,f,T,I))}return m.join(g)+g+p.join(g)+g+"E"+g}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),pT=function(){function e(s,a){switch(a.type){case"base64":return t(sn(s),a);case"binary":return t(s,a);case"buffer":return t(ke&&Buffer.isBuffer(s)?s.toString("binary"):Ha(s),a);case"array":return t(nu(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,u=-1,c=0,h=[];c!==o.length;++c){if(o[c].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var f=o[c].trim().split(","),d=f[0],m=f[1];++c;for(var p=o[c]||"";(p.match(/["]/g)||[]).length&1&&c<o.length-1;)p+=`
`+o[++c];switch(p=p.trim(),+d){case-1:if(p==="BOT"){h[++l]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?h[l][u]=!0:p==="FALSE"?h[l][u]=!1:isNaN(Qr(m))?isNaN(Ia(m).getDate())?h[l][u]=m:h[l][u]=Mt(m):h[l][u]=Qr(m),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),h[l][u++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return ws(e(s,a),a)}function n(s,a){return mi(r(s,a),a)}var i=function(){var s=function(l,u,c,h,f){l.push(u),l.push(c+","+h),l.push('"'+f.replace(/"/g,'""')+'"')},a=function(l,u,c,h){l.push(u+","+c),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],c=je(l["!ref"]),h,f=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,c.e.r-c.s.r+1,""),s(u,"TUPLES",0,c.e.c-c.s.c+1,""),s(u,"DATA",0,0,"");for(var d=c.s.r;d<=c.e.r;++d){a(u,-1,0,"BOT");for(var m=c.s.c;m<=c.e.c;++m){var p=Ne({r:d,c:m});if(h=f?(l[d]||[])[m]:l[p],!h){a(u,1,0,"");continue}switch(h.t){case"n":var _=h.w;!_&&h.v!=null&&(_=h.v),_==null?h.f&&!h.F?a(u,1,0,"="+h.f):a(u,1,0,""):a(u,0,_,"V");break;case"b":a(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=In(h.z||Je[14],Gt(Mt(h.v)))),a(u,0,h.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var x=`\r
`,v=u.join(x);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),Mv=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,f){for(var d=h.split(`
`),m=-1,p=-1,_=0,x=[];_!==d.length;++_){var v=d[_].trim().split(":");if(v[0]==="cell"){var g=ft(v[1]);if(x.length<=g.r)for(m=x.length;m<=g.r;++m)x[m]||(x[m]=[]);switch(m=g.r,p=g.c,v[2]){case"t":x[m][p]=e(v[3]);break;case"v":x[m][p]=+v[3];break;case"vtf":var T=v[v.length-1];case"vtc":switch(v[3]){case"nl":x[m][p]=!!+v[4];break;default:x[m][p]=+v[4];break}v[2]=="vtf"&&(x[m][p]=[x[m][p],T])}}}return f&&f.sheetRows&&(x=x.slice(0,f.sheetRows)),x}function n(h,f){return ws(r(h,f),f)}function i(h,f){return mi(n(h,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var f=[],d=[],m,p="",_=ir(h["!ref"]),x=Array.isArray(h),v=_.s.r;v<=_.e.r;++v)for(var g=_.s.c;g<=_.e.c;++g)if(p=Ne({r:v,c:g}),m=x?(h[v]||[])[g]:h[p],!(!m||m.v==null||m.t==="z")){switch(d=["cell",p,"t"],m.t){case"s":case"str":d.push(t(m.v));break;case"n":m.f?(d[2]="vtf",d[3]="n",d[4]=m.v,d[5]=t(m.f)):(d[2]="v",d[3]=m.v);break;case"b":d[2]="vt"+(m.f?"f":"c"),d[3]="nl",d[4]=m.v?"1":"0",d[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var T=Gt(Mt(m.v));d[2]="vtc",d[3]="nd",d[4]=""+T,d[5]=m.w||In(m.z||Je[14],T);break;case"e":continue}f.push(d.join(":"))}return f.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function c(h){return[s,a,o,a,u(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:c}}(),mT=function(){function e(c,h,f,d,m){m.raw?h[f][d]=c:c===""||(c==="TRUE"?h[f][d]=!0:c==="FALSE"?h[f][d]=!1:isNaN(Qr(c))?isNaN(Ia(c).getDate())?h[f][d]=c:h[f][d]=Mt(c):h[f][d]=Qr(c))}function t(c,h){var f=h||{},d=[];if(!c||c.length===0)return d;for(var m=c.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var _=10,x=0,v=0;v<=p;++v)x=m[v].indexOf(" "),x==-1?x=m[v].length:x++,_=Math.max(_,x);for(v=0;v<=p;++v){d[v]=[];var g=0;for(e(m[v].slice(0,_).trim(),d,v,g,f),g=1;g<=(m[v].length-_)/10+1;++g)e(m[v].slice(_+(g-1)*10,_+g*10).trim(),d,v,g,f)}return f.sheetRows&&(d=d.slice(0,f.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(c){for(var h={},f=!1,d=0,m=0;d<c.length;++d)(m=c.charCodeAt(d))==34?f=!f:!f&&m in r&&(h[m]=(h[m]||0)+1);m=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&m.push([h[d],d]);if(!m.length){h=n;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&m.push([h[d],d])}return m.sort(function(p,_){return p[0]-_[0]||n[p[1]]-n[_[1]]}),r[m.pop()[1]]||44}function s(c,h){var f=h||{},d="",m=f.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(d=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(d=c.charAt(4),c=c.slice(6)):d=i(c.slice(0,1024)):f&&f.FS?d=f.FS:d=i(c.slice(0,1024));var _=0,x=0,v=0,g=0,T=0,I=d.charCodeAt(0),L=!1,A=0,P=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var N=f.dateNF!=null?NE(f.dateNF):null;function W(){var G=c.slice(g,T),q={};if(G.charAt(0)=='"'&&G.charAt(G.length-1)=='"'&&(G=G.slice(1,-1).replace(/""/g,'"')),G.length===0)q.t="z";else if(f.raw)q.t="s",q.v=G;else if(G.trim().length===0)q.t="s",q.v=G;else if(G.charCodeAt(0)==61)G.charCodeAt(1)==34&&G.charCodeAt(G.length-1)==34?(q.t="s",q.v=G.slice(2,-1).replace(/""/g,'"')):d4(G)?(q.t="n",q.f=G.slice(1)):(q.t="s",q.v=G);else if(G=="TRUE")q.t="b",q.v=!0;else if(G=="FALSE")q.t="b",q.v=!1;else if(!isNaN(v=Qr(G)))q.t="n",f.cellText!==!1&&(q.w=G),q.v=v;else if(!isNaN(Ia(G).getDate())||N&&G.match(N)){q.z=f.dateNF||Je[14];var re=0;N&&G.match(N)&&(G=PE(G,f.dateNF,G.match(N)||[]),re=1),f.cellDates?(q.t="d",q.v=Mt(G,re)):(q.t="n",q.v=Gt(Mt(G,re))),f.cellText!==!1&&(q.w=In(q.z,q.v instanceof Date?Gt(q.v):q.v)),f.cellNF||delete q.z}else q.t="s",q.v=G;if(q.t=="z"||(f.dense?(m[_]||(m[_]=[]),m[_][x]=q):m[Ne({c:x,r:_})]=q),g=T+1,P=c.charCodeAt(g),p.e.c<x&&(p.e.c=x),p.e.r<_&&(p.e.r=_),A==I)++x;else if(x=0,++_,f.sheetRows&&f.sheetRows<=_)return!0}e:for(;T<c.length;++T)switch(A=c.charCodeAt(T)){case 34:P===34&&(L=!L);break;case I:case 10:case 13:if(!L&&W())break e;break}return T-g>0&&W(),m["!ref"]=nt(p),m}function a(c,h){return!(h&&h.PRN)||h.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?s(c,h):ws(t(c,h),h)}function o(c,h){var f="",d=h.type=="string"?[0,0,0,0]:CC(c,h);switch(h.type){case"base64":f=sn(c);break;case"binary":f=c;break;case"buffer":h.codepage==65001?f=c.toString("utf8"):h.codepage&&typeof xl<"u"||(f=ke&&Buffer.isBuffer(c)?c.toString("binary"):Ha(c));break;case"array":f=nu(c);break;case"string":f=c;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?f=ra(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=ra(f):h.type=="binary"&&typeof xl<"u",f.slice(0,19)=="socialcalc:version:"?Mv.to_sheet(h.type=="string"?f:ra(f),h):a(f,h)}function l(c,h){return mi(o(c,h),h)}function u(c){for(var h=[],f=je(c["!ref"]),d,m=Array.isArray(c),p=f.s.r;p<=f.e.r;++p){for(var _=[],x=f.s.c;x<=f.e.c;++x){var v=Ne({r:p,c:x});if(d=m?(c[p]||[])[x]:c[v],!d||d.v==null){_.push("          ");continue}for(var g=(d.w||(an(d),d.w)||"").slice(0,10);g.length<10;)g+=" ";_.push(g+(x===0?" ":""))}h.push(_.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}(),Jd=function(){function e(O,U,F){if(O){Jt(O,O.l||0);for(var R=F.Enum||de;O.l<O.length;){var V=O.read_shift(2),oe=R[V]||R[65535],he=O.read_shift(2),ue=O.l+he,ne=oe.f&&oe.f(O,he,F);if(O.l=ue,U(ne,oe,V))return}}}function t(O,U){switch(U.type){case"base64":return r(Ar(sn(O)),U);case"binary":return r(Ar(O),U);case"buffer":case"array":return r(O,U)}throw"Unsupported type "+U.type}function r(O,U){if(!O)return O;var F=U||{},R=F.dense?[]:{},V="Sheet1",oe="",he=0,ue={},ne=[],Ie=[],ye={s:{r:0,c:0},e:{r:0,c:0}},Pt=F.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)F.Enum=de,e(O,function(le,or,zr){switch(zr){case 0:F.vers=le,le>=4096&&(F.qpro=!0);break;case 6:ye=le;break;case 204:le&&(oe=le);break;case 222:oe=le;break;case 15:case 51:F.qpro||(le[1].v=le[1].v.slice(1));case 13:case 14:case 16:zr==14&&(le[2]&112)==112&&(le[2]&15)>1&&(le[2]&15)<15&&(le[1].z=F.dateNF||Je[14],F.cellDates&&(le[1].t="d",le[1].v=ev(le[1].v))),F.qpro&&le[3]>he&&(R["!ref"]=nt(ye),ue[V]=R,ne.push(V),R=F.dense?[]:{},ye={s:{r:0,c:0},e:{r:0,c:0}},he=le[3],V=oe||"Sheet"+(he+1),oe="");var jn=F.dense?(R[le[0].r]||[])[le[0].c]:R[Ne(le[0])];if(jn){jn.t=le[1].t,jn.v=le[1].v,le[1].z!=null&&(jn.z=le[1].z),le[1].f!=null&&(jn.f=le[1].f);break}F.dense?(R[le[0].r]||(R[le[0].r]=[]),R[le[0].r][le[0].c]=le[1]):R[Ne(le[0])]=le[1];break}},F);else if(O[2]==26||O[2]==14)F.Enum=we,O[2]==14&&(F.qpro=!0,O.l=0),e(O,function(le,or,zr){switch(zr){case 204:V=le;break;case 22:le[1].v=le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(le[3]>he&&(R["!ref"]=nt(ye),ue[V]=R,ne.push(V),R=F.dense?[]:{},ye={s:{r:0,c:0},e:{r:0,c:0}},he=le[3],V="Sheet"+(he+1)),Pt>0&&le[0].r>=Pt)break;F.dense?(R[le[0].r]||(R[le[0].r]=[]),R[le[0].r][le[0].c]=le[1]):R[Ne(le[0])]=le[1],ye.e.c<le[0].c&&(ye.e.c=le[0].c),ye.e.r<le[0].r&&(ye.e.r=le[0].r);break;case 27:le[14e3]&&(Ie[le[14e3][0]]=le[14e3][1]);break;case 1537:Ie[le[0]]=le[1],le[0]==he&&(V=le[1]);break}},F);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(R["!ref"]=nt(ye),ue[oe||V]=R,ne.push(oe||V),!Ie.length)return{SheetNames:ne,Sheets:ue};for(var Ae={},Wr=[],Ke=0;Ke<Ie.length;++Ke)ue[ne[Ke]]?(Wr.push(Ie[Ke]||ne[Ke]),Ae[Ie[Ke]]=ue[Ie[Ke]]||ue[ne[Ke]]):(Wr.push(Ie[Ke]),Ae[Ie[Ke]]={"!ref":"A1"});return{SheetNames:Wr,Sheets:Ae}}function n(O,U){var F=U||{};if(+F.codepage>=0&&Na(+F.codepage),F.type=="string")throw new Error("Cannot write WK1 to JS string");var R=Vt(),V=je(O["!ref"]),oe=Array.isArray(O),he=[];Z(R,0,s(1030)),Z(R,6,l(V));for(var ue=Math.min(V.e.r,8191),ne=V.s.r;ne<=ue;++ne)for(var Ie=Et(ne),ye=V.s.c;ye<=V.e.c;++ye){ne===V.s.r&&(he[ye]=Rt(ye));var Pt=he[ye]+Ie,Ae=oe?(O[ne]||[])[ye]:O[Pt];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?Z(R,13,d(ne,ye,Ae.v)):Z(R,14,p(ne,ye,Ae.v));else{var Wr=an(Ae);Z(R,15,h(ne,ye,Wr.slice(0,239)))}}return Z(R,1),R.end()}function i(O,U){var F=U||{};if(+F.codepage>=0&&Na(+F.codepage),F.type=="string")throw new Error("Cannot write WK3 to JS string");var R=Vt();Z(R,0,a(O));for(var V=0,oe=0;V<O.SheetNames.length;++V)(O.Sheets[O.SheetNames[V]]||{})["!ref"]&&Z(R,27,ce(O.SheetNames[V],oe++));var he=0;for(V=0;V<O.SheetNames.length;++V){var ue=O.Sheets[O.SheetNames[V]];if(!(!ue||!ue["!ref"])){for(var ne=je(ue["!ref"]),Ie=Array.isArray(ue),ye=[],Pt=Math.min(ne.e.r,8191),Ae=ne.s.r;Ae<=Pt;++Ae)for(var Wr=Et(Ae),Ke=ne.s.c;Ke<=ne.e.c;++Ke){Ae===ne.s.r&&(ye[Ke]=Rt(Ke));var le=ye[Ke]+Wr,or=Ie?(ue[Ae]||[])[Ke]:ue[le];if(!(!or||or.t=="z"))if(or.t=="n")Z(R,23,W(Ae,Ke,he,or.v));else{var zr=an(or);Z(R,22,A(Ae,Ke,he,zr.slice(0,239)))}}++he}}return Z(R,1),R.end()}function s(O){var U=z(2);return U.write_shift(2,O),U}function a(O){var U=z(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var F=0,R=0,V=0,oe=0;oe<O.SheetNames.length;++oe){var he=O.SheetNames[oe],ue=O.Sheets[he];if(!(!ue||!ue["!ref"])){++V;var ne=ir(ue["!ref"]);F<ne.e.r&&(F=ne.e.r),R<ne.e.c&&(R=ne.e.c)}}return F>8191&&(F=8191),U.write_shift(2,F),U.write_shift(1,V),U.write_shift(1,R),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(O,U,F){var R={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&F.qpro?(R.s.c=O.read_shift(1),O.l++,R.s.r=O.read_shift(2),R.e.c=O.read_shift(1),O.l++,R.e.r=O.read_shift(2),R):(R.s.c=O.read_shift(2),R.s.r=O.read_shift(2),U==12&&F.qpro&&(O.l+=2),R.e.c=O.read_shift(2),R.e.r=O.read_shift(2),U==12&&F.qpro&&(O.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function l(O){var U=z(8);return U.write_shift(2,O.s.c),U.write_shift(2,O.s.r),U.write_shift(2,O.e.c),U.write_shift(2,O.e.r),U}function u(O,U,F){var R=[{c:0,r:0},{t:"n",v:0},0,0];return F.qpro&&F.vers!=20768?(R[0].c=O.read_shift(1),R[3]=O.read_shift(1),R[0].r=O.read_shift(2),O.l+=2):(R[2]=O.read_shift(1),R[0].c=O.read_shift(2),R[0].r=O.read_shift(2)),R}function c(O,U,F){var R=O.l+U,V=u(O,U,F);if(V[1].t="s",F.vers==20768){O.l++;var oe=O.read_shift(1);return V[1].v=O.read_shift(oe,"utf8"),V}return F.qpro&&O.l++,V[1].v=O.read_shift(R-O.l,"cstr"),V}function h(O,U,F){var R=z(7+F.length);R.write_shift(1,255),R.write_shift(2,U),R.write_shift(2,O),R.write_shift(1,39);for(var V=0;V<R.length;++V){var oe=F.charCodeAt(V);R.write_shift(1,oe>=128?95:oe)}return R.write_shift(1,0),R}function f(O,U,F){var R=u(O,U,F);return R[1].v=O.read_shift(2,"i"),R}function d(O,U,F){var R=z(7);return R.write_shift(1,255),R.write_shift(2,U),R.write_shift(2,O),R.write_shift(2,F,"i"),R}function m(O,U,F){var R=u(O,U,F);return R[1].v=O.read_shift(8,"f"),R}function p(O,U,F){var R=z(13);return R.write_shift(1,255),R.write_shift(2,U),R.write_shift(2,O),R.write_shift(8,F,"f"),R}function _(O,U,F){var R=O.l+U,V=u(O,U,F);if(V[1].v=O.read_shift(8,"f"),F.qpro)O.l=R;else{var oe=O.read_shift(2);T(O.slice(O.l,O.l+oe),V),O.l+=oe}return V}function x(O,U,F){var R=U&32768;return U&=-32769,U=(R?O:0)+(U>=8192?U-16384:U),(R?"":"$")+(F?Rt(U):Et(U))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(O,U){Jt(O,0);for(var F=[],R=0,V="",oe="",he="",ue="";O.l<O.length;){var ne=O[O.l++];switch(ne){case 0:F.push(O.read_shift(8,"f"));break;case 1:oe=x(U[0].c,O.read_shift(2),!0),V=x(U[0].r,O.read_shift(2),!1),F.push(oe+V);break;case 2:{var Ie=x(U[0].c,O.read_shift(2),!0),ye=x(U[0].r,O.read_shift(2),!1);oe=x(U[0].c,O.read_shift(2),!0),V=x(U[0].r,O.read_shift(2),!1),F.push(Ie+ye+":"+oe+V)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:F.push("("+F.pop()+")");break;case 5:F.push(O.read_shift(2));break;case 6:{for(var Pt="";ne=O[O.l++];)Pt+=String.fromCharCode(ne);F.push('"'+Pt.replace(/"/g,'""')+'"')}break;case 8:F.push("-"+F.pop());break;case 23:F.push("+"+F.pop());break;case 22:F.push("NOT("+F.pop()+")");break;case 20:case 21:ue=F.pop(),he=F.pop(),F.push(["AND","OR"][ne-20]+"("+he+","+ue+")");break;default:if(ne<32&&g[ne])ue=F.pop(),he=F.pop(),F.push(he+g[ne]+ue);else if(v[ne]){if(R=v[ne][1],R==69&&(R=O[O.l++]),R>F.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+F.join("|")+"|");return}var Ae=F.slice(-R);F.length-=R,F.push(v[ne][0]+"("+Ae.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}F.length==1?U[1].f=""+F[0]:console.error("WK1 bad formula parse |"+F.join("|")+"|")}function I(O){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=O.read_shift(2),U[3]=O[O.l++],U[0].c=O[O.l++],U}function L(O,U){var F=I(O);return F[1].t="s",F[1].v=O.read_shift(U-4,"cstr"),F}function A(O,U,F,R){var V=z(6+R.length);V.write_shift(2,O),V.write_shift(1,F),V.write_shift(1,U),V.write_shift(1,39);for(var oe=0;oe<R.length;++oe){var he=R.charCodeAt(oe);V.write_shift(1,he>=128?95:he)}return V.write_shift(1,0),V}function P(O,U){var F=I(O);F[1].v=O.read_shift(2);var R=F[1].v>>1;if(F[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return F[1].v=R,F}function N(O,U){var F=I(O),R=O.read_shift(4),V=O.read_shift(4),oe=O.read_shift(2);if(oe==65535)return R===0&&V===3221225472?(F[1].t="e",F[1].v=15):R===0&&V===3489660928?(F[1].t="e",F[1].v=42):F[1].v=0,F;var he=oe&32768;return oe=(oe&32767)-16446,F[1].v=(1-he*2)*(V*Math.pow(2,oe+32)+R*Math.pow(2,oe)),F}function W(O,U,F,R){var V=z(14);if(V.write_shift(2,O),V.write_shift(1,F),V.write_shift(1,U),R==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var oe=0,he=0,ue=0,ne=0;return R<0&&(oe=1,R=-R),he=Math.log2(R)|0,R/=Math.pow(2,he-31),ne=R>>>0,ne&2147483648||(R/=2,++he,ne=R>>>0),R-=ne,ne|=2147483648,ne>>>=0,R*=Math.pow(2,32),ue=R>>>0,V.write_shift(4,ue),V.write_shift(4,ne),he+=16383+(oe?32768:0),V.write_shift(2,he),V}function G(O,U){var F=N(O);return O.l+=U-14,F}function q(O,U){var F=I(O),R=O.read_shift(4);return F[1].v=R>>6,F}function re(O,U){var F=I(O),R=O.read_shift(8,"f");return F[1].v=R,F}function Te(O,U){var F=re(O);return O.l+=U-10,F}function ve(O,U){return O[O.l+U-1]==0?O.read_shift(U,"cstr"):""}function Qe(O,U){var F=O[O.l++];F>U-1&&(F=U-1);for(var R="";R.length<F;)R+=String.fromCharCode(O[O.l++]);return R}function Me(O,U,F){if(!(!F.qpro||U<21)){var R=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var V=O.read_shift(U-21,"cstr");return[R,V]}}function te(O,U){for(var F={},R=O.l+U;O.l<R;){var V=O.read_shift(2);if(V==14e3){for(F[V]=[0,""],F[V][0]=O.read_shift(2);O[O.l];)F[V][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return F}function ce(O,U){var F=z(5+O.length);F.write_shift(2,14e3),F.write_shift(2,U);for(var R=0;R<O.length;++R){var V=O.charCodeAt(R);F[F.l++]=V>127?95:V}return F[F.l++]=0,F}var de={0:{n:"BOF",f:Pv},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:Qe},65535:{n:""}},we={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:te},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:q},38:{n:"??"},39:{n:"NUMBER27",f:re},40:{n:"FORMULA28",f:Te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}(),vT=/^\s|\s$|[\t\n\r]/;function Bv(e,t){if(!t.bookSST)return"";var r=[it];r[r.length]=Q("sst",null,{xmlns:_s[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(vT)&&(s+=' xml:space="preserve"'),s+=">"+Re(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function gT(e){return[e.read_shift(4),e.read_shift(4)]}function xT(e,t){return t||(t=z(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var _T=uS;function wT(e){var t=Vt();K(t,159,xT(e));for(var r=0;r<e.length;++r)K(t,19,_T(e[r]));return K(t,160),t.end()}function yT(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Uv(e){var t=0,r,n=yT(e),i=n.length+1,s,a,o,l,u;for(r=ci(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=t&16384?1:0,l=t<<1&32767,u=o|l,t=u^a;return t^52811}var ET=function(){function e(i,s){switch(s.type){case"base64":return t(sn(i),s);case"binary":return t(i,s);case"buffer":return t(ke&&Buffer.isBuffer(i)?i.toString("binary"):Ha(i),s);case"array":return t(nu(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(c,h){Array.isArray(o)&&(o[h]=[]);for(var f=/\\\w+\b/g,d=0,m,p=-1;m=f.exec(c);){switch(m[0]){case"\\cell":var _=c.slice(d,f.lastIndex-m[0].length);if(_[0]==" "&&(_=_.slice(1)),++p,_.length){var x={v:_,t:"s"};Array.isArray(o)?o[h][p]=x:o[Ne({r:h,c:p})]=x}break}d=f.lastIndex}p>u.e.c&&(u.e.c=p)}),o["!ref"]=nt(u),o}function r(i,s){return mi(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=je(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var c=a.s.c;c<=a.e.c;++c)s.push("\\cellx"+(c+1));for(s.push("\\pard\\intbl"),c=a.s.c;c<=a.e.c;++c){var h=Ne({r:u,c});o=l?(i[u]||[])[c]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(an(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Qd(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var ST=6,Zr=ST;function Cl(e){return Math.floor((e+Math.round(128/Zr)/256)*Zr)}function Ol(e){return Math.floor((e-5)/Zr*100+.5)/100}function uf(e){return Math.round((e*Zr+5)/Zr*256)/256}function w0(e){e.width?(e.wpx=Cl(e.width),e.wch=Ol(e.wpx),e.MDW=Zr):e.wpx?(e.wch=Ol(e.wpx),e.width=uf(e.wch),e.MDW=Zr):typeof e.wch=="number"&&(e.width=uf(e.wch),e.wpx=Cl(e.width),e.MDW=Zr),e.customWidth&&delete e.customWidth}var TT=96,jv=TT;function Rl(e){return e*96/jv}function $v(e){return e*jv/96}function kT(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Q("numFmt",null,{numFmtId:n,formatCode:Re(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Q("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function AT(e){var t=[];return t[t.length]=Q("cellXfs",null),e.forEach(function(r){t[t.length]=Q("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Q("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Wv(e,t){var r=[it,Q("styleSheet",null,{xmlns:_s[0],"xmlns:vt":ct.vt})],n;return e.SSF&&(n=kT(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=AT(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function CT(e,t){var r=e.read_shift(2),n=Ft(e);return[r,n]}function OT(e,t,r){r||(r=z(6+4*t.length)),r.write_shift(2,e),ht(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function RT(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=vS(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=mS(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ft(e),n}function FT(e,t){t||(t=z(25+4*32)),t.write_shift(2,e.sz*20),gS(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),kl(e.color,t);var n=0;return n=2,t.write_shift(1,n),ht(e.name,t),t.length>t.l?t.slice(0,t.l):t}var NT=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Xu,PT=$r;function Zd(e,t){t||(t=z(4*3+8*7+16*1)),Xu||(Xu=l0(NT));var r=Xu[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(kl({auto:1},t),kl({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function IT(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function zv(e,t,r){r||(r=z(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function bs(e,t){return t||(t=z(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var DT=$r;function LT(e,t){return t||(t=z(51)),t.write_shift(1,0),bs(null,t),bs(null,t),bs(null,t),bs(null,t),bs(null,t),t.length>t.l?t.slice(0,t.l):t}function bT(e,t){return t||(t=z(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Tl(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function MT(e,t,r){var n=z(2052);return n.write_shift(4,e),Tl(t,n),Tl(r,n),n.length>n.l?n.slice(0,n.l):n}function BT(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(K(e,615,Fr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&K(e,44,OT(i,t[i]))}),K(e,616))}}function UT(e){var t=1;K(e,611,Fr(t)),K(e,43,FT({sz:12,color:{theme:1},name:"Calibri",family:2})),K(e,612)}function jT(e){var t=2;K(e,603,Fr(t)),K(e,45,Zd({patternType:"none"})),K(e,45,Zd({patternType:"gray125"})),K(e,604)}function $T(e){var t=1;K(e,613,Fr(t)),K(e,46,LT()),K(e,614)}function WT(e){var t=1;K(e,626,Fr(t)),K(e,47,zv({numFmtId:0},65535)),K(e,627)}function zT(e,t){K(e,617,Fr(t.length)),t.forEach(function(r){K(e,47,zv(r,0))}),K(e,618)}function HT(e){var t=1;K(e,619,Fr(t)),K(e,48,bT({xfId:0,name:"Normal"})),K(e,620)}function VT(e){var t=0;K(e,505,Fr(t)),K(e,506)}function GT(e){var t=0;K(e,508,MT(t,"TableStyleMedium9","PivotStyleMedium4")),K(e,509)}function KT(e,t){var r=Vt();return K(r,278),BT(r,e.SSF),UT(r),jT(r),$T(r),WT(r),zT(r,t.cellXfs),HT(r),VT(r),GT(r),K(r,279),r.end()}function Hv(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[it];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function qT(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ft(e)}}function XT(e){var t=z(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ht(e.name,t),t.slice(0,t.l)}function YT(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function JT(e){var t=z(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function QT(e,t){var r=z(8+2*t.length);return r.write_shift(4,e),ht(t,r),r.slice(0,r.l)}function ZT(e){return e.l+=4,e.read_shift(4)!=0}function e4(e,t){var r=z(8);return r.write_shift(4,e),r.write_shift(4,1),r}function t4(){var e=Vt();return K(e,332),K(e,334,Fr(1)),K(e,335,XT({name:"XLDAPR",version:12e4,flags:3496657072})),K(e,336),K(e,339,QT(1,"XLDAPR")),K(e,52),K(e,35,Fr(514)),K(e,4096,Fr(0)),K(e,4097,ur(1)),K(e,36),K(e,53),K(e,340),K(e,337,e4(1)),K(e,51,JT([[1,0]])),K(e,338),K(e,333),e.end()}function Vv(){var e=[it];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function r4(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ne(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var qi=1024;function Gv(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Q("xml",null,{"xmlns:v":Qt.v,"xmlns:o":Qt.o,"xmlns:x":Qt.x,"xmlns:mv":Qt.mv}).replace(/\/>/,">"),Q("o:shapelayout",Q("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Q("v:shapetype",[Q("v:stroke",null,{joinstyle:"miter"}),Q("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];qi<e*1e3;)qi+=1e3;return t.forEach(function(s){var a=ft(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Q("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Q("v:fill",l,o),c={on:"t",obscured:"t"};++qi,i=i.concat(["<v:shape"+La({id:"_x0000_s"+qi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Q("v:shadow",null,c),Q("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",wt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),wt("x:AutoFill","False"),wt("x:Row",String(a.r)),wt("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Kv(e){var t=[it,Q("comments",null,{xmlns:_s[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Re(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Re(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(wt("t",Re(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(wt("t",Re(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function n4(e,t,r){var n=[it,Q("ThreadedComments",null,{xmlns:ct.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(Q("threadedComment",wt("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function i4(e){var t=[it,Q("personList",null,{xmlns:ct.TCMNT,"xmlns:x":_s[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Q("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function s4(e){var t={};t.iauthor=e.read_shift(4);var r=_i(e);return t.rfx=r.s,t.ref=Ne(r.s),e.l+=16,t}function a4(e,t){return t==null&&(t=z(36)),t.write_shift(4,e[1].iauthor),ys(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var o4=Ft;function l4(e){return ht(e.slice(0,54))}function u4(e){var t=Vt(),r=[];return K(t,628),K(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),K(t,632,l4(i.a)))})}),K(t,631),K(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:ft(n[0]),e:ft(n[0])};K(t,635,a4([s,i])),i.t&&i.t.length>0&&K(t,637,fS(i)),K(t,636),delete i.iauthor})}),K(t,634),K(t,629),t.end()}function c4(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Pe.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var qv=["xlsb","xlsm","xlam","biff8","xla"],f4=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,c=a.length>0?parseInt(a,10)|0:0;return o?c+=t.c:--c,l?u+=t.r:--u,i+(o?"":"$")+Rt(c)+(l?"":"$")+Et(u)}return function(i,s){return t=s,i.replace(e,r)}}(),y0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,E0=function(){return function(t,r){return t.replace(y0,function(n,i,s,a,o,l){var u=m0(a)-(s?0:r.c),c=p0(l)-(o?0:r.r),h=c==0?"":o?c+1:"["+c+"]",f=u==0?"":s?u+1:"["+u+"]";return i+"R"+h+"C"+f})}}();function h4(e,t){return e.replace(y0,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Rt(m0(s)+t.c))+(a=="$"?a+o:Et(p0(o)+t.r))})}function d4(e){return e.length!=1}function et(e){e.l+=1}function Dn(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Xv(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Yv(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=Dn(e),o=Dn(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Yv(e){var t=Dn(e),r=Dn(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function p4(e,t,r){if(r.biff<8)return Yv(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=Dn(e),a=Dn(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function Jv(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return m4(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Dn(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function m4(e){var t=Dn(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function v4(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function g4(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return x4(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function x4(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function _4(e,t,r){var n=(e[e.l++]&96)>>5,i=Xv(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function w4(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=Xv(e,s,r);return[n,i,a]}function y4(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function E4(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function S4(e,t,r){var n=(e[e.l++]&96)>>5,i=p4(e,t-1,r);return[n,i]}function T4(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function ep(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function k4(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function A4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function C4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function O4(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function R4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Qv(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function F4(e){return e.read_shift(2),Qv(e)}function N4(e){return e.read_shift(2),Qv(e)}function P4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Jv(e,0,r);return[n,i]}function I4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=g4(e,0,r);return[n,i]}function D4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Jv(e,0,r);return[n,i,s]}function L4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[Lk[i],tg[i],n]}function b4(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:M4(e);return[i,(s[0]===0?tg:Dk)[s[1]]]}function M4(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function B4(e,t,r){e.l+=r&&r.biff==2?3:4}function U4(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function j4(e){return e.l++,Ka[e.read_shift(1)]}function $4(e){return e.l++,e.read_shift(2)}function W4(e){return e.l++,e.read_shift(1)!==0}function z4(e){return e.l++,Es(e)}function H4(e,t,r){return e.l++,Dv(e,t-1,r)}function V4(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=DS(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ka[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Es(e);break;case 2:r[1]=BS(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function G4(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?_i:$S)(e));return i}function K4(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=V4(e,r.biff);return a}function q4(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function X4(e,t,r){if(r.biff==5)return Y4(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function Y4(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function J4(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Q4(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Z4(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function ek(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var tk=$r,rk=$r,nk=$r;function qa(e,t,r){return e.l+=2,[v4(e)]}function S0(e){return e.l+=6,[]}var ik=qa,sk=S0,ak=S0,ok=qa;function Zv(e){return e.l+=2,[Pv(e),e.read_shift(2)&1]}var lk=qa,uk=Zv,ck=S0,fk=qa,hk=qa,dk=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function pk(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=dk[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function mk(e){return e.l+=2,[e.read_shift(4)]}function vk(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function gk(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function xk(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function _k(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function wk(e){return e.l+=4,[0,0]}var tp={1:{n:"PtgExp",f:U4},2:{n:"PtgTbl",f:nk},3:{n:"PtgAdd",f:et},4:{n:"PtgSub",f:et},5:{n:"PtgMul",f:et},6:{n:"PtgDiv",f:et},7:{n:"PtgPower",f:et},8:{n:"PtgConcat",f:et},9:{n:"PtgLt",f:et},10:{n:"PtgLe",f:et},11:{n:"PtgEq",f:et},12:{n:"PtgGe",f:et},13:{n:"PtgGt",f:et},14:{n:"PtgNe",f:et},15:{n:"PtgIsect",f:et},16:{n:"PtgUnion",f:et},17:{n:"PtgRange",f:et},18:{n:"PtgUplus",f:et},19:{n:"PtgUminus",f:et},20:{n:"PtgPercent",f:et},21:{n:"PtgParen",f:et},22:{n:"PtgMissArg",f:et},23:{n:"PtgStr",f:H4},26:{n:"PtgSheet",f:vk},27:{n:"PtgEndSheet",f:gk},28:{n:"PtgErr",f:j4},29:{n:"PtgBool",f:W4},30:{n:"PtgInt",f:$4},31:{n:"PtgNum",f:z4},32:{n:"PtgArray",f:T4},33:{n:"PtgFunc",f:L4},34:{n:"PtgFuncVar",f:b4},35:{n:"PtgName",f:q4},36:{n:"PtgRef",f:P4},37:{n:"PtgArea",f:_4},38:{n:"PtgMemArea",f:J4},39:{n:"PtgMemErr",f:tk},40:{n:"PtgMemNoMem",f:rk},41:{n:"PtgMemFunc",f:Q4},42:{n:"PtgRefErr",f:Z4},43:{n:"PtgAreaErr",f:y4},44:{n:"PtgRefN",f:I4},45:{n:"PtgAreaN",f:S4},46:{n:"PtgMemAreaN",f:xk},47:{n:"PtgMemNoMemN",f:_k},57:{n:"PtgNameX",f:X4},58:{n:"PtgRef3d",f:D4},59:{n:"PtgArea3d",f:w4},60:{n:"PtgRefErr3d",f:ek},61:{n:"PtgAreaErr3d",f:E4},255:{}},yk={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ek={1:{n:"PtgElfLel",f:Zv},2:{n:"PtgElfRw",f:fk},3:{n:"PtgElfCol",f:ik},6:{n:"PtgElfRwV",f:hk},7:{n:"PtgElfColV",f:ok},10:{n:"PtgElfRadical",f:lk},11:{n:"PtgElfRadicalS",f:ck},13:{n:"PtgElfColS",f:sk},15:{n:"PtgElfColSV",f:ak},16:{n:"PtgElfRadicalLel",f:uk},25:{n:"PtgList",f:pk},29:{n:"PtgSxName",f:mk},255:{}},Sk={0:{n:"PtgAttrNoop",f:wk},1:{n:"PtgAttrSemi",f:R4},2:{n:"PtgAttrIf",f:C4},4:{n:"PtgAttrChoose",f:k4},8:{n:"PtgAttrGoto",f:A4},16:{n:"PtgAttrSum",f:B4},32:{n:"PtgAttrBaxcel",f:ep},33:{n:"PtgAttrBaxcel",f:ep},64:{n:"PtgAttrSpace",f:F4},65:{n:"PtgAttrSpaceSemi",f:N4},128:{n:"PtgAttrIfError",f:O4},255:{}};function Tk(e,t,r,n){if(n.biff<8)return $r(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=K4(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=G4(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push($r(e,t)),s}function kk(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=tp[s]||tp[yk[s]],(s===24||s===25)&&(i=(s===24?Ek:Sk)[e[e.l+1]]),!i||!i.f?$r(e,t):a.push([i.n,i.f(e,t,r)]);return a}function Ak(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var Ck={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Ok(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function eg(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function rp(e,t,r){var n=eg(e,t,r);return n=="#REF"?n:Ok(n,r)}function ps(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,c,h=0,f=0,d,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,_="",x=0,v=e[0].length;x<v;++x){var g=e[0][x];switch(g[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:_=Ye(" ",e[0][p][1][1]);break;case 1:_=Ye("\r",e[0][p][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+_,p=-1}o.push(u+Ck[g[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=ia(g[1][1],a,i),o.push(sa(c,s));break;case"PtgRefN":c=r?ia(g[1][1],r,i):g[1][1],o.push(sa(c,s));break;case"PtgRef3d":h=g[1][1],c=ia(g[1][2],a,i),m=rp(n,h,i),o.push(m+"!"+sa(c,s));break;case"PtgFunc":case"PtgFuncVar":var T=g[1][0],I=g[1][1];T||(T=0),T&=127;var L=T==0?[]:o.slice(-T);o.length-=T,I==="User"&&(I=L.shift()),o.push(I+"("+L.join(",")+")");break;case"PtgBool":o.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(g[1]);break;case"PtgNum":o.push(String(g[1]));break;case"PtgStr":o.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(g[1]);break;case"PtgAreaN":d=jd(g[1][1],r?{s:r}:a,i),o.push(Ku(d,i));break;case"PtgArea":d=jd(g[1][1],a,i),o.push(Ku(d,i));break;case"PtgArea3d":h=g[1][1],d=g[1][2],m=rp(n,h,i),o.push(m+"!"+Ku(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=g[1][2];var A=(n.names||[])[f-1]||(n[0]||[])[f],P=A?A.Name:"SH33TJSNAME"+String(f);P&&P.slice(0,6)=="_xlfn."&&!i.xlfn&&(P=P.slice(6)),o.push(P);break;case"PtgNameX":var N=g[1][1];f=g[1][2];var W;if(i.biff<=5)N<0&&(N=-N),n[N]&&(W=n[N][f]);else{var G="";if(((n[N]||[])[0]||[])[0]==14849||(((n[N]||[])[0]||[])[0]==1025?n[N][f]&&n[N][f].itab>0&&(G=n.SheetNames[n[N][f].itab-1]+"!"):G=n.SheetNames[f-1]+"!"),n[N]&&n[N][f])G+=n[N][f].Name;else if(n[0]&&n[0][f])G+=n[0][f].Name;else{var q=(eg(n,N,i)||"").split(";;");q[f-1]?G=q[f-1]:G+="SH33TJSERRX"}o.push(G);break}W||(W={Name:"SH33TJSERRY"}),o.push(W.Name);break;case"PtgParen":var re="(",Te=")";if(p>=0){switch(_="",e[0][p][1][0]){case 2:re=Ye(" ",e[0][p][1][1])+re;break;case 3:re=Ye("\r",e[0][p][1][1])+re;break;case 4:Te=Ye(" ",e[0][p][1][1])+Te;break;case 5:Te=Ye("\r",e[0][p][1][1])+Te;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(re+o.pop()+Te);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":c={c:g[1][1],r:g[1][0]};var ve={c:r.c,r:r.r};if(n.sharedf[Ne(c)]){var Qe=n.sharedf[Ne(c)];o.push(ps(Qe,a,ve,n,i))}else{var Me=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(c.c<u[0].s.c||c.c>u[0].e.c)&&!(c.r<u[0].s.r||c.r>u[0].e.r)){o.push(ps(u[1],a,ve,n,i)),Me=!0;break}Me||o.push(g[1])}break;case"PtgArray":o.push("{"+Ak(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&te.indexOf(e[0][x][0])==-1){g=e[0][p];var ce=!0;switch(g[1][0]){case 4:ce=!1;case 0:_=Ye(" ",g[1][1]);break;case 5:ce=!1;case 1:_=Ye("\r",g[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}o.push((ce?_:"")+o.pop()+(ce?"":_)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function Rk(e){if(e==null){var t=z(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return fi(e);return fi(0)}function Fk(e,t,r,n,i){var s=hi(t,r,i),a=Rk(e.v),o=z(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=z(e.bf.length),c=0;c<e.bf.length;++c)u[c]=e.bf[c];var h=_t([s,a,o,u]);return h}function iu(e,t,r){var n=e.read_shift(4),i=kk(e,n,r),s=e.read_shift(4),a=s>0?Tk(e,s,i,r):null;return[i,a]}var Nk=iu,su=iu,Pk=iu,Ik=iu,Dk={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},tg={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Lk={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function bk(e){var t="of:="+e.replace(y0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Mk(e){return e.replace(/\./,"!")}var aa=typeof Map<"u";function T0(e,t,r){var n=0,i=e.length;if(r){if(aa?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=aa?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(aa?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function au(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Zr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Ol(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=uf(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function rg(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Un(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Jm(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Bk(e,t,r){if(e&&e["!ref"]){var n=je(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Uk(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+nt(e[r])+'"/>';return t+"</mergeCells>"}function jk(e,t,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Da(Re(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Q("outlinePr",null,u)}!s&&!o||(i[i.length]=Q("sheetPr",o,a))}var $k=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Wk=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function zk(e){var t={sheet:1};return $k.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Wk.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Uv(e.password).toString(16).toUpperCase()),Q("sheetProtection",null,t)}function Hk(e){return rg(e),Q("pageMargins",null,e)}function Vk(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Q("col",null,au(i,n)));return r[r.length]="</cols>",r.join("")}function Gk(e,t,r,n){var i=typeof e.ref=="string"?e.ref:nt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=ir(i);a.s.r==a.e.r&&(a.e.r=ir(t["!ref"]).e.r,i=nt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Q("autoFilter",null,{ref:i})}function Kk(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Q("sheetViews",Q("sheetView",null,i),{})}function qk(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Ka[e.v];break;case"d":n&&n.cellDates?i=Mt(e.v,-1).toISOString():(e=Kt(e),e.t="n",i=""+(e.v=Gt(Mt(e.v)))),typeof e.z>"u"&&(e.z=Je[14]);break;default:i=e.v;break}var o=wt("v",Re(i)),l={r:t},u=Un(n.cellXfs,e,n);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=wt("v",""+T0(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=a),typeof e.f=="string"&&e.f){var c=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Q("f",Re(e.f),c)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Q("c",o,l)}function Xk(e,t,r,n){var i=[],s=[],a=je(e["!ref"]),o="",l,u="",c=[],h=0,f=0,d=e["!rows"],m=Array.isArray(e),p={r:u},_,x=-1;for(f=a.s.c;f<=a.e.c;++f)c[f]=Rt(f);for(h=a.s.r;h<=a.e.r;++h){for(s=[],u=Et(h),f=a.s.c;f<=a.e.c;++f){l=c[f]+u;var v=m?(e[h]||[])[f]:e[l];v!==void 0&&(o=qk(v,l,e,t))!=null&&s.push(o)}(s.length>0||d&&d[h])&&(p={r:u},d&&d[h]&&(_=d[h],_.hidden&&(p.hidden=1),x=-1,_.hpx?x=Rl(_.hpx):_.hpt&&(x=_.hpt),x>-1&&(p.ht=x,p.customHeight=1),_.level&&(p.outlineLevel=_.level)),i[i.length]=Q("row",s.join(""),p))}if(d)for(;h<d.length;++h)d&&d[h]&&(p={r:h+1},_=d[h],_.hidden&&(p.hidden=1),x=-1,_.hpx?x=Rl(_.hpx):_.hpt&&(x=_.hpt),x>-1&&(p.ht=x,p.customHeight=1),_.level&&(p.outlineLevel=_.level),i[i.length]=Q("row","",p));return i.join("")}function ng(e,t,r,n){var i=[it,Q("worksheet",null,{xmlns:_s[0],"xmlns:r":ct.r})],s=r.SheetNames[e],a=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",c=je(u);if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),u=nt(c)}n||(n={}),l["!comments"]=[];var h=[];jk(l,r,e,t,i),i[i.length]=Q("dimension",null,{ref:u}),i[i.length]=Kk(l,t,e,r),t.sheetFormat&&(i[i.length]=Q("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=Vk(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=Xk(l,t),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=zk(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=Gk(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=Uk(l["!merges"]));var f=-1,d,m=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(d={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=Oe(n,-1,Re(p[1].Target).replace(/#.*$/,""),Se.HLINK),d["r:id"]="rId"+m),(f=p[1].Target.indexOf("#"))>-1&&(d.location=Re(p[1].Target.slice(f+1))),p[1].Tooltip&&(d.tooltip=Re(p[1].Tooltip)),i[i.length]=Q("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=Hk(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=wt("ignoredErrors",Q("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(m=Oe(n,-1,"../drawings/drawing"+(e+1)+".xml",Se.DRAW),i[i.length]=Q("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=h),l["!comments"].length>0&&(m=Oe(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Se.VML),i[i.length]=Q("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Yk(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function Jk(e,t,r){var n=z(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=Rl(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:e,c:0},c=0;c<16;++c)if(!(t.s.c>c+1<<10||t.e.c<c<<10)){for(var h=-1,f=-1,d=c<<10;d<c+1<<10;++d){u.c=d;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ne(u)];m&&(h<0&&(h=d),f=d)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,f))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function Qk(e,t,r,n){var i=Jk(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&K(e,0,i)}var Zk=_i,eA=ys;function tA(){}function rA(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=hS(e),r}function nA(e,t,r){r==null&&(r=z(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return kl({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),xv(e,r),r.slice(0,r.l)}function iA(e){var t=vr(e);return[t]}function sA(e,t,r){return r==null&&(r=z(8)),vi(t,r)}function aA(e){var t=gi(e);return[t]}function oA(e,t,r){return r==null&&(r=z(4)),xi(t,r)}function lA(e){var t=vr(e),r=e.read_shift(1);return[t,r,"b"]}function uA(e,t,r){return r==null&&(r=z(9)),vi(t,r),r.write_shift(1,e.v?1:0),r}function cA(e){var t=gi(e),r=e.read_shift(1);return[t,r,"b"]}function fA(e,t,r){return r==null&&(r=z(5)),xi(t,r),r.write_shift(1,e.v?1:0),r}function hA(e){var t=vr(e),r=e.read_shift(1);return[t,r,"e"]}function dA(e,t,r){return r==null&&(r=z(9)),vi(t,r),r.write_shift(1,e.v),r}function pA(e){var t=gi(e),r=e.read_shift(1);return[t,r,"e"]}function mA(e,t,r){return r==null&&(r=z(8)),xi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function vA(e){var t=vr(e),r=e.read_shift(4);return[t,r,"s"]}function gA(e,t,r){return r==null&&(r=z(12)),vi(t,r),r.write_shift(4,t.v),r}function xA(e){var t=gi(e),r=e.read_shift(4);return[t,r,"s"]}function _A(e,t,r){return r==null&&(r=z(8)),xi(t,r),r.write_shift(4,t.v),r}function wA(e){var t=vr(e),r=Es(e);return[t,r,"n"]}function yA(e,t,r){return r==null&&(r=z(16)),vi(t,r),fi(e.v,r),r}function EA(e){var t=gi(e),r=Es(e);return[t,r,"n"]}function SA(e,t,r){return r==null&&(r=z(12)),xi(t,r),fi(e.v,r),r}function TA(e){var t=vr(e),r=_v(e);return[t,r,"n"]}function kA(e,t,r){return r==null&&(r=z(12)),vi(t,r),wv(e.v,r),r}function AA(e){var t=gi(e),r=_v(e);return[t,r,"n"]}function CA(e,t,r){return r==null&&(r=z(8)),xi(t,r),wv(e.v,r),r}function OA(e){var t=vr(e),r=v0(e);return[t,r,"is"]}function RA(e){var t=vr(e),r=Ft(e);return[t,r,"str"]}function FA(e,t,r){return r==null&&(r=z(12+4*e.v.length)),vi(t,r),ht(e.v,r),r.length>r.l?r.slice(0,r.l):r}function NA(e){var t=gi(e),r=Ft(e);return[t,r,"str"]}function PA(e,t,r){return r==null&&(r=z(8+4*e.v.length)),xi(t,r),ht(e.v,r),r.length>r.l?r.slice(0,r.l):r}function IA(e,t,r){var n=e.l+t,i=vr(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=su(e,n-e.l,r);a[3]=ps(o,null,i,r.supbooks,r)}else e.l=n;return a}function DA(e,t,r){var n=e.l+t,i=vr(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=su(e,n-e.l,r);a[3]=ps(o,null,i,r.supbooks,r)}else e.l=n;return a}function LA(e,t,r){var n=e.l+t,i=vr(e);i.r=r["!row"];var s=Es(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=su(e,n-e.l,r);a[3]=ps(o,null,i,r.supbooks,r)}else e.l=n;return a}function bA(e,t,r){var n=e.l+t,i=vr(e);i.r=r["!row"];var s=Ft(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=su(e,n-e.l,r);a[3]=ps(o,null,i,r.supbooks,r)}else e.l=n;return a}var MA=_i,BA=ys;function UA(e,t){return t==null&&(t=z(4)),t.write_shift(4,e),t}function jA(e,t){var r=e.l+t,n=_i(e),i=g0(e),s=Ft(e),a=Ft(e),o=Ft(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function $A(e,t){var r=z(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ys({s:ft(e[0]),e:ft(e[0])},r),x0("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return ht(i||"",r),ht(e[1].Tooltip||"",r),ht("",r),r.slice(0,r.l)}function WA(){}function zA(e,t,r){var n=e.l+t,i=yv(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=Nk(e,n-e.l,r);a[1]=o}else e.l=n;return a}function HA(e,t,r){var n=e.l+t,i=_i(e),s=[i];if(r.cellFormula){var a=Ik(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}function VA(e,t,r){r==null&&(r=z(18));var n=au(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var ig=["left","right","top","bottom","header","footer"];function GA(e){var t={};return ig.forEach(function(r){t[r]=Es(e)}),t}function KA(e,t){return t==null&&(t=z(6*8)),rg(e),ig.forEach(function(r){fi(e[r],t)}),t}function qA(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function XA(e,t,r){r==null&&(r=z(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function YA(e){var t=z(24);return t.write_shift(4,4),t.write_shift(4,1),ys(e,t),t}function JA(e,t){return t==null&&(t=z(16*4+2)),t.write_shift(2,e.password?Uv(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function QA(){}function ZA(){}function e3(e,t,r,n,i,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Kt(t),t.z=t.z||Je[14],t.v=Gt(Mt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Un(i.cellXfs,t,i),t.l&&s["!links"].push([Ne(l),t.l]),t.c&&s["!comments"].push([Ne(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=T0(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,a?K(e,18,_A(t,l)):K(e,7,gA(t,l))):(l.t="str",a?K(e,17,PA(t,l)):K(e,6,FA(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?K(e,13,CA(t,l)):K(e,2,kA(t,l)):a?K(e,16,SA(t,l)):K(e,5,yA(t,l)),!0;case"b":return l.t="b",a?K(e,15,fA(t,l)):K(e,4,uA(t,l)),!0;case"e":return l.t="e",a?K(e,14,mA(t,l)):K(e,3,dA(t,l)),!0}return a?K(e,12,oA(t,l)):K(e,1,sA(t,l)),!0}function t3(e,t,r,n){var i=je(t["!ref"]||"A1"),s,a="",o=[];K(e,145);var l=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var c=i.s.r;c<=u;++c){a=Et(c),Qk(e,t,i,c);var h=!1;if(c<=i.e.r)for(var f=i.s.c;f<=i.e.c;++f){c===i.s.r&&(o[f]=Rt(f)),s=o[f]+a;var d=l?(t[c]||[])[f]:t[s];if(!d){h=!1;continue}h=e3(e,d,c,f,n,t,h)}}K(e,146)}function r3(e,t){!t||!t["!merges"]||(K(e,177,UA(t["!merges"].length)),t["!merges"].forEach(function(r){K(e,176,BA(r))}),K(e,178))}function n3(e,t){!t||!t["!cols"]||(K(e,390),t["!cols"].forEach(function(r,n){r&&K(e,60,VA(n,r))}),K(e,391))}function i3(e,t){!t||!t["!ref"]||(K(e,648),K(e,649,YA(je(t["!ref"]))),K(e,650))}function s3(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Oe(r,-1,n[1].Target.replace(/#.*$/,""),Se.HLINK);K(e,494,$A(n,i))}}),delete t["!links"]}function a3(e,t,r,n){if(t["!comments"].length>0){var i=Oe(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Se.VML);K(e,551,x0("rId"+i)),t["!legacy"]=i}}function o3(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:nt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=ir(s);o.s.r==o.e.r&&(o.e.r=ir(t["!ref"]).e.r,s=nt(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),K(e,161,ys(je(s))),K(e,162)}}function l3(e,t,r){K(e,133),K(e,137,XA(t,r)),K(e,138),K(e,134)}function u3(e,t){t["!protect"]&&K(e,535,JA(t["!protect"]))}function c3(e,t,r,n){var i=Vt(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=je(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],K(i,129),(r.vbaraw||a["!outline"])&&K(i,147,nA(o,a["!outline"])),K(i,148,eA(l)),l3(i,a,r.Workbook),n3(i,a),t3(i,a,e,t),u3(i,a),o3(i,a,r,e),r3(i,a),s3(i,a,n),a["!margins"]&&K(i,476,KA(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&i3(i,a),a3(i,a,e,n),K(i,130),i.end()}function f3(e,t){e.l+=10;var r=Ft(e);return{name:r}}var h3=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function d3(e){return!e.Workbook||!e.Workbook.WBProps?"false":HE(e.Workbook.WBProps.date1904)?"true":"false"}var p3="][*?/\\".split("");function sg(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return p3.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function m3(e,t,r){e.forEach(function(n,i){sg(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[i]&&t[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function v3(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];m3(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Bk(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function ag(e){var t=[it];t[t.length]=Q("workbook",null,{xmlns:_s[0],"xmlns:r":ct.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(h3.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Q("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var a={name:Re(e.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=Q("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Q("definedName",Re(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function g3(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=lf(e),r.name=Ft(e),r}function x3(e,t){return t||(t=z(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),x0(e.strRelID,t),ht(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function _3(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Ft(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function w3(e,t){t||(t=z(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),xv(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function y3(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=dS(e),a=Pk(e,0,r),o=g0(e);e.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function E3(e,t){K(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};K(e,156,x3(i))}K(e,144)}function S3(e,t){t||(t=z(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ht("SheetJS",t),ht(gl.version,t),ht(gl.version,t),ht("7262",t),t.length>t.l?t.slice(0,t.l):t}function T3(e,t){t||(t=z(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function k3(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(K(e,135),K(e,158,T3(i)),K(e,136))}}function A3(e,t){var r=Vt();return K(r,131),K(r,128,S3()),K(r,153,w3(e.Workbook&&e.Workbook.WBProps||null)),k3(r,e),E3(r,e),K(r,132),r.end()}function C3(e,t,r){return(t.slice(-4)===".bin"?A3:ag)(e)}function O3(e,t,r,n,i){return(t.slice(-4)===".bin"?c3:ng)(e,r,n,i)}function R3(e,t,r){return(t.slice(-4)===".bin"?KT:Wv)(e,r)}function F3(e,t,r){return(t.slice(-4)===".bin"?wT:Bv)(e,r)}function N3(e,t,r){return(t.slice(-4)===".bin"?u4:Kv)(e)}function P3(e){return(e.slice(-4)===".bin"?t4:Vv)()}function I3(e,t){var r=[];return e.Props&&r.push(RS(e.Props,t)),e.Custprops&&r.push(FS(e.Props,e.Custprops)),r.join("")}function D3(){return""}function L3(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(Q("NumberFormat",null,{"ss:Format":Re(Je[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(Q("Style",s.join(""),a))}),Q("Styles",r.join(""))}function og(e){return Q("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+E0(e.Ref,{r:0,c:0})})}function b3(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(og(i)))}return Q("Names",r.join(""))}function M3(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(og(o)))}return s.join("")}function B3(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Q("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Q("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Q("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Q("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(wt("ProtectContents","True")),e["!protect"].objects&&i.push(wt("ProtectObjects","True")),e["!protect"].scenarios&&i.push(wt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(wt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(wt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Q("WorksheetOptions",i.join(""),{xmlns:Qt.x})}function U3(e){return e.map(function(t){var r=zE(t.t||""),n=Q("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Q("Comment",n,{"ss:Author":t.a})}).join("")}function j3(e,t,r,n,i,s,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Re(E0(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=ft(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Re(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Re(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],c=0;c!=u.length;++c)u[c].s.c!=a.c||u[c].s.r!=a.r||(u[c].e.c>u[c].s.c&&(o["ss:MergeAcross"]=u[c].e.c-u[c].s.c),u[c].e.r>u[c].s.r&&(o["ss:MergeDown"]=u[c].e.r-u[c].s.r));var h="",f="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",f=String(e.v);break;case"b":h="Boolean",f=e.v?"1":"0";break;case"e":h="Error",f=Ka[e.v];break;case"d":h="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Je[14]);break;case"s":h="String",f=WE(e.v||"");break}var d=Un(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=a.c+1;var m=e.v!=null?f:"",p=e.t=="z"?"":'<Data ss:Type="'+h+'">'+m+"</Data>";return(e.c||[]).length>0&&(p+=U3(e.c)),Q("Cell",p,o)}function $3(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=$v(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function W3(e,t,r,n){if(!e["!ref"])return"";var i=je(e["!ref"]),s=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(_,x){w0(_);var v=!!_.width,g=au(x,_),T={"ss:Index":x+1};v&&(T["ss:Width"]=Cl(g.width)),_.hidden&&(T["ss:Hidden"]="1"),o.push(Q("Column",null,T))});for(var l=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var c=[$3(u,(e["!rows"]||[])[u])],h=i.s.c;h<=i.e.c;++h){var f=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>u)&&!(s[a].e.c<h)&&!(s[a].e.r<u)){(s[a].s.c!=h||s[a].s.r!=u)&&(f=!0);break}if(!f){var d={r:u,c:h},m=Ne(d),p=l?(e[u]||[])[h]:e[m];c.push(j3(p,m,e,t,r,n,d))}}c.push("</Row>"),c.length>2&&o.push(c.join(""))}return o.join("")}function z3(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],a=s?M3(s,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?W3(s,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(B3(s,t,e,r)),n.join("")}function H3(e,t){t||(t={}),e.SSF||(e.SSF=Kt(Je)),e.SSF&&(tu(),eu(e.SSF),t.revssf=ru(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Un(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(I3(e,t)),r.push(D3()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Q("Worksheet",z3(n,t,e),{"ss:Name":Re(e.SheetNames[n])}));return r[2]=L3(e,t),r[3]=b3(e),it+Q("Workbook",r.join(""),{xmlns:Qt.ss,"xmlns:o":Qt.o,"xmlns:x":Qt.x,"xmlns:ss":Qt.ss,"xmlns:dt":Qt.dt,"xmlns:html":Qt.html})}var Yu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function V3(e,t){var r=[],n=[],i=[],s=0,a,o=Rd(Wd,"n"),l=Rd(zd,"n");if(e.Props)for(a=Tt(e.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Props[a[s]]]);if(e.Custprops)for(a=Tt(e.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)Nv.indexOf(i[s][0])>-1||Ov.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&Pe.utils.cfb_add(t,"/SummaryInformation",qd(n,Yu.SI,l,zd)),(r.length||u.length)&&Pe.utils.cfb_add(t,"/DocumentSummaryInformation",qd(r,Yu.DSI,o,Wd,u.length?u:null,Yu.UDI))}function G3(e,t){var r=t||{},n=Pe.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Pe.utils.cfb_add(n,i,lg(e,r)),r.biff==8&&(e.Props||e.Custprops)&&V3(e,n),r.biff==8&&e.vbaraw&&c4(n,Pe.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var K3={0:{f:Yk},1:{f:iA},2:{f:TA},3:{f:hA},4:{f:lA},5:{f:wA},6:{f:RA},7:{f:vA},8:{f:bA},9:{f:LA},10:{f:IA},11:{f:DA},12:{f:aA},13:{f:AA},14:{f:pA},15:{f:cA},16:{f:EA},17:{f:NA},18:{f:xA},19:{f:v0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:y3},40:{},42:{},43:{f:RT},44:{f:CT},45:{f:PT},46:{f:DT},47:{f:IT},48:{},49:{f:aS},50:{},51:{f:YT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:oT},62:{f:OA},63:{f:r4},64:{f:QA},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:$r,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:qA},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:rA},148:{f:Zk,p:16},151:{f:WA},152:{},153:{f:_3},154:{},155:{},156:{f:g3},157:{},158:{},159:{T:1,f:gT},160:{T:-1},161:{T:1,f:_i},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:MA},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:qT},336:{T:-1},337:{f:ZT,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:lf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:tT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:zA},427:{f:HA},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:GA},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:tA},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:jA},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:lf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:o4},633:{T:1},634:{T:-1},635:{T:1,f:s4},636:{T:-1},637:{f:cS},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:f3},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:ZA},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Z(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&d0(r)&&e.push(r)}}function q3(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Z(e,t,r,i);var s=t;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var c=e.next(4);for(c.write_shift(2,s),c.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u;l<i;){for(c=e.next(4),c.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;c.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u}}}function Xa(e,t,r){return e||(e=z(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function X3(e,t,r,n){var i=z(9);return Xa(i,e,t),Iv(r,n||"b",i),i}function Y3(e,t,r){var n=z(8+2*r.length);return Xa(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function J3(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Gt(Mt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Z(e,2,fT(r,n,i)):Z(e,3,cT(r,n,i));return;case"b":case"e":Z(e,5,X3(r,n,t.v,t.t));return;case"s":case"str":Z(e,4,Y3(r,n,(t.v||"").slice(0,255)));return}Z(e,1,Xa(null,r,n))}function Q3(e,t,r,n){var i=Array.isArray(t),s=je(t["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=nt(s)}for(var u=s.s.r;u<=s.e.r;++u){o=Et(u);for(var c=s.s.c;c<=s.e.c;++c){u===s.s.r&&(l[c]=Rt(c)),a=l[c]+o;var h=i?(t[u]||[])[c]:t[a];h&&J3(e,h,u,c)}}}function Z3(e,t){for(var r=t||{},n=Vt(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Z(n,r.biff==4?1033:r.biff==3?521:9,_0(e,16,r)),Q3(n,e.Sheets[e.SheetNames[i]],i,r),Z(n,10),n.end()}function eC(e,t,r){Z(e,49,KS({sz:12,name:"Arial"},r))}function tC(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Z(e,1054,YS(i,t[i],r))})}function rC(e,t){var r=z(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Z(e,2151,r),r=z(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),bv(je(t["!ref"]||"A1"),r),r.write_shift(4,4),Z(e,2152,r)}function nC(e,t){for(var r=0;r<16;++r)Z(e,224,Yd({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Z(e,224,Yd(n,0,t))})}function iC(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Z(e,440,iT(n)),n[1].Tooltip&&Z(e,2048,sT(n))}delete t["!links"]}function sC(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Z(e,125,lT(au(i,n),i))})}}function aC(e,t,r,n,i){var s=16+Un(i.cellXfs,t,i);if(t.v==null&&!t.bf){Z(e,513,hi(r,n,s));return}if(t.bf)Z(e,6,Fk(t,r,n,i,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?Gt(Mt(t.v)):t.v;Z(e,515,eT(r,n,a,s));break;case"b":case"e":Z(e,517,ZS(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=T0(i.Strings,t.v,i.revStrings);Z(e,253,qS(r,n,o,s))}else Z(e,516,XS(r,n,(t.v||"").slice(0,255),s,i));break;default:Z(e,513,hi(r,n,s))}}function oC(e,t,r){var n=Vt(),i=r.SheetNames[e],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},l=Array.isArray(s),u=t.biff==8,c,h="",f=[],d=je(s["!ref"]||"A1"),m=u?65536:16384;if(d.e.c>255||d.e.r>=m){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,m-1)}Z(n,2057,_0(r,16,t)),Z(n,13,ur(1)),Z(n,12,ur(100)),Z(n,15,Lt(!0)),Z(n,17,Lt(!1)),Z(n,16,fi(.001)),Z(n,95,Lt(!0)),Z(n,42,Lt(!1)),Z(n,43,Lt(!1)),Z(n,130,ur(1)),Z(n,128,QS()),Z(n,131,Lt(!1)),Z(n,132,Lt(!1)),u&&sC(n,s["!cols"]),Z(n,512,JS(d,t)),u&&(s["!links"]=[]);for(var p=d.s.r;p<=d.e.r;++p){h=Et(p);for(var _=d.s.c;_<=d.e.c;++_){p===d.s.r&&(f[_]=Rt(_)),c=f[_]+h;var x=l?(s[p]||[])[_]:s[c];x&&(aC(n,x,p,_,t),u&&x.l&&s["!links"].push([c,x.l]))}}var v=o.CodeName||o.name||i;return u&&Z(n,574,GS((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&Z(n,229,nT(s["!merges"])),u&&iC(n,s),Z(n,442,Lv(v)),u&&rC(n,s),Z(n,10),n.end()}function lC(e,t,r){var n=Vt(),i=(e||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Z(n,2057,_0(e,5,r)),r.bookType=="xla"&&Z(n,135),Z(n,225,o?ur(1200):null),Z(n,193,IS(2)),l&&Z(n,191),l&&Z(n,192),Z(n,226),Z(n,92,WS("SheetJS",r)),Z(n,66,ur(o?1200:1252)),o&&Z(n,353,ur(0)),o&&Z(n,448),Z(n,317,uT(e.SheetNames.length)),o&&e.vbaraw&&Z(n,211),o&&e.vbaraw){var u=a.CodeName||"ThisWorkbook";Z(n,442,Lv(u))}Z(n,156,ur(17)),Z(n,25,Lt(!1)),Z(n,18,Lt(!1)),Z(n,19,ur(0)),o&&Z(n,431,Lt(!1)),o&&Z(n,444,ur(0)),Z(n,61,VS()),Z(n,64,Lt(!1)),Z(n,141,ur(0)),Z(n,34,Lt(d3(e)=="true")),Z(n,14,Lt(!0)),o&&Z(n,439,Lt(!1)),Z(n,218,ur(0)),eC(n,e,r),tC(n,e.SSF,r),nC(n,r),o&&Z(n,352,Lt(!1));var c=n.end(),h=Vt();o&&Z(h,140,aT()),o&&r.Strings&&q3(h,252,HS(r.Strings)),Z(h,10);var f=h.end(),d=Vt(),m=0,p=0;for(p=0;p<e.SheetNames.length;++p)m+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var _=c.length+m+f.length;for(p=0;p<e.SheetNames.length;++p){var x=s[p]||{};Z(d,133,zS({pos:_,hs:x.Hidden||0,dt:0,name:e.SheetNames[p]},r)),_+=t[p].length}var v=d.end();if(m!=v.length)throw new Error("BS8 "+m+" != "+v.length);var g=[];return c.length&&g.push(c),v.length&&g.push(v),f.length&&g.push(f),_t(g)}function uC(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Kt(Je)),e&&e.SSF&&(tu(),eu(e.SSF),r.revssf=ru(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,k0(r),r.cellXfs=[],Un(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=oC(i,r,e);return n.unshift(lC(e,n,r)),_t(n)}function lg(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=ir(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return uC(e,t);case 4:case 3:case 2:return Z3(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function cC(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var c=Ne({r,c:a}),h=n.dense?(e[r]||[])[a]:e[c],f=h&&h.v!=null&&(h.h||$E(h.w||(an(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?f='<span contenteditable="true">'+f+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),d.id=(n.id||"sjs")+"-"+c,s.push(Q("td",f,d))}}var m="<tr>";return m+s.join("")+"</tr>"}var fC='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',hC="</body></html>";function dC(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ug(e,t){var r=t||{},n=r.header!=null?r.header:fC,i=r.footer!=null?r.footer:hC,s=[n],a=ir(e["!ref"]);r.dense=Array.isArray(e),s.push(dC(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(cC(e,a,o,r));return s.push("</table>"+i),s.join("")}function cg(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?ft(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var c=ir(e["!ref"]);u.s.r=Math.min(u.s.r,c.s.r),u.s.c=Math.min(u.s.c,c.s.c),u.e.r=Math.max(u.e.r,c.e.r),u.e.c=Math.max(u.e.c,c.e.c),i==-1&&(u.e.r=i=c.e.r+1)}var h=[],f=0,d=e["!rows"]||(e["!rows"]=[]),m=0,p=0,_=0,x=0,v=0,g=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<l;++m){var T=o[m];if(np(T)){if(n.display)continue;d[p]={hidden:!0}}var I=T.children;for(_=x=0;_<I.length;++_){var L=I[_];if(!(n.display&&np(L))){var A=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):VE(L.innerHTML),P=L.getAttribute("data-z")||L.getAttribute("z");for(f=0;f<h.length;++f){var N=h[f];N.s.c==x+s&&N.s.r<p+i&&p+i<=N.e.r&&(x=N.e.c+1-s,f=-1)}g=+L.getAttribute("colspan")||1,((v=+L.getAttribute("rowspan")||1)>1||g>1)&&h.push({s:{r:p+i,c:x+s},e:{r:p+i+(v||1)-1,c:x+s+(g||1)-1}});var W={t:"s",v:A},G=L.getAttribute("data-t")||L.getAttribute("t")||"";A!=null&&(A.length==0?W.t=G||"z":n.raw||A.trim().length==0||G=="s"||(A==="TRUE"?W={t:"b",v:!0}:A==="FALSE"?W={t:"b",v:!1}:isNaN(Qr(A))?isNaN(Ia(A).getDate())||(W={t:"d",v:Mt(A)},n.cellDates||(W={t:"n",v:Gt(W.v)}),W.z=n.dateNF||Je[14]):W={t:"n",v:Qr(A)})),W.z===void 0&&P!=null&&(W.z=P);var q="",re=L.getElementsByTagName("A");if(re&&re.length)for(var Te=0;Te<re.length&&!(re[Te].hasAttribute("href")&&(q=re[Te].getAttribute("href"),q.charAt(0)!="#"));++Te);q&&q.charAt(0)!="#"&&(W.l={Target:q}),n.dense?(e[p+i]||(e[p+i]=[]),e[p+i][x+s]=W):e[Ne({c:x+s,r:p+i})]=W,u.e.c<x+s&&(u.e.c=x+s),x+=g}}++p}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,p-1+i),e["!ref"]=nt(u),p>=l&&(e["!fullref"]=nt((u.e.r=o.length-m+p-1+i,u))),e}function fg(e,t){var r=t||{},n=r.dense?[]:{};return cg(n,e,t)}function pC(e,t){return mi(fg(e,t),t)}function np(e){var t="",r=mC(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function mC(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var vC=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+La({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return it+t}}(),ip=function(){var e=function(s){return Re(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Re(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,c=0,h=ir(s["!ref"]||"A1"),f=s["!merges"]||[],d=0,m=Array.isArray(s);if(s["!cols"])for(c=0;c<=h.e.c;++c)l.push("        <table:table-column"+(s["!cols"][c]?' table:style-name="co'+s["!cols"][c].ods+'"':"")+`></table:table-column>
`);var p="",_=s["!rows"]||[];for(u=0;u<h.s.r;++u)p=_[u]?' table:style-name="ro'+_[u].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=h.e.r;++u){for(p=_[u]?' table:style-name="ro'+_[u].ods+'"':"",l.push("        <table:table-row"+p+`>
`),c=0;c<h.s.c;++c)l.push(t);for(;c<=h.e.c;++c){var x=!1,v={},g="";for(d=0;d!=f.length;++d)if(!(f[d].s.c>c)&&!(f[d].s.r>u)&&!(f[d].e.c<c)&&!(f[d].e.r<u)){(f[d].s.c!=c||f[d].s.r!=u)&&(x=!0),v["table:number-columns-spanned"]=f[d].e.c-f[d].s.c+1,v["table:number-rows-spanned"]=f[d].e.r-f[d].s.r+1;break}if(x){l.push(r);continue}var T=Ne({r:u,c}),I=m?(s[u]||[])[c]:s[T];if(I&&I.f&&(v["table:formula"]=Re(bk(I.f)),I.F&&I.F.slice(0,T.length)==T)){var L=ir(I.F);v["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,v["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!I){l.push(t);continue}switch(I.t){case"b":g=I.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=I.v?"true":"false";break;case"n":g=I.w||String(I.v||0),v["office:value-type"]="float",v["office:value"]=I.v||0;break;case"s":case"str":g=I.v==null?"":I.v,v["office:value-type"]="string";break;case"d":g=I.w||Mt(I.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=Mt(I.v).toISOString(),v["table:style-name"]="ce1";break;default:l.push(t);continue}var A=e(g);if(I.l&&I.l.Target){var P=I.l.Target;P=P.charAt(0)=="#"?"#"+Mk(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),A=Q("text:a",A,{"xlink:href":P.replace(/&/g,"&amp;")})}l.push("          "+Q("table:table-cell",Q("text:p",A,{}),v)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var c=0;c<u["!cols"].length;++c)if(u["!cols"][c]){var h=u["!cols"][c];if(h.width==null&&h.wpx==null&&h.wch==null)continue;w0(h),h.ods=o;var f=u["!cols"][c].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var c=0;c<u["!rows"].length;++c)if(u["!rows"][c]){u["!rows"][c].ods=l;var h=u["!rows"][c].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[it],u=La({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=La({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+c+`>
`),l.push(Av().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function hg(e,t){if(t.bookType=="fods")return ip(e,t);var r=u0(),n="",i=[],s=[];return n="mimetype",xe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",xe(r,n,ip(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",xe(r,n,vC(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",xe(r,n,it+Av()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",xe(r,n,OS(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",xe(r,n,AS(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Fl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function gC(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ar(Da(e))}function xC(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ln(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function _C(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function ba(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ce(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function ss(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function at(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=ba(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=ba(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function vt(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Ce(n*8+i.type)),i.type==2&&t.push(Ce(i.data.length)),t.push(i.data))})}),Ln(t)}function xr(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=ba(e,n),s=at(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:ss(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=at(o.data),u=ss(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(a.merge=ss(s[3][0].data)>>>0>0),r.push(a)}return r}function Ri(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ce(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ce(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Ce(a.data.length)}],n[2].push({data:vt(a.meta),type:2})});var s=vt(n);t.push(Ce(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),Ln(t)}function wC(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ba(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Ln(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var c=Ln(i);if(c.length!=n)throw new Error("Unexpected length: ".concat(c.length," != ").concat(n));return c}function _r(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(wC(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ln(t)}function Fi(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=Ce(n),a=s.length;t.push(s),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return Ln(t)}function Ju(e,t){var r=new Uint8Array(32),n=Fl(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,_C(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Qu(e,t){var r=new Uint8Array(32),n=Fl(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function fn(e){var t=at(e);return ba(t[1][0].data)}function yC(e,t,r){var n,i,s,a;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=e[8])==null?void 0:s[0])==null?void 0:a.data)&&ss(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=Fl(e[7][0].data),c=0,h=[],f=Fl(e[4][0].data),d=0,m=[],p=0;p<t.length;++p){if(t[p]==null){u.setUint16(p*2,65535,!0),f.setUint16(p*2,65535);continue}u.setUint16(p*2,c,!0),f.setUint16(p*2,d,!0);var _,x;switch(typeof t[p]){case"string":_=Ju({t:"s",v:t[p]},r),x=Qu({t:"s",v:t[p]},r);break;case"number":_=Ju({t:"n",v:t[p]},r),x=Qu({t:"n",v:t[p]},r);break;case"boolean":_=Ju({t:"b",v:t[p]},r),x=Qu({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}h.push(_),c+=_.length,m.push(x),d+=x.length,++l}for(e[2][0].data=Ce(l);p<e[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),f.setUint16(p*2,65535,!0);return e[6][0].data=Ln(h),e[3][0].data=Ln(m),l}function EC(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ir(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(nt(n)));var s=Nl(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(U){return U.forEach(function(F){typeof F=="string"&&a.push(F)})});var o={},l=[],u=Pe.read(t.numbers,{type:"base64"});u.FileIndex.map(function(U,F){return[U,u.FullPaths[F]]}).forEach(function(U){var F=U[0],R=U[1];if(F.type==2&&F.name.match(/\.iwa/)){var V=F.content,oe=_r(V),he=xr(oe);he.forEach(function(ue){l.push(ue.id),o[ue.id]={deps:[],location:R,type:ss(ue.messages[0].meta[1][0].data)}})}}),l.sort(function(U,F){return U-F});var c=l.filter(function(U){return U>1}).map(function(U){return[U,Ce(U)]});u.FileIndex.map(function(U,F){return[U,u.FullPaths[F]]}).forEach(function(U){var F=U[0];if(U[1],!!F.name.match(/\.iwa/)){var R=xr(_r(F.content));R.forEach(function(V){V.messages.forEach(function(oe){c.forEach(function(he){V.messages.some(function(ue){return ss(ue.meta[1][0].data)!=11006&&xC(ue.data,he[1])})&&o[he[0]].deps.push(V.id)})})})}});for(var h=Pe.find(u,o[1].location),f=xr(_r(h.content)),d,m=0;m<f.length;++m){var p=f[m];p.id==1&&(d=p)}var _=fn(at(d.messages[0].data)[1][0].data);for(h=Pe.find(u,o[_].location),f=xr(_r(h.content)),m=0;m<f.length;++m)p=f[m],p.id==_&&(d=p);for(_=fn(at(d.messages[0].data)[2][0].data),h=Pe.find(u,o[_].location),f=xr(_r(h.content)),m=0;m<f.length;++m)p=f[m],p.id==_&&(d=p);for(_=fn(at(d.messages[0].data)[2][0].data),h=Pe.find(u,o[_].location),f=xr(_r(h.content)),m=0;m<f.length;++m)p=f[m],p.id==_&&(d=p);var x=at(d.messages[0].data);{x[6][0].data=Ce(n.e.r+1),x[7][0].data=Ce(n.e.c+1);var v=fn(x[46][0].data),g=Pe.find(u,o[v].location),T=xr(_r(g.content));{for(var I=0;I<T.length&&T[I].id!=v;++I);if(T[I].id!=v)throw"Bad ColumnRowUIDMapArchive";var L=at(T[I].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var A=0;A<=n.e.c;++A){var P=[];P[1]=P[2]=[{type:0,data:Ce(A+420690)}],L[1].push({type:2,data:vt(P)}),L[2].push({type:0,data:Ce(A)}),L[3].push({type:0,data:Ce(A)})}L[4]=[],L[5]=[],L[6]=[];for(var N=0;N<=n.e.r;++N)P=[],P[1]=P[2]=[{type:0,data:Ce(N+726270)}],L[4].push({type:2,data:vt(P)}),L[5].push({type:0,data:Ce(N)}),L[6].push({type:0,data:Ce(N)});T[I].messages[0].data=vt(L)}g.content=Fi(Ri(T)),g.size=g.content.length,delete x[46];var W=at(x[4][0].data);{W[7][0].data=Ce(n.e.r+1);var G=at(W[1][0].data),q=fn(G[2][0].data);g=Pe.find(u,o[q].location),T=xr(_r(g.content));{if(T[0].id!=q)throw"Bad HeaderStorageBucket";var re=at(T[0].messages[0].data);for(N=0;N<s.length;++N){var Te=at(re[2][0].data);Te[1][0].data=Ce(N),Te[4][0].data=Ce(s[N].length),re[2][N]={type:re[2][0].type,data:vt(Te)}}T[0].messages[0].data=vt(re)}g.content=Fi(Ri(T)),g.size=g.content.length;var ve=fn(W[2][0].data);g=Pe.find(u,o[ve].location),T=xr(_r(g.content));{if(T[0].id!=ve)throw"Bad HeaderStorageBucket";for(re=at(T[0].messages[0].data),A=0;A<=n.e.c;++A)Te=at(re[2][0].data),Te[1][0].data=Ce(A),Te[4][0].data=Ce(n.e.r+1),re[2][A]={type:re[2][0].type,data:vt(Te)};T[0].messages[0].data=vt(re)}g.content=Fi(Ri(T)),g.size=g.content.length;var Qe=fn(W[4][0].data);(function(){for(var U=Pe.find(u,o[Qe].location),F=xr(_r(U.content)),R,V=0;V<F.length;++V){var oe=F[V];oe.id==Qe&&(R=oe)}var he=at(R.messages[0].data);{he[3]=[];var ue=[];a.forEach(function(ye,Pt){ue[1]=[{type:0,data:Ce(Pt)}],ue[2]=[{type:0,data:Ce(1)}],ue[3]=[{type:2,data:gC(ye)}],he[3].push({type:2,data:vt(ue)})})}R.messages[0].data=vt(he);var ne=Ri(F),Ie=Fi(ne);U.content=Ie,U.size=U.content.length})();var Me=at(W[3][0].data);{var te=Me[1][0];delete Me[2];var ce=at(te.data);{var de=fn(ce[2][0].data);(function(){for(var U=Pe.find(u,o[de].location),F=xr(_r(U.content)),R,V=0;V<F.length;++V){var oe=F[V];oe.id==de&&(R=oe)}var he=at(R.messages[0].data);{delete he[6],delete Me[7];var ue=new Uint8Array(he[5][0].data);he[5]=[];for(var ne=0,Ie=0;Ie<=n.e.r;++Ie){var ye=at(ue);ne+=yC(ye,s[Ie],a),ye[1][0].data=Ce(Ie),he[5].push({data:vt(ye),type:2})}he[1]=[{type:0,data:Ce(n.e.c+1)}],he[2]=[{type:0,data:Ce(n.e.r+1)}],he[3]=[{type:0,data:Ce(ne)}],he[4]=[{type:0,data:Ce(n.e.r+1)}]}R.messages[0].data=vt(he);var Pt=Ri(F),Ae=Fi(Pt);U.content=Ae,U.size=U.content.length})()}te.data=vt(ce)}W[3][0].data=vt(Me)}x[4][0].data=vt(W)}d.messages[0].data=vt(x);var we=Ri(f),O=Fi(we);return h.content=O,h.size=h.content.length,u}function SC(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function k0(e){SC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function TC(e,t){return t.bookType=="ods"?hg(e,t):t.bookType=="numbers"?EC(e,t):t.bookType=="xlsb"?kC(e,t):AC(e,t)}function kC(e,t){qi=1024,e&&!e.SSF&&(e.SSF=Kt(Je)),e&&e.SSF&&(tu(),eu(e.SSF),t.revssf=ru(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,aa?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=qv.indexOf(t.bookType)>-1,i=Sv();k0(t=t||{});var s=u0(),a="",o=0;if(t.cellXfs=[],Un(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",xe(s,a,Cv(e.Props,t)),i.coreprops.push(a),Oe(t.rels,2,a,Se.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,xe(s,a,Rv(e.Props)),i.extprops.push(a),Oe(t.rels,3,a,Se.EXT_PROPS),e.Custprops!==e.Props&&Tt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",xe(s,a,Fv(e.Custprops)),i.custprops.push(a),Oe(t.rels,4,a,Se.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var c={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,xe(s,a,O3(o-1,a,t,e,c)),i.sheets.push(a),Oe(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Se.WS[0])}if(h){var d=h["!comments"],m=!1,p="";d&&d.length>0&&(p="xl/comments"+o+"."+r,xe(s,p,N3(d,p)),i.comments.push(p),Oe(c,-1,"../comments"+o+"."+r,Se.CMNT),m=!0),h["!legacy"]&&m&&xe(s,"xl/drawings/vmlDrawing"+o+".vml",Gv(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}c["!id"].rId1&&xe(s,kv(a),ns(c))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,xe(s,a,F3(t.Strings,a,t)),i.strs.push(a),Oe(t.wbrels,-1,"sharedStrings."+r,Se.SST)),a="xl/workbook."+r,xe(s,a,C3(e,a)),i.workbooks.push(a),Oe(t.rels,1,a,Se.WB),a="xl/theme/theme1.xml",xe(s,a,Hv(e.Themes,t)),i.themes.push(a),Oe(t.wbrels,-1,"theme/theme1.xml",Se.THEME),a="xl/styles."+r,xe(s,a,R3(e,a,t)),i.styles.push(a),Oe(t.wbrels,-1,"styles."+r,Se.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",xe(s,a,e.vbaraw),i.vba.push(a),Oe(t.wbrels,-1,"vbaProject.bin",Se.VBA)),a="xl/metadata."+r,xe(s,a,P3(a)),i.metadata.push(a),Oe(t.wbrels,-1,"metadata."+r,Se.XLMETA),xe(s,"[Content_Types].xml",Tv(i,t)),xe(s,"_rels/.rels",ns(t.rels)),xe(s,"xl/_rels/workbook."+r+".rels",ns(t.wbrels)),delete t.revssf,delete t.ssf,s}function AC(e,t){qi=1024,e&&!e.SSF&&(e.SSF=Kt(Je)),e&&e.SSF&&(tu(),eu(e.SSF),t.revssf=ru(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,aa?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=qv.indexOf(t.bookType)>-1,i=Sv();k0(t=t||{});var s=u0(),a="",o=0;if(t.cellXfs=[],Un(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",xe(s,a,Cv(e.Props,t)),i.coreprops.push(a),Oe(t.rels,2,a,Se.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,xe(s,a,Rv(e.Props)),i.extprops.push(a),Oe(t.rels,3,a,Se.EXT_PROPS),e.Custprops!==e.Props&&Tt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",xe(s,a,Fv(e.Custprops)),i.custprops.push(a),Oe(t.rels,4,a,Se.CUST_PROPS));var c=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,xe(s,a,ng(o-1,t,e,h)),i.sheets.push(a),Oe(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Se.WS[0])}if(f){var m=f["!comments"],p=!1,_="";if(m&&m.length>0){var x=!1;m.forEach(function(v){v[1].forEach(function(g){g.T==!0&&(x=!0)})}),x&&(_="xl/threadedComments/threadedComment"+o+"."+r,xe(s,_,n4(m,c,t)),i.threadedcomments.push(_),Oe(h,-1,"../threadedComments/threadedComment"+o+"."+r,Se.TCMNT)),_="xl/comments"+o+"."+r,xe(s,_,Kv(m)),i.comments.push(_),Oe(h,-1,"../comments"+o+"."+r,Se.CMNT),p=!0}f["!legacy"]&&p&&xe(s,"xl/drawings/vmlDrawing"+o+".vml",Gv(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&xe(s,kv(a),ns(h))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,xe(s,a,Bv(t.Strings,t)),i.strs.push(a),Oe(t.wbrels,-1,"sharedStrings."+r,Se.SST)),a="xl/workbook."+r,xe(s,a,ag(e)),i.workbooks.push(a),Oe(t.rels,1,a,Se.WB),a="xl/theme/theme1.xml",xe(s,a,Hv(e.Themes,t)),i.themes.push(a),Oe(t.wbrels,-1,"theme/theme1.xml",Se.THEME),a="xl/styles."+r,xe(s,a,Wv(e,t)),i.styles.push(a),Oe(t.wbrels,-1,"styles."+r,Se.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",xe(s,a,e.vbaraw),i.vba.push(a),Oe(t.wbrels,-1,"vbaProject.bin",Se.VBA)),a="xl/metadata."+r,xe(s,a,Vv()),i.metadata.push(a),Oe(t.wbrels,-1,"metadata."+r,Se.XLMETA),c.length>1&&(a="xl/persons/person.xml",xe(s,a,i4(c)),i.people.push(a),Oe(t.wbrels,-1,"persons/person.xml",Se.PEOPLE)),xe(s,"[Content_Types].xml",Tv(i,t)),xe(s,"_rels/.rels",ns(t.rels)),xe(s,"xl/_rels/workbook."+r+".rels",ns(t.wbrels)),delete t.revssf,delete t.ssf,s}function CC(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=sn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function dg(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Va(t.file,Pe.write(e,{type:ke?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Pe.write(e,t)}function OC(e,t){var r=Kt(t||{}),n=TC(e,r);return RC(n,r)}function RC(e,t){var r={},n=ke?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Pe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Zl(i))}return t.password&&typeof encrypt_agile<"u"?dg(encrypt_agile(i,t.password),t):t.type==="file"?Va(t.file,i):t.type=="string"?ra(i):i}function FC(e,t){var r=t||{},n=G3(e,r);return dg(n,r)}function br(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Pa(Da(n));case"binary":return Da(n);case"string":return e;case"file":return Va(t.file,n,"utf8");case"buffer":return ke?un(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):br(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function NC(e,t){switch(t.type){case"base64":return Pa(e);case"binary":return e;case"string":return e;case"file":return Va(t.file,e,"binary");case"buffer":return ke?un(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Fo(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Pa(r):t.type=="string"?ra(r):r;case"file":return Va(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function pg(e,t){sE(),v3(e);var r=Kt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=pg(e,r);return r.type="array",Zl(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return br(H3(e,r),r);case"slk":case"sylk":return br(dT.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return br(ug(e.Sheets[e.SheetNames[i]],r),r);case"txt":return NC(mg(e.Sheets[e.SheetNames[i]],r),r);case"csv":return br(A0(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return br(pT.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Fo(hT.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return br(mT.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return br(ET.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return br(Mv.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return br(hg(e,r),r);case"wk1":return Fo(Jd.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Fo(Jd.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Fo(lg(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),FC(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return OC(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function PC(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function IC(e,t,r){var n={};return n.type="file",n.file=t,PC(n),pg(e,n)}function DC(e,t,r,n,i,s,a,o){var l=Et(r),u=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,f=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!a||e[r])for(var d=t.s.c;d<=t.e.c;++d){var m=a?e[r][d]:e[n[d]+l];if(m===void 0||m.t===void 0){if(u===void 0)continue;s[d]!=null&&(f[s[d]]=u);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[d]!=null){if(p==null)if(m.t=="e"&&p===null)f[s[d]]=null;else if(u!==void 0)f[s[d]]=u;else if(c&&p===null)f[s[d]]=null;else continue;else f[s[d]]=c&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?p:an(m,p,o);p!=null&&(h=!1)}}return{row:f,isempty:h}}function Nl(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},c=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof c){case"string":l=je(c);break;case"number":l=je(e["!ref"]),l.s.r=c;break;default:l=c}n>0&&(i=0);var h=Et(l.s.r),f=[],d=[],m=0,p=0,_=Array.isArray(e),x=l.s.r,v=0,g={};_&&!e[x]&&(e[x]=[]);var T=u.skipHidden&&e["!cols"]||[],I=u.skipHidden&&e["!rows"]||[];for(v=l.s.c;v<=l.e.c;++v)if(!(T[v]||{}).hidden)switch(f[v]=Rt(v),r=_?e[x][v]:e[f[v]+h],n){case 1:s[v]=v-l.s.c;break;case 2:s[v]=f[v];break;case 3:s[v]=u.header[v-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=an(r,null,u),p=g[a]||0,!p)g[a]=1;else{do o=a+"_"+p++;while(g[o]);g[a]=p,g[o]=1}s[v]=o}for(x=l.s.r+i;x<=l.e.r;++x)if(!(I[x]||{}).hidden){var L=DC(e,l,x,f,n,s,_,u);(L.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(d[m++]=L.row)}return d.length=m,d}var sp=/"/g;function LC(e,t,r,n,i,s,a,o){for(var l=!0,u=[],c="",h=Et(r),f=t.s.c;f<=t.e.c;++f)if(n[f]){var d=o.dense?(e[r]||[])[f]:e[n[f]+h];if(d==null)c="";else if(d.v!=null){l=!1,c=""+(o.rawNumbers&&d.t=="n"?d.v:an(d,null,o));for(var m=0,p=0;m!==c.length;++m)if((p=c.charCodeAt(m))===i||p===s||p===34||o.forceQuotes){c='"'+c.replace(sp,'""')+'"';break}c=="ID"&&(c='"ID"')}else d.f!=null&&!d.F?(l=!1,c="="+d.f,c.indexOf(",")>=0&&(c='"'+c.replace(sp,'""')+'"')):c="";u.push(c)}return o.blankrows===!1&&l?null:u.join(a)}function A0(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=je(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),c="",h=[];n.dense=Array.isArray(e);for(var f=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(f[m]||{}).hidden||(h[m]=Rt(m));for(var p=0,_=i.s.r;_<=i.e.r;++_)(d[_]||{}).hidden||(c=LC(e,i,_,h,a,l,s,n),c!=null&&(n.strip&&(c=c.replace(u,"")),(c||n.blankrows!==!1)&&r.push((p++?o:"")+c)));return delete n.dense,r.join("")}function mg(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=A0(e,t);return r}function bC(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=je(e["!ref"]),s="",a=[],o,l=[],u=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=Rt(o);for(var c=i.s.r;c<=i.e.r;++c)for(s=Et(c),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=u?(e[c]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function vg(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?ft(n.origin):n.origin;a=l.r,o=l.c}var u,c={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var h=je(s["!ref"]);c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),a==-1&&(a=h.e.r+1,c.e.r=a+t.length-1+i)}else a==-1&&(a=0,c.e.r=t.length-1+i);var f=n.header||[],d=0;t.forEach(function(p,_){Tt(p).forEach(function(x){(d=f.indexOf(x))==-1&&(f[d=f.length]=x);var v=p[x],g="z",T="",I=Ne({c:o+d,r:a+_+i});u=Ma(s,I),v&&typeof v=="object"&&!(v instanceof Date)?s[I]=v:(typeof v=="number"?g="n":typeof v=="boolean"?g="b":typeof v=="string"?g="s":v instanceof Date?(g="d",n.cellDates||(g="n",v=Gt(v)),T=n.dateNF||Je[14]):v===null&&n.nullError&&(g="e",v=0),u?(u.t=g,u.v=v,delete u.w,delete u.R,T&&(u.z=T)):s[I]=u={t:g,v},T&&(u.z=T))})}),c.e.c=Math.max(c.e.c,o+f.length-1);var m=Et(a);if(i)for(d=0;d<f.length;++d)s[Rt(d+o)+m]={t:"s",v:f[d]};return s["!ref"]=nt(c),s}function MC(e,t){return vg(null,e,t)}function Ma(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ft(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Ma(e,Ne(t)):Ma(e,Ne({r:t,c:r||0}))}function BC(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function UC(){return{SheetNames:[],Sheets:{}}}function jC(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(sg(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function $C(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=BC(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function WC(e,t){return e.z=t,e}function gg(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function zC(e,t,r){return gg(e,"#"+t,r)}function HC(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function VC(e,t,r,n){for(var i=typeof t!="string"?t:je(t),s=typeof t=="string"?t:nt(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Ma(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Zu={encode_col:Rt,encode_row:Et,encode_cell:Ne,encode_range:nt,decode_col:m0,decode_row:p0,split_cell:sS,decode_cell:ft,decode_range:ir,format_cell:an,sheet_add_aoa:gv,sheet_add_json:vg,sheet_add_dom:cg,aoa_to_sheet:ws,json_to_sheet:MC,table_to_sheet:fg,table_to_book:pC,sheet_to_csv:A0,sheet_to_txt:mg,sheet_to_json:Nl,sheet_to_html:ug,sheet_to_formulae:bC,sheet_to_row_object_array:Nl,sheet_get_cell:Ma,book_new:UC,book_append_sheet:jC,book_set_sheet_visibility:$C,cell_set_number_format:WC,cell_set_hyperlink:gg,cell_set_internal_link:zC,cell_add_comment:HC,sheet_set_array_formula:VC,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const GC=e=>{const t=["ID Risposta","ID Utente","Data Compilazione","Evento","Citt","Data Evento","Nome Utente",...Kc.map(a=>a.text)],r=e.map(a=>{const o=ui.find(u=>u.id===a.eventId),l=[a.id,a.userId,new Date(a.timestamp).toLocaleString(),(o==null?void 0:o.name)||"Evento Sconosciuto",(o==null?void 0:o.city)||"-",(o==null?void 0:o.date)||"-",a.username];return Kc.forEach(u=>{l.push(a.answers[u.id]||"")}),l}),n=[t,...r],i=Zu.aoa_to_sheet(n),s=Zu.book_new();Zu.book_append_sheet(s,i,"Risposte"),IC(s,`Logica_Report_${new Date().toISOString().slice(0,10)}.xlsx`)},KC=({user:e,onLogout:t})=>{const[r,n]=Le.useState([]),[i,s]=Le.useState(!1),[a,o]=Le.useState(!1),l=async()=>{s(!0);try{const d=await W2();n(d)}catch(d){console.error(d)}finally{s(!1)}};Le.useEffect(()=>{l()},[]);const u=()=>{o(!0);try{GC(r)}catch(d){console.error("Export failed",d),alert("Errore durante l'esportazione.")}finally{o(!1)}},c=r.length,h=new Set(r.map(d=>d.eventId)).size,f=ui.map(d=>{const m=r.filter(p=>p.eventId===d.id).length;return{...d,count:m}}).sort((d,m)=>m.count-d.count);return D.jsxs("div",{className:"min-h-screen bg-[#EFEEEE]",children:[D.jsx("header",{className:"bg-[#325D79] text-white shadow-lg sticky top-0 z-10",children:D.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between",children:[D.jsx("div",{className:"flex items-center gap-4",children:D.jsx("div",{className:"scale-50 origin-left -ml-2",children:D.jsx(Ql,{variant:"light"})})}),D.jsxs("div",{className:"flex items-center gap-4",children:[D.jsxs("span",{className:"text-sm text-[#9BD7D1] hidden sm:block",children:["Benvenuto, ",e.username]}),D.jsx("button",{onClick:t,className:"text-sm bg-[#24465F] hover:bg-[#F26627] text-white px-3 py-1.5 rounded transition-colors",children:"Logout"})]})]})}),D.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[D.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[D.jsxs("div",{children:[D.jsx("h1",{className:"text-2xl font-bold text-[#325D79]",children:"Admin Dashboard"}),D.jsx("p",{className:"text-slate-500 mt-1",children:"Monitoraggio eventi e risposte."})]}),D.jsxs("div",{className:"flex gap-2",children:[D.jsx(wn,{onClick:l,variant:"secondary",isLoading:i,className:"shadow-sm border-[#9BD7D1]",children:D.jsx(J2,{className:`w-4 h-4 ${i?"animate-spin":""}`})}),D.jsxs(wn,{onClick:u,isLoading:a,className:"shadow-lg shadow-[#F9A26C]/30",children:[D.jsx(q2,{className:"w-4 h-4 mr-2"}),"Esporta Excel"]})]})]}),D.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[D.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-[#9BD7D1]/50",children:[D.jsxs("div",{className:"flex items-center justify-between pb-4",children:[D.jsx("h3",{className:"text-sm font-medium text-slate-500",children:"Totale Risposte"}),D.jsx(eE,{className:"w-5 h-5 text-[#F26627]"})]}),D.jsx("p",{className:"text-3xl font-bold text-[#325D79]",children:c})]}),D.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-[#9BD7D1]/50",children:[D.jsxs("div",{className:"flex items-center justify-between pb-4",children:[D.jsx("h3",{className:"text-sm font-medium text-slate-500",children:"Eventi Attivi"}),D.jsx(Lm,{className:"w-5 h-5 text-[#F26627]"})]}),D.jsx("p",{className:"text-3xl font-bold text-[#325D79]",children:h}),D.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:["Su ",ui.length," totali"]})]})]}),D.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-[#9BD7D1]/50 overflow-hidden",children:[D.jsx("div",{className:"px-6 py-5 border-b border-[#EFEEEE]",children:D.jsx("h3",{className:"text-lg font-semibold text-[#325D79]",children:"Dettaglio per Evento"})}),D.jsx("div",{className:"overflow-x-auto",children:D.jsxs("table",{className:"w-full text-left text-sm text-slate-600",children:[D.jsx("thead",{className:"bg-[#EFEEEE] text-[#325D79] font-semibold border-b border-[#9BD7D1]/30",children:D.jsxs("tr",{children:[D.jsx("th",{className:"px-6 py-4",children:"Nome Evento"}),D.jsx("th",{className:"px-6 py-4",children:"Citt"}),D.jsx("th",{className:"px-6 py-4",children:"Data"}),D.jsx("th",{className:"px-6 py-4 text-right",children:"Compilazioni"}),D.jsx("th",{className:"px-6 py-4 text-right",children:"Stato"})]})}),D.jsx("tbody",{className:"divide-y divide-[#EFEEEE]",children:f.map(d=>D.jsxs("tr",{className:"hover:bg-[#EFEEEE]/50 transition-colors",children:[D.jsx("td",{className:"px-6 py-4 font-medium text-[#325D79]",children:d.name}),D.jsxs("td",{className:"px-6 py-4 flex items-center gap-2",children:[D.jsx(Mm,{className:"w-3.5 h-3.5 text-[#9BD7D1]"}),d.city]}),D.jsx("td",{className:"px-6 py-4",children:new Date(d.date).toLocaleDateString()}),D.jsx("td",{className:"px-6 py-4 text-right font-bold text-[#F26627]",children:d.count}),D.jsx("td",{className:"px-6 py-4 text-right",children:D.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${d.count>0?"bg-[#9BD7D1]/20 text-[#325D79]":"bg-slate-100 text-slate-800"}`,children:d.count>0?"Attivo":"In attesa"})})]},d.id))})]})})]})]})]})},qC=({user:e,onLogout:t,onStartSurvey:r})=>{const[n,i]=Le.useState(null),s=ui.find(a=>a.id===e.eventId);return Le.useEffect(()=>{(async()=>{if(e.id==="demo_user_preview"){const l=await _d(e.id);i(l);return}const o=await _d(e.id);i(o)})()},[e.id]),D.jsxs("div",{className:"min-h-screen bg-[#EFEEEE]",children:[D.jsx("header",{className:"bg-white shadow-sm border-b border-[#9BD7D1]/30",children:D.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-3 flex justify-between items-center",children:[D.jsx("div",{className:"flex items-center gap-2",children:D.jsx("div",{className:"scale-50 origin-left",children:D.jsx(Ql,{})})}),D.jsxs("button",{onClick:t,className:"flex items-center text-sm font-medium text-[#325D79] hover:text-[#F26627] transition-colors",children:[D.jsx(Y2,{className:"w-4 h-4 mr-1.5"}),"Esci"]})]})}),D.jsxs("main",{className:"max-w-4xl mx-auto px-4 py-8",children:[D.jsxs("div",{className:"mb-8",children:[D.jsxs("h1",{className:"text-3xl font-bold text-[#325D79]",children:["Ciao, ",e.name]}),D.jsx("p",{className:"text-slate-500 mt-2",children:"Benvenuto nella tua dashboard personale."})]}),D.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[D.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-[#9BD7D1]/50 flex flex-col justify-between h-48",children:[D.jsxs("div",{className:"flex items-start justify-between",children:[D.jsxs("div",{children:[D.jsx("p",{className:"text-sm font-medium text-slate-500 uppercase tracking-wider",children:"Schede Compilate"}),D.jsx("h3",{className:"text-4xl font-bold text-[#F26627] mt-2",children:n===null?"-":n})]}),D.jsx("div",{className:"p-3 bg-[#EFEEEE] rounded-xl",children:D.jsx(bm,{className:"w-6 h-6 text-[#325D79]"})})]}),D.jsx("p",{className:"text-sm text-slate-400",children:"Totale inserimenti effettuati per questo evento."})]}),D.jsxs("div",{className:"bg-[#325D79] p-6 rounded-2xl shadow-lg text-white flex flex-col justify-between h-48 relative overflow-hidden",children:[D.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[#9BD7D1] opacity-20 rounded-full -mr-10 -mt-10 pointer-events-none"}),D.jsxs("div",{children:[D.jsx("p",{className:"text-[#9BD7D1] text-sm font-medium uppercase tracking-wider mb-2",children:"Evento Attivo"}),D.jsx("h3",{className:"text-xl font-bold leading-tight text-white",children:(s==null?void 0:s.name)||"Evento non assegnato"})]}),D.jsxs("div",{className:"space-y-2 text-sm text-indigo-100",children:[D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx(Mm,{className:"w-4 h-4 text-[#F9A26C]"}),D.jsx("span",{children:(s==null?void 0:s.city)||"-"})]}),D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx(Lm,{className:"w-4 h-4 text-[#F9A26C]"}),D.jsx("span",{children:s!=null&&s.date?new Date(s.date).toLocaleDateString():"-"})]})]})]})]}),D.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-[#9BD7D1]/50 p-8 text-center",children:[D.jsx("div",{className:"mx-auto w-16 h-16 bg-[#EFEEEE] rounded-full flex items-center justify-center mb-4",children:D.jsx(Z2,{className:"w-8 h-8 text-[#325D79]"})}),D.jsx("h2",{className:"text-xl font-bold text-[#325D79] mb-2",children:"Nuovo Paziente"}),D.jsx("p",{className:"text-slate-500 max-w-md mx-auto mb-8",children:"Inizia una nuova sessione di screening. I dati verranno salvati automaticamente nel database."}),D.jsx(wn,{onClick:r,className:"w-full sm:w-auto px-12 py-3 text-lg bg-[#F26627] hover:bg-[#d9561b] shadow-lg shadow-[#F9A26C]/50",children:"Compila Scheda"})]})]})]})};H2();function XC(){const[e,t]=Le.useState(null),[r,n]=Le.useState("dashboard");Le.useEffect(()=>{const a=localStorage.getItem("logica_session");a&&t(JSON.parse(a))},[]);const i=a=>{t(a),n("dashboard"),localStorage.setItem("logica_session",JSON.stringify(a))},s=()=>{t(null),n("dashboard"),localStorage.removeItem("logica_session")};return e?e.role===Qs.ADMIN?D.jsx(KC,{user:e,onLogout:s}):r==="survey"?D.jsx(rE,{user:e,onBack:()=>n("dashboard")}):D.jsx(qC,{user:e,onLogout:s,onStartSurvey:()=>n("survey")}):D.jsx(tE,{onLogin:i})}const xg=document.getElementById("root");if(!xg)throw new Error("Could not find root element to mount to");const YC=ec.createRoot(xg);YC.render(D.jsx(Jg.StrictMode,{children:D.jsx(XC,{})}));
